/*! For license information please see message.apps-f17916a22601f8a680f5.js.LICENSE.txt */
(()=>{var e={4444:(e,t)=>{"use strict";function n(e){return e.replace(/_\w/g,(function(e){return e[1].toUpperCase()}))}function r(e){return e.replace(/(?:^|\.?)([A-Z])/g,(function(e,t){return"_"+t.toLowerCase()})).replace(/^_/,"")}function i(e,t){var n={};if(e instanceof Array)return e.map((function(e){return"object"==typeof e&&(e=i(e,t)),e}));for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]instanceof Array||e[r]&&e[r]instanceof Object&&!(e[r]instanceof Date)?n[t(r)]=i(e[r],t):n[t(r)]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0}),t.spaceToCamel=t.toSnakeCaseDeeply=t.camelizeDeeply=t.camelToSnake=t.transformKeys=t.snakeToCamel=void 0,t.snakeToCamel=n,t.camelToSnake=r,t.spaceToCamel=function(e){return e.toLowerCase().replace(/\s\w/g,(function(e){return e[1].toUpperCase()}))},t.transformKeys=i,t.camelizeDeeply=function(e){return i(e,n)},t.toSnakeCaseDeeply=function(e){return i(e,r)}},468:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(4444),t)},7692:e=>{"use strict";e.exports={},e.exports.parse=function(e){if(!e||"string"!=typeof e)throw new TypeError("argument string is required");var t=o.exec(e);if(!t)throw new TypeError("invalid type format");var n,s,c=t[0].length,u=t[1].toLowerCase(),h=[],d={};for(c=i.lastIndex=";"===t[0].substr(-1)?c-1:c;t=i.exec(e);){if(t.index!==c)throw new TypeError("invalid parameter format");if(c+=t[0].length,n=t[1].toLowerCase(),s=t[2],-1!==h.indexOf(n))throw new TypeError("invalid duplicate parameter");h.push(n),n.indexOf("*")+1!==n.length?"string"!=typeof d[n]&&('"'===s[0]&&(s=s.substr(1,s.length-2).replace(r,"$1")),d[n]=s):(n=n.slice(0,-1),s=a(s),d[n]=s)}if(-1!==c&&c!==e.length)throw new TypeError("invalid parameter format");return new l(u,d)};var t=/%([0-9A-Fa-f]{2})/g,n=/[^\x20-\x7e\xa0-\xff]/g,r=/\\([\u0000-\u007f])/g,i=/;[\x09\x20]*([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*=[\x09\x20]*("(?:[\x20!\x23-\x5b\x5d-\x7e\x80-\xff]|\\[\x20-\x7e])*"|[!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*/g,s=/^([A-Za-z0-9!#$%&+\-^_`{}~]+)'(?:[A-Za-z]{2,3}(?:-[A-Za-z]{3}){0,3}|[A-Za-z]{4,8}|)'((?:%[0-9A-Fa-f]{2}|[A-Za-z0-9!#$&+.^_`|~-])+)$/,o=/^([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*(?:$|;)/;function a(e){var r=s.exec(e);if(!r)throw new TypeError("invalid extended field value");var i,o,a=r[1].toLowerCase(),l=r[2].replace(t,c);switch(a){case"iso-8859-1":i=String(l).replace(n,"?");break;case"utf-8":const e=function(e){const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return t}(l);o=e,i=new TextDecoder("utf-8").decode(o);break;default:throw new TypeError("unsupported charset in extended field")}return i}function c(e,t){return String.fromCharCode(parseInt(t,16))}function l(e,t){this.type=e,this.parameters=t}},6224:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.request=void 0;var i=r(n(7692));t.request=function(e,t){var n=e.url,r=e.method,s=e.data,o=e.headers;return void 0===t&&(t="システムで問題が発生しました。時間をおいて再度お試しください。"),fetch(n,{method:r,credentials:"include",headers:o,body:null!=s?s:null}).then((function(e){var n=e.headers.get("content-disposition");if(!n)return Promise.reject(new Error(t));var r=i.default.parse(n).parameters.filename;if(!r)return Promise.reject(new Error(t));e.blob().then((function(t){var n,i=new Blob([t],{type:null!==(n=e.headers.get("content-type"))&&void 0!==n?n:void 0}),s=window.URL||window.webkitURL,o=s.createObjectURL(i),a=document.createElement("a");return void 0===a.download?window.location.href=o:(a.href=o,a.download=r,a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)),setTimeout((function(){s.revokeObjectURL(o)}),100),Promise.resolve()}))}))}},1260:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(6224),t),i(n(5124),t)},5124:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},840:(e,t)=>{"use strict";t.K=void 0,t.K=function(e){var t,n,r,i,s=parseInt(e.substr(1,2),16);return t=parseInt(e.substr(3,2),16),n=parseInt(e.substr(5,2),16),1.05/(.05+(i=.2126*(r=function(e){var t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)})(s)+.7152*r(t)+.0722*r(n)))*4.6<(i+.05)/.05?"#000":"#fff"}},1784:(e,t,n)=>{n(5684),n(3784),n(5208),n(6716),n(9692),n(7416),n(1408),n(6208),n(2676),n(5092),n(3468),n(3608),n(8160),n(3696),n(3616),n(1872),n(3924),n(6456),n(444),n(5164),n(2948),n(4404),n(5612),n(3917),n(4180),n(2e3),n(7476),n(7184),n(2251),n(1228),n(7912),n(8504);var r=n(340);e.exports=r.Array},80:(e,t,n)=>{n(3924),n(472),n(7912),n(8504);var r=n(340);e.exports=r.Map},5816:(e,t,n)=>{n(3656);var r=n(340);e.exports=r.Number.isNaN},2720:(e,t,n)=>{n(2320),n(6368),n(8896),n(6200),n(9e3),n(8292),n(9064),n(1243),n(4440),n(6152),n(2260),n(864),n(4112),n(6620),n(5016),n(6228),n(2356),n(6124),n(5312),n(3936),n(920),n(1712),n(7912),n(8892),n(9920),n(7600),n(5512),n(1480),n(3896),n(3652);var r=n(340);e.exports=r.Object},204:(e,t,n)=>{n(3924),n(7912),n(4840),n(8504);var r=n(340);e.exports=r.Set},8928:(e,t,n)=>{n(7912),n(3768),n(2808),n(7588),n(9965),n(2060),n(5048),n(824),n(8080),n(4296),n(2056),n(1876),n(5720),n(1259),n(5024),n(9885),n(8640),n(4904),n(960),n(1164),n(1315),n(408),n(8504),n(3120),n(6824),n(6784),n(7800),n(3340),n(4520),n(2112),n(1048),n(1288),n(7816),n(5264),n(628),n(5032);var r=n(340);e.exports=r.String},1381:(e,t,n)=>{var r=n(1600),i=n(984),s=n(1532),o=r.TypeError;e.exports=function(e){if(i(e))return e;throw o(s(e)+" is not a function")}},6372:(e,t,n)=>{var r=n(1600),i=n(5220),s=n(1532),o=r.TypeError;e.exports=function(e){if(i(e))return e;throw o(s(e)+" is not a constructor")}},4040:(e,t,n)=>{var r=n(1600),i=n(984),s=r.String,o=r.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw o("Can't set "+s(e)+" as a prototype")}},5868:(e,t,n)=>{var r=n(3668),i=n(124),s=n(7072),o=r("unscopables"),a=Array.prototype;null==a[o]&&s.f(a,o,{configurable:!0,value:i(null)}),e.exports=function(e){a[o][e]=!0}},6619:(e,t,n)=>{"use strict";var r=n(2780).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},2932:(e,t,n)=>{var r=n(1600),i=n(2408),s=r.TypeError;e.exports=function(e,t){if(i(t,e))return e;throw s("Incorrect invocation")}},3736:(e,t,n)=>{var r=n(1600),i=n(9952),s=r.String,o=r.TypeError;e.exports=function(e){if(i(e))return e;throw o(s(e)+" is not an object")}},4328:(e,t,n)=>{var r=n(7004);e.exports=r((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},4048:(e,t,n)=>{"use strict";var r=n(3848),i=n(7920),s=n(9183),o=Math.min;e.exports=[].copyWithin||function(e,t){var n=r(this),a=s(n),c=i(e,a),l=i(t,a),u=arguments.length>2?arguments[2]:void 0,h=o((void 0===u?a:i(u,a))-l,a-c),d=1;for(l<c&&c<l+h&&(d=-1,l+=h-1,c+=h-1);h-- >0;)l in n?n[c]=n[l]:delete n[c],c+=d,l+=d;return n}},3156:(e,t,n)=>{"use strict";var r=n(3848),i=n(7920),s=n(9183);e.exports=function(e){for(var t=r(this),n=s(t),o=arguments.length,a=i(o>1?arguments[1]:void 0,n),c=o>2?arguments[2]:void 0,l=void 0===c?n:i(c,n);l>a;)t[a++]=e;return t}},4e3:(e,t,n)=>{"use strict";var r=n(9560).forEach,i=n(6608)("forEach");e.exports=i?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},8208:(e,t,n)=>{"use strict";var r=n(1600),i=n(5616),s=n(3032),o=n(3848),a=n(5520),c=n(1680),l=n(5220),u=n(9183),h=n(4135),d=n(4944),p=n(8132),f=r.Array;e.exports=function(e){var t=o(e),n=l(this),r=arguments.length,g=r>1?arguments[1]:void 0,m=void 0!==g;m&&(g=i(g,r>2?arguments[2]:void 0));var v,_,y,w,b,I,k=p(t),C=0;if(!k||this==f&&c(k))for(v=u(t),_=n?new this(v):f(v);v>C;C++)I=m?g(t[C],C):t[C],h(_,C,I);else for(b=(w=d(t,k)).next,_=n?new this:[];!(y=s(b,w)).done;C++)I=m?a(w,g,[y.value,C],!0):y.value,h(_,C,I);return _.length=C,_}},6024:(e,t,n)=>{var r=n(3068),i=n(7920),s=n(9183),o=function(e){return function(t,n,o){var a,c=r(t),l=s(c),u=i(o,l);if(e&&n!=n){for(;l>u;)if((a=c[u++])!=a)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},9560:(e,t,n)=>{var r=n(5616),i=n(604),s=n(3188),o=n(3848),a=n(9183),c=n(1220),l=i([].push),u=function(e){var t=1==e,n=2==e,i=3==e,u=4==e,h=6==e,d=7==e,p=5==e||h;return function(f,g,m,v){for(var _,y,w=o(f),b=s(w),I=r(g,m),k=a(b),C=0,S=v||c,T=t?S(f,k):n||d?S(f,0):void 0;k>C;C++)if((p||C in b)&&(y=I(_=b[C],C,w),e))if(t)T[C]=y;else if(y)switch(e){case 3:return!0;case 5:return _;case 6:return C;case 2:l(T,_)}else switch(e){case 4:return!1;case 7:l(T,_)}return h?-1:i||u?u:T}};e.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},5696:(e,t,n)=>{"use strict";var r=n(9756),i=n(3068),s=n(9824),o=n(9183),a=n(6608),c=Math.min,l=[].lastIndexOf,u=!!l&&1/[1].lastIndexOf(1,-0)<0,h=a("lastIndexOf"),d=u||!h;e.exports=d?function(e){if(u)return r(l,this,arguments)||0;var t=i(this),n=o(t),a=n-1;for(arguments.length>1&&(a=c(a,s(arguments[1]))),a<0&&(a=n+a);a>=0;a--)if(a in t&&t[a]===e)return a||0;return-1}:l},4696:(e,t,n)=>{var r=n(7004),i=n(3668),s=n(2592),o=i("species");e.exports=function(e){return s>=51||!r((function(){var t=[];return(t.constructor={})[o]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},6608:(e,t,n)=>{"use strict";var r=n(7004);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},3680:(e,t,n)=>{var r=n(1600),i=n(1381),s=n(3848),o=n(3188),a=n(9183),c=r.TypeError,l=function(e){return function(t,n,r,l){i(n);var u=s(t),h=o(u),d=a(u),p=e?d-1:0,f=e?-1:1;if(r<2)for(;;){if(p in h){l=h[p],p+=f;break}if(p+=f,e?p<0:d<=p)throw c("Reduce of empty array with no initial value")}for(;e?p>=0:d>p;p+=f)p in h&&(l=n(l,h[p],p,u));return l}};e.exports={left:l(!1),right:l(!0)}},9472:(e,t,n)=>{var r=n(1600),i=n(7920),s=n(9183),o=n(4135),a=r.Array,c=Math.max;e.exports=function(e,t,n){for(var r=s(e),l=i(t,r),u=i(void 0===n?r:n,r),h=a(c(u-l,0)),d=0;l<u;l++,d++)o(h,d,e[l]);return h.length=d,h}},6100:(e,t,n)=>{var r=n(604);e.exports=r([].slice)},1316:(e,t,n)=>{var r=n(9472),i=Math.floor,s=function(e,t){var n=e.length,c=i(n/2);return n<8?o(e,t):a(e,s(r(e,0,c),t),s(r(e,c),t),t)},o=function(e,t){for(var n,r,i=e.length,s=1;s<i;){for(r=s,n=e[s];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==s++&&(e[r]=n)}return e},a=function(e,t,n,r){for(var i=t.length,s=n.length,o=0,a=0;o<i||a<s;)e[o+a]=o<i&&a<s?r(t[o],n[a])<=0?t[o++]:n[a++]:o<i?t[o++]:n[a++];return e};e.exports=s},4096:(e,t,n)=>{var r=n(1600),i=n(5240),s=n(5220),o=n(9952),a=n(3668)("species"),c=r.Array;e.exports=function(e){var t;return i(e)&&(t=e.constructor,(s(t)&&(t===c||i(t.prototype))||o(t)&&null===(t=t[a]))&&(t=void 0)),void 0===t?c:t}},1220:(e,t,n)=>{var r=n(4096);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},5520:(e,t,n)=>{var r=n(3736),i=n(1792);e.exports=function(e,t,n,s){try{return s?t(r(n)[0],n[1]):t(n)}catch(t){i(e,"throw",t)}}},6344:(e,t,n)=>{var r=n(3668)("iterator"),i=!1;try{var s=0,o={next:function(){return{done:!!s++}},return:function(){i=!0}};o[r]=function(){return this},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var s={};s[r]=function(){return{next:function(){return{done:n=!0}}}},e(s)}catch(e){}return n}},4108:(e,t,n)=>{var r=n(604),i=r({}.toString),s=r("".slice);e.exports=function(e){return s(i(e),8,-1)}},1248:(e,t,n)=>{var r=n(1600),i=n(7796),s=n(984),o=n(4108),a=n(3668)("toStringTag"),c=r.Object,l="Arguments"==o(function(){return arguments}());e.exports=i?o:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=c(e),a))?n:l?o(t):"Object"==(r=o(t))&&s(t.callee)?"Arguments":r}},7539:(e,t,n)=>{"use strict";var r=n(7072).f,i=n(124),s=n(7431),o=n(5616),a=n(2932),c=n(9928),l=n(2648),u=n(9688),h=n(2828),d=n(8756).fastKey,p=n(7932),f=p.set,g=p.getterFor;e.exports={getConstructor:function(e,t,n,l){var u=e((function(e,r){a(e,p),f(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),h||(e.size=0),null!=r&&c(r,e[l],{that:e,AS_ENTRIES:n})})),p=u.prototype,m=g(t),v=function(e,t,n){var r,i,s=m(e),o=_(e,t);return o?o.value=n:(s.last=o={index:i=d(t,!0),key:t,value:n,previous:r=s.last,next:void 0,removed:!1},s.first||(s.first=o),r&&(r.next=o),h?s.size++:e.size++,"F"!==i&&(s.index[i]=o)),e},_=function(e,t){var n,r=m(e),i=d(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return s(p,{clear:function(){for(var e=m(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,h?e.size=0:this.size=0},delete:function(e){var t=this,n=m(t),r=_(t,e);if(r){var i=r.next,s=r.previous;delete n.index[r.index],r.removed=!0,s&&(s.next=i),i&&(i.previous=s),n.first==r&&(n.first=i),n.last==r&&(n.last=s),h?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=m(this),r=o(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!_(this,e)}}),s(p,n?{get:function(e){var t=_(this,e);return t&&t.value},set:function(e,t){return v(this,0===e?0:e,t)}}:{add:function(e){return v(this,e=0===e?0:e,e)}}),h&&r(p,"size",{get:function(){return m(this).size}}),u},setStrong:function(e,t,n){var r=t+" Iterator",i=g(t),s=g(r);l(e,t,(function(e,t){f(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=s(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),u(t)}}},6064:(e,t,n)=>{"use strict";var r=n(7248),i=n(1600),s=n(604),o=n(4232),a=n(5028),c=n(8756),l=n(9928),u=n(2932),h=n(984),d=n(9952),p=n(7004),f=n(6344),g=n(9540),m=n(2928);e.exports=function(e,t,n){var v=-1!==e.indexOf("Map"),_=-1!==e.indexOf("Weak"),y=v?"set":"add",w=i[e],b=w&&w.prototype,I=w,k={},C=function(e){var t=s(b[e]);a(b,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(_&&!d(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return _&&!d(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(_&&!d(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(o(e,!h(w)||!(_||b.forEach&&!p((function(){(new w).entries().next()})))))I=n.getConstructor(t,e,v,y),c.enable();else if(o(e,!0)){var S=new I,T=S[y](_?{}:-0,1)!=S,E=p((function(){S.has(1)})),x=f((function(e){new w(e)})),P=!_&&p((function(){for(var e=new w,t=5;t--;)e[y](t,t);return!e.has(-0)}));x||((I=t((function(e,t){u(e,b);var n=m(new w,e,I);return null!=t&&l(t,n[y],{that:n,AS_ENTRIES:v}),n}))).prototype=b,b.constructor=I),(E||P)&&(C("delete"),C("has"),v&&C("get")),(P||T)&&C(y),_&&b.clear&&delete b.clear}return k[e]=I,r({global:!0,forced:I!=w},k),g(I,e),_||n.setStrong(I,e,v),I}},4640:(e,t,n)=>{var r=n(9180),i=n(4092),s=n(2920),o=n(7072);e.exports=function(e,t,n){for(var a=i(t),c=o.f,l=s.f,u=0;u<a.length;u++){var h=a[u];r(e,h)||n&&r(n,h)||c(e,h,l(t,h))}}},1275:(e,t,n)=>{var r=n(3668)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},1040:(e,t,n)=>{var r=n(7004);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},240:(e,t,n)=>{var r=n(604),i=n(1840),s=n(748),o=/"/g,a=r("".replace);e.exports=function(e,t,n,r){var c=s(i(e)),l="<"+t;return""!==n&&(l+=" "+n+'="'+a(s(r),o,"&quot;")+'"'),l+">"+c+"</"+t+">"}},9292:(e,t,n)=>{"use strict";var r=n(804).IteratorPrototype,i=n(124),s=n(364),o=n(9540),a=n(2204),c=function(){return this};e.exports=function(e,t,n,l){var u=t+" Iterator";return e.prototype=i(r,{next:s(+!l,n)}),o(e,u,!1,!0),a[u]=c,e}},4768:(e,t,n)=>{var r=n(2828),i=n(7072),s=n(364);e.exports=r?function(e,t,n){return i.f(e,t,s(1,n))}:function(e,t,n){return e[t]=n,e}},364:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},4135:(e,t,n)=>{"use strict";var r=n(4061),i=n(7072),s=n(364);e.exports=function(e,t,n){var o=r(t);o in e?i.f(e,o,s(0,n)):e[o]=n}},2648:(e,t,n)=>{"use strict";var r=n(7248),i=n(3032),s=n(7408),o=n(8492),a=n(984),c=n(9292),l=n(6232),u=n(3440),h=n(9540),d=n(4768),p=n(5028),f=n(3668),g=n(2204),m=n(804),v=o.PROPER,_=o.CONFIGURABLE,y=m.IteratorPrototype,w=m.BUGGY_SAFARI_ITERATORS,b=f("iterator"),I="keys",k="values",C="entries",S=function(){return this};e.exports=function(e,t,n,o,f,m,T){c(n,t,o);var E,x,P,O=function(e){if(e===f&&L)return L;if(!w&&e in A)return A[e];switch(e){case I:case k:case C:return function(){return new n(this,e)}}return function(){return new n(this)}},R=t+" Iterator",N=!1,A=e.prototype,D=A[b]||A["@@iterator"]||f&&A[f],L=!w&&D||O(f),M="Array"==t&&A.entries||D;if(M&&(E=l(M.call(new e)))!==Object.prototype&&E.next&&(s||l(E)===y||(u?u(E,y):a(E[b])||p(E,b,S)),h(E,R,!0,!0),s&&(g[R]=S)),v&&f==k&&D&&D.name!==k&&(!s&&_?d(A,"name",k):(N=!0,L=function(){return i(D,this)})),f)if(x={values:O(k),keys:m?L:O(I),entries:O(C)},T)for(P in x)(w||N||!(P in A))&&p(A,P,x[P]);else r({target:t,proto:!0,forced:w||N},x);return s&&!T||A[b]===L||p(A,b,L,{name:f}),g[t]=L,x}},5248:(e,t,n)=>{var r=n(340),i=n(9180),s=n(6256),o=n(7072).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});i(t,e)||o(t,e,{value:s.f(e)})}},2828:(e,t,n)=>{var r=n(7004);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},7300:(e,t,n)=>{var r=n(1600),i=n(9952),s=r.document,o=i(s)&&i(s.createElement);e.exports=function(e){return o?s.createElement(e):{}}},732:(e,t,n)=>{var r=n(5316).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},2936:(e,t,n)=>{var r=n(5316);e.exports=/MSIE|Trident/.test(r)},3640:(e,t,n)=>{var r=n(4108),i=n(1600);e.exports="process"==r(i.process)},5316:(e,t,n)=>{var r=n(6532);e.exports=r("navigator","userAgent")||""},2592:(e,t,n)=>{var r,i,s=n(1600),o=n(5316),a=s.process,c=s.Deno,l=a&&a.versions||c&&c.version,u=l&&l.v8;u&&(i=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&o&&(!(r=o.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},7413:(e,t,n)=>{var r=n(5316).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},8675:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},7248:(e,t,n)=>{var r=n(1600),i=n(2920).f,s=n(4768),o=n(5028),a=n(2984),c=n(4640),l=n(4232);e.exports=function(e,t){var n,u,h,d,p,f=e.target,g=e.global,m=e.stat;if(n=g?r:m?r[f]||a(f,{}):(r[f]||{}).prototype)for(u in t){if(d=t[u],h=e.noTargetGet?(p=i(n,u))&&p.value:n[u],!l(g?u:f+(m?".":"#")+u,e.forced)&&void 0!==h){if(typeof d==typeof h)continue;c(d,h)}(e.sham||h&&h.sham)&&s(d,"sham",!0),o(n,u,d,e)}}},7004:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},7712:(e,t,n)=>{"use strict";n(3768);var r=n(604),i=n(5028),s=n(9212),o=n(7004),a=n(3668),c=n(4768),l=a("species"),u=RegExp.prototype;e.exports=function(e,t,n,h){var d=a(e),p=!o((function(){var t={};return t[d]=function(){return 7},7!=""[e](t)})),f=p&&!o((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[l]=function(){return n},n.flags="",n[d]=/./[d]),n.exec=function(){return t=!0,null},n[d](""),!t}));if(!p||!f||n){var g=r(/./[d]),m=t(d,""[e],(function(e,t,n,i,o){var a=r(e),c=t.exec;return c===s||c===u.exec?p&&!o?{done:!0,value:g(t,n,i)}:{done:!0,value:a(n,t,i)}:{done:!1}}));i(String.prototype,e,m[0]),i(u,d,m[1])}h&&c(u[d],"sham",!0)}},793:(e,t,n)=>{"use strict";var r=n(1600),i=n(5240),s=n(9183),o=n(5616),a=r.TypeError,c=function(e,t,n,r,l,u,h,d){for(var p,f,g=l,m=0,v=!!h&&o(h,d);m<r;){if(m in n){if(p=v?v(n[m],m,t):n[m],u>0&&i(p))f=s(p),g=c(e,t,p,f,g,u-1)-1;else{if(g>=9007199254740991)throw a("Exceed the acceptable array length");e[g]=p}g++}m++}return g};e.exports=c},1748:(e,t,n)=>{var r=n(7004);e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},9756:e=>{var t=Function.prototype,n=t.apply,r=t.bind,i=t.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?i.bind(n):function(){return i.apply(n,arguments)})},5616:(e,t,n)=>{var r=n(604),i=n(1381),s=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:s?s(e,t):function(){return e.apply(t,arguments)}}},3032:e=>{var t=Function.prototype.call;e.exports=t.bind?t.bind(t):function(){return t.apply(t,arguments)}},8492:(e,t,n)=>{var r=n(2828),i=n(9180),s=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,a=i(s,"name"),c=a&&"something"===function(){}.name,l=a&&(!r||r&&o(s,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:l}},604:e=>{var t=Function.prototype,n=t.bind,r=t.call,i=n&&n.bind(r);e.exports=n?function(e){return e&&i(r,e)}:function(e){return e&&function(){return r.apply(e,arguments)}}},6532:(e,t,n)=>{var r=n(1600),i=n(984);e.exports=function(e,t){return arguments.length<2?(n=r[e],i(n)?n:void 0):r[e]&&r[e][t];var n}},8132:(e,t,n)=>{var r=n(1248),i=n(8808),s=n(2204),o=n(3668)("iterator");e.exports=function(e){if(null!=e)return i(e,o)||i(e,"@@iterator")||s[r(e)]}},4944:(e,t,n)=>{var r=n(1600),i=n(3032),s=n(1381),o=n(3736),a=n(1532),c=n(8132),l=r.TypeError;e.exports=function(e,t){var n=arguments.length<2?c(e):t;if(s(n))return o(i(n,e));throw l(a(e)+" is not iterable")}},8808:(e,t,n)=>{var r=n(1381);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},4208:(e,t,n)=>{var r=n(604),i=n(3848),s=Math.floor,o=r("".charAt),a=r("".replace),c=r("".slice),l=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,h,d){var p=n+e.length,f=r.length,g=u;return void 0!==h&&(h=i(h),g=l),a(d,g,(function(i,a){var l;switch(o(a,0)){case"$":return"$";case"&":return e;case"`":return c(t,0,n);case"'":return c(t,p);case"<":l=h[c(a,1,-1)];break;default:var u=+a;if(0===u)return i;if(u>f){var d=s(u/10);return 0===d?i:d<=f?void 0===r[d-1]?o(a,1):r[d-1]+o(a,1):i}l=r[u-1]}return void 0===l?"":l}))}},1600:(e,t,n)=>{var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},9180:(e,t,n)=>{var r=n(604),i=n(3848),s=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(i(e),t)}},6632:e=>{e.exports={}},2960:(e,t,n)=>{var r=n(6532);e.exports=r("document","documentElement")},2339:(e,t,n)=>{var r=n(2828),i=n(7004),s=n(7300);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},3188:(e,t,n)=>{var r=n(1600),i=n(604),s=n(7004),o=n(4108),a=r.Object,c=i("".split);e.exports=s((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==o(e)?c(e,""):a(e)}:a},2928:(e,t,n)=>{var r=n(984),i=n(9952),s=n(3440);e.exports=function(e,t,n){var o,a;return s&&r(o=t.constructor)&&o!==n&&i(a=o.prototype)&&a!==n.prototype&&s(e,a),e}},1727:(e,t,n)=>{var r=n(604),i=n(984),s=n(6376),o=r(Function.toString);i(s.inspectSource)||(s.inspectSource=function(e){return o(e)}),e.exports=s.inspectSource},8756:(e,t,n)=>{var r=n(7248),i=n(604),s=n(6632),o=n(9952),a=n(9180),c=n(7072).f,l=n(4880),u=n(7316),h=n(5548),d=n(6536),p=n(1748),f=!1,g=d("meta"),m=0,v=function(e){c(e,g,{value:{objectID:"O"+m++,weakData:{}}})},_=e.exports={enable:function(){_.enable=function(){},f=!0;var e=l.f,t=i([].splice),n={};n[g]=1,e(n).length&&(l.f=function(n){for(var r=e(n),i=0,s=r.length;i<s;i++)if(r[i]===g){t(r,i,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,g)){if(!h(e))return"F";if(!t)return"E";v(e)}return e[g].objectID},getWeakData:function(e,t){if(!a(e,g)){if(!h(e))return!0;if(!t)return!1;v(e)}return e[g].weakData},onFreeze:function(e){return p&&f&&h(e)&&!a(e,g)&&v(e),e}};s[g]=!0},7932:(e,t,n)=>{var r,i,s,o=n(8736),a=n(1600),c=n(604),l=n(9952),u=n(4768),h=n(9180),d=n(6376),p=n(280),f=n(6632),g="Object already initialized",m=a.TypeError,v=a.WeakMap;if(o||d.state){var _=d.state||(d.state=new v),y=c(_.get),w=c(_.has),b=c(_.set);r=function(e,t){if(w(_,e))throw new m(g);return t.facade=e,b(_,e,t),t},i=function(e){return y(_,e)||{}},s=function(e){return w(_,e)}}else{var I=p("state");f[I]=!0,r=function(e,t){if(h(e,I))throw new m(g);return t.facade=e,u(e,I,t),t},i=function(e){return h(e,I)?e[I]:{}},s=function(e){return h(e,I)}}e.exports={set:r,get:i,has:s,enforce:function(e){return s(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=i(t)).type!==e)throw m("Incompatible receiver, "+e+" required");return n}}}},1680:(e,t,n)=>{var r=n(3668),i=n(2204),s=r("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[s]===e)}},5240:(e,t,n)=>{var r=n(4108);e.exports=Array.isArray||function(e){return"Array"==r(e)}},984:e=>{e.exports=function(e){return"function"==typeof e}},5220:(e,t,n)=>{var r=n(604),i=n(7004),s=n(984),o=n(1248),a=n(6532),c=n(1727),l=function(){},u=[],h=a("Reflect","construct"),d=/^\s*(?:class|function)\b/,p=r(d.exec),f=!d.exec(l),g=function(e){if(!s(e))return!1;try{return h(l,u,e),!0}catch(e){return!1}},m=function(e){if(!s(e))return!1;switch(o(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!p(d,c(e))}catch(e){return!0}};m.sham=!0,e.exports=!h||i((function(){var e;return g(g.call)||!g(Object)||!g((function(){e=!0}))||e}))?m:g},4232:(e,t,n)=>{var r=n(7004),i=n(984),s=/#|\.prototype\./,o=function(e,t){var n=c[a(e)];return n==u||n!=l&&(i(t)?r(t):!!t)},a=o.normalize=function(e){return String(e).replace(s,".").toLowerCase()},c=o.data={},l=o.NATIVE="N",u=o.POLYFILL="P";e.exports=o},9952:(e,t,n)=>{var r=n(984);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},7408:e=>{e.exports=!1},7724:(e,t,n)=>{var r=n(9952),i=n(4108),s=n(3668)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==i(e))}},1836:(e,t,n)=>{var r=n(1600),i=n(6532),s=n(984),o=n(2408),a=n(7216),c=r.Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return s(t)&&o(t.prototype,c(e))}},9928:(e,t,n)=>{var r=n(1600),i=n(5616),s=n(3032),o=n(3736),a=n(1532),c=n(1680),l=n(9183),u=n(2408),h=n(4944),d=n(8132),p=n(1792),f=r.TypeError,g=function(e,t){this.stopped=e,this.result=t},m=g.prototype;e.exports=function(e,t,n){var r,v,_,y,w,b,I,k=n&&n.that,C=!(!n||!n.AS_ENTRIES),S=!(!n||!n.IS_ITERATOR),T=!(!n||!n.INTERRUPTED),E=i(t,k),x=function(e){return r&&p(r,"normal",e),new g(!0,e)},P=function(e){return C?(o(e),T?E(e[0],e[1],x):E(e[0],e[1])):T?E(e,x):E(e)};if(S)r=e;else{if(!(v=d(e)))throw f(a(e)+" is not iterable");if(c(v)){for(_=0,y=l(e);y>_;_++)if((w=P(e[_]))&&u(m,w))return w;return new g(!1)}r=h(e,v)}for(b=r.next;!(I=s(b,r)).done;){try{w=P(I.value)}catch(e){p(r,"throw",e)}if("object"==typeof w&&w&&u(m,w))return w}return new g(!1)}},1792:(e,t,n)=>{var r=n(3032),i=n(3736),s=n(8808);e.exports=function(e,t,n){var o,a;i(e);try{if(!(o=s(e,"return"))){if("throw"===t)throw n;return n}o=r(o,e)}catch(e){a=!0,o=e}if("throw"===t)throw n;if(a)throw o;return i(o),n}},804:(e,t,n)=>{"use strict";var r,i,s,o=n(7004),a=n(984),c=n(124),l=n(6232),u=n(5028),h=n(3668),d=n(7408),p=h("iterator"),f=!1;[].keys&&("next"in(s=[].keys())?(i=l(l(s)))!==Object.prototype&&(r=i):f=!0),null==r||o((function(){var e={};return r[p].call(e)!==e}))?r={}:d&&(r=c(r)),a(r[p])||u(r,p,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:f}},2204:e=>{e.exports={}},9183:(e,t,n)=>{var r=n(1868);e.exports=function(e){return r(e.length)}},3880:(e,t,n)=>{var r=n(2592),i=n(7004);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},8736:(e,t,n)=>{var r=n(1600),i=n(984),s=n(1727),o=r.WeakMap;e.exports=i(o)&&/native code/.test(s(o))},6520:(e,t,n)=>{var r=n(1600),i=n(7724),s=r.TypeError;e.exports=function(e){if(i(e))throw s("The method doesn't accept regular expressions");return e}},6984:(e,t,n)=>{"use strict";var r=n(2828),i=n(604),s=n(3032),o=n(7004),a=n(9880),c=n(2128),l=n(5988),u=n(3848),h=n(3188),d=Object.assign,p=Object.defineProperty,f=i([].concat);e.exports=!d||o((function(){if(r&&1!==d({b:1},d(p({},"a",{enumerable:!0,get:function(){p(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||a(d({},t)).join("")!=i}))?function(e,t){for(var n=u(e),i=arguments.length,o=1,d=c.f,p=l.f;i>o;)for(var g,m=h(arguments[o++]),v=d?f(a(m),d(m)):a(m),_=v.length,y=0;_>y;)g=v[y++],r&&!s(p,m,g)||(n[g]=m[g]);return n}:d},124:(e,t,n)=>{var r,i=n(3736),s=n(1904),o=n(8675),a=n(6632),c=n(2960),l=n(7300),u=n(280),h="prototype",d="script",p=u("IE_PROTO"),f=function(){},g=function(e){return"<"+d+">"+e+"</"+d+">"},m=function(e){e.write(g("")),e.close();var t=e.parentWindow.Object;return e=null,t},v=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;v="undefined"!=typeof document?document.domain&&r?m(r):(t=l("iframe"),n="java"+d+":",t.style.display="none",c.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(g("document.F=Object")),e.close(),e.F):m(r);for(var i=o.length;i--;)delete v[h][o[i]];return v()};a[p]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(f[h]=i(e),n=new f,f[h]=null,n[p]=e):n=v(),void 0===t?n:s(n,t)}},1904:(e,t,n)=>{var r=n(2828),i=n(7072),s=n(3736),o=n(3068),a=n(9880);e.exports=r?Object.defineProperties:function(e,t){s(e);for(var n,r=o(t),c=a(t),l=c.length,u=0;l>u;)i.f(e,n=c[u++],r[n]);return e}},7072:(e,t,n)=>{var r=n(1600),i=n(2828),s=n(2339),o=n(3736),a=n(4061),c=r.TypeError,l=Object.defineProperty;t.f=i?l:function(e,t,n){if(o(e),t=a(t),o(n),s)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},2920:(e,t,n)=>{var r=n(2828),i=n(3032),s=n(5988),o=n(364),a=n(3068),c=n(4061),l=n(9180),u=n(2339),h=Object.getOwnPropertyDescriptor;t.f=r?h:function(e,t){if(e=a(e),t=c(t),u)try{return h(e,t)}catch(e){}if(l(e,t))return o(!i(s.f,e,t),e[t])}},7316:(e,t,n)=>{var r=n(4108),i=n(3068),s=n(4880).f,o=n(9472),a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"Window"==r(e)?function(e){try{return s(e)}catch(e){return o(a)}}(e):s(i(e))}},4880:(e,t,n)=>{var r=n(9912),i=n(8675).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},2128:(e,t)=>{t.f=Object.getOwnPropertySymbols},6232:(e,t,n)=>{var r=n(1600),i=n(9180),s=n(984),o=n(3848),a=n(280),c=n(1040),l=a("IE_PROTO"),u=r.Object,h=u.prototype;e.exports=c?u.getPrototypeOf:function(e){var t=o(e);if(i(t,l))return t[l];var n=t.constructor;return s(n)&&t instanceof n?n.prototype:t instanceof u?h:null}},5548:(e,t,n)=>{var r=n(7004),i=n(9952),s=n(4108),o=n(4328),a=Object.isExtensible,c=r((function(){a(1)}));e.exports=c||o?function(e){return!!i(e)&&(!o||"ArrayBuffer"!=s(e))&&(!a||a(e))}:a},2408:(e,t,n)=>{var r=n(604);e.exports=r({}.isPrototypeOf)},9912:(e,t,n)=>{var r=n(604),i=n(9180),s=n(3068),o=n(6024).indexOf,a=n(6632),c=r([].push);e.exports=function(e,t){var n,r=s(e),l=0,u=[];for(n in r)!i(a,n)&&i(r,n)&&c(u,n);for(;t.length>l;)i(r,n=t[l++])&&(~o(u,n)||c(u,n));return u}},9880:(e,t,n)=>{var r=n(9912),i=n(8675);e.exports=Object.keys||function(e){return r(e,i)}},5988:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},8664:(e,t,n)=>{"use strict";var r=n(7408),i=n(1600),s=n(7004),o=n(7413);e.exports=r||!s((function(){if(!(o&&o<535)){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete i[e]}}))},3440:(e,t,n)=>{var r=n(604),i=n(3736),s=n(4040);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return i(n),s(r),t?e(n,r):n.__proto__=r,n}}():void 0)},5556:(e,t,n)=>{var r=n(2828),i=n(604),s=n(9880),o=n(3068),a=i(n(5988).f),c=i([].push),l=function(e){return function(t){for(var n,i=o(t),l=s(i),u=l.length,h=0,d=[];u>h;)n=l[h++],r&&!a(i,n)||c(d,e?[n,i[n]]:i[n]);return d}};e.exports={entries:l(!0),values:l(!1)}},2816:(e,t,n)=>{"use strict";var r=n(7796),i=n(1248);e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},7540:(e,t,n)=>{var r=n(1600),i=n(3032),s=n(984),o=n(9952),a=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&s(n=e.toString)&&!o(r=i(n,e)))return r;if(s(n=e.valueOf)&&!o(r=i(n,e)))return r;if("string"!==t&&s(n=e.toString)&&!o(r=i(n,e)))return r;throw a("Can't convert object to primitive value")}},4092:(e,t,n)=>{var r=n(6532),i=n(604),s=n(4880),o=n(2128),a=n(3736),c=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=s.f(a(e)),n=o.f;return n?c(t,n(e)):t}},340:(e,t,n)=>{var r=n(1600);e.exports=r},7431:(e,t,n)=>{var r=n(5028);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},5028:(e,t,n)=>{var r=n(1600),i=n(984),s=n(9180),o=n(4768),a=n(2984),c=n(1727),l=n(7932),u=n(8492).CONFIGURABLE,h=l.get,d=l.enforce,p=String(String).split("String");(e.exports=function(e,t,n,c){var l,h=!!c&&!!c.unsafe,f=!!c&&!!c.enumerable,g=!!c&&!!c.noTargetGet,m=c&&void 0!==c.name?c.name:t;i(n)&&("Symbol("===String(m).slice(0,7)&&(m="["+String(m).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!s(n,"name")||u&&n.name!==m)&&o(n,"name",m),(l=d(n)).source||(l.source=p.join("string"==typeof m?m:""))),e!==r?(h?!g&&e[t]&&(f=!0):delete e[t],f?e[t]=n:o(e,t,n)):f?e[t]=n:a(t,n)})(Function.prototype,"toString",(function(){return i(this)&&h(this).source||c(this)}))},3800:(e,t,n)=>{var r=n(1600),i=n(3032),s=n(3736),o=n(984),a=n(4108),c=n(9212),l=r.TypeError;e.exports=function(e,t){var n=e.exec;if(o(n)){var r=i(n,e,t);return null!==r&&s(r),r}if("RegExp"===a(e))return i(c,e,t);throw l("RegExp#exec called on incompatible receiver")}},9212:(e,t,n)=>{"use strict";var r,i,s=n(3032),o=n(604),a=n(748),c=n(7003),l=n(528),u=n(4624),h=n(124),d=n(7932).get,p=n(8992),f=n(3044),g=u("native-string-replace",String.prototype.replace),m=RegExp.prototype.exec,v=m,_=o("".charAt),y=o("".indexOf),w=o("".replace),b=o("".slice),I=(i=/b*/g,s(m,r=/a/,"a"),s(m,i,"a"),0!==r.lastIndex||0!==i.lastIndex),k=l.BROKEN_CARET,C=void 0!==/()??/.exec("")[1];(I||C||k||p||f)&&(v=function(e){var t,n,r,i,o,l,u,p=this,f=d(p),S=a(e),T=f.raw;if(T)return T.lastIndex=p.lastIndex,t=s(v,T,S),p.lastIndex=T.lastIndex,t;var E=f.groups,x=k&&p.sticky,P=s(c,p),O=p.source,R=0,N=S;if(x&&(P=w(P,"y",""),-1===y(P,"g")&&(P+="g"),N=b(S,p.lastIndex),p.lastIndex>0&&(!p.multiline||p.multiline&&"\n"!==_(S,p.lastIndex-1))&&(O="(?: "+O+")",N=" "+N,R++),n=new RegExp("^(?:"+O+")",P)),C&&(n=new RegExp("^"+O+"$(?!\\s)",P)),I&&(r=p.lastIndex),i=s(m,x?n:p,N),x?i?(i.input=b(i.input,R),i[0]=b(i[0],R),i.index=p.lastIndex,p.lastIndex+=i[0].length):p.lastIndex=0:I&&i&&(p.lastIndex=p.global?i.index+i[0].length:r),C&&i&&i.length>1&&s(g,i[0],n,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&E)for(i.groups=l=h(null),o=0;o<E.length;o++)l[(u=E[o])[0]]=i[u[1]];return i}),e.exports=v},7003:(e,t,n)=>{"use strict";var r=n(3736);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},528:(e,t,n)=>{var r=n(7004),i=n(1600).RegExp,s=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),o=s||r((function(){return!i("a","y").sticky})),a=s||r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:a,MISSED_STICKY:o,UNSUPPORTED_Y:s}},8992:(e,t,n)=>{var r=n(7004),i=n(1600).RegExp;e.exports=r((function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},3044:(e,t,n)=>{var r=n(7004),i=n(1600).RegExp;e.exports=r((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},1840:(e,t,n)=>{var r=n(1600).TypeError;e.exports=function(e){if(null==e)throw r("Can't call method on "+e);return e}},176:e=>{e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},2984:(e,t,n)=>{var r=n(1600),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},9688:(e,t,n)=>{"use strict";var r=n(6532),i=n(7072),s=n(3668),o=n(2828),a=s("species");e.exports=function(e){var t=r(e),n=i.f;o&&t&&!t[a]&&n(t,a,{configurable:!0,get:function(){return this}})}},9540:(e,t,n)=>{var r=n(7072).f,i=n(9180),s=n(3668)("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!i(e,s)&&r(e,s,{configurable:!0,value:t})}},280:(e,t,n)=>{var r=n(4624),i=n(6536),s=r("keys");e.exports=function(e){return s[e]||(s[e]=i(e))}},6376:(e,t,n)=>{var r=n(1600),i=n(2984),s="__core-js_shared__",o=r[s]||i(s,{});e.exports=o},4624:(e,t,n)=>{var r=n(7408),i=n(6376);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.0",mode:r?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},7171:(e,t,n)=>{var r=n(3736),i=n(6372),s=n(3668)("species");e.exports=function(e,t){var n,o=r(e).constructor;return void 0===o||null==(n=r(o)[s])?t:i(n)}},72:(e,t,n)=>{var r=n(7004);e.exports=function(e){return r((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},2780:(e,t,n)=>{var r=n(604),i=n(9824),s=n(748),o=n(1840),a=r("".charAt),c=r("".charCodeAt),l=r("".slice),u=function(e){return function(t,n){var r,u,h=s(o(t)),d=i(n),p=h.length;return d<0||d>=p?e?"":void 0:(r=c(h,d))<55296||r>56319||d+1===p||(u=c(h,d+1))<56320||u>57343?e?a(h,d):r:e?l(h,d,d+2):u-56320+(r-55296<<10)+65536}};e.exports={codeAt:u(!1),charAt:u(!0)}},6696:(e,t,n)=>{var r=n(5316);e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},2532:(e,t,n)=>{var r=n(604),i=n(1868),s=n(748),o=n(7512),a=n(1840),c=r(o),l=r("".slice),u=Math.ceil,h=function(e){return function(t,n,r){var o,h,d=s(a(t)),p=i(n),f=d.length,g=void 0===r?" ":s(r);return p<=f||""==g?d:((h=c(g,u((o=p-f)/g.length))).length>o&&(h=l(h,0,o)),e?d+h:h+d)}};e.exports={start:h(!1),end:h(!0)}},7512:(e,t,n)=>{"use strict";var r=n(1600),i=n(9824),s=n(748),o=n(1840),a=r.RangeError;e.exports=function(e){var t=s(o(this)),n="",r=i(e);if(r<0||r==1/0)throw a("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}},2832:(e,t,n)=>{var r=n(8492).PROPER,i=n(7004),s=n(5320);e.exports=function(e){return i((function(){return!!s[e]()||"​᠎"!=="​᠎"[e]()||r&&s[e].name!==e}))}},1688:(e,t,n)=>{var r=n(604),i=n(1840),s=n(748),o=n(5320),a=r("".replace),c="["+o+"]",l=RegExp("^"+c+c+"*"),u=RegExp(c+c+"*$"),h=function(e){return function(t){var n=s(i(t));return 1&e&&(n=a(n,l,"")),2&e&&(n=a(n,u,"")),n}};e.exports={start:h(1),end:h(2),trim:h(3)}},7920:(e,t,n)=>{var r=n(9824),i=Math.max,s=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):s(n,t)}},3068:(e,t,n)=>{var r=n(3188),i=n(1840);e.exports=function(e){return r(i(e))}},9824:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){var r=+e;return r!=r||0===r?0:(r>0?n:t)(r)}},1868:(e,t,n)=>{var r=n(9824),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},3848:(e,t,n)=>{var r=n(1600),i=n(1840),s=r.Object;e.exports=function(e){return s(i(e))}},2312:(e,t,n)=>{var r=n(1600),i=n(3032),s=n(9952),o=n(1836),a=n(8808),c=n(7540),l=n(3668),u=r.TypeError,h=l("toPrimitive");e.exports=function(e,t){if(!s(e)||o(e))return e;var n,r=a(e,h);if(r){if(void 0===t&&(t="default"),n=i(r,e,t),!s(n)||o(n))return n;throw u("Can't convert object to primitive value")}return void 0===t&&(t="number"),c(e,t)}},4061:(e,t,n)=>{var r=n(2312),i=n(1836);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},7796:(e,t,n)=>{var r={};r[n(3668)("toStringTag")]="z",e.exports="[object z]"===String(r)},748:(e,t,n)=>{var r=n(1600),i=n(1248),s=r.String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return s(e)}},1532:(e,t,n)=>{var r=n(1600).String;e.exports=function(e){try{return r(e)}catch(e){return"Object"}}},6536:(e,t,n)=>{var r=n(604),i=0,s=Math.random(),o=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++i+s,36)}},7216:(e,t,n)=>{var r=n(3880);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},6256:(e,t,n)=>{var r=n(3668);t.f=r},3668:(e,t,n)=>{var r=n(1600),i=n(4624),s=n(9180),o=n(6536),a=n(3880),c=n(7216),l=i("wks"),u=r.Symbol,h=u&&u.for,d=c?u:u&&u.withoutSetter||o;e.exports=function(e){if(!s(l,e)||!a&&"string"!=typeof l[e]){var t="Symbol."+e;a&&s(u,e)?l[e]=u[e]:l[e]=c&&h?h(t):d(t)}return l[e]}},5320:e=>{e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},6716:(e,t,n)=>{"use strict";var r=n(7248),i=n(3848),s=n(9183),o=n(9824),a=n(5868);r({target:"Array",proto:!0},{at:function(e){var t=i(this),n=s(t),r=o(e),a=r>=0?r:n+r;return a<0||a>=n?void 0:t[a]}}),a("at")},9692:(e,t,n)=>{"use strict";var r=n(7248),i=n(1600),s=n(7004),o=n(5240),a=n(9952),c=n(3848),l=n(9183),u=n(4135),h=n(1220),d=n(4696),p=n(3668),f=n(2592),g=p("isConcatSpreadable"),m=9007199254740991,v="Maximum allowed index exceeded",_=i.TypeError,y=f>=51||!s((function(){var e=[];return e[g]=!1,e.concat()[0]!==e})),w=d("concat"),b=function(e){if(!a(e))return!1;var t=e[g];return void 0!==t?!!t:o(e)};r({target:"Array",proto:!0,forced:!y||!w},{concat:function(e){var t,n,r,i,s,o=c(this),a=h(o,0),d=0;for(t=-1,r=arguments.length;t<r;t++)if(b(s=-1===t?o:arguments[t])){if(d+(i=l(s))>m)throw _(v);for(n=0;n<i;n++,d++)n in s&&u(a,d,s[n])}else{if(d>=m)throw _(v);u(a,d++,s)}return a.length=d,a}})},7416:(e,t,n)=>{var r=n(7248),i=n(4048),s=n(5868);r({target:"Array",proto:!0},{copyWithin:i}),s("copyWithin")},1408:(e,t,n)=>{"use strict";var r=n(7248),i=n(9560).every;r({target:"Array",proto:!0,forced:!n(6608)("every")},{every:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},6208:(e,t,n)=>{var r=n(7248),i=n(3156),s=n(5868);r({target:"Array",proto:!0},{fill:i}),s("fill")},2676:(e,t,n)=>{"use strict";var r=n(7248),i=n(9560).filter;r({target:"Array",proto:!0,forced:!n(4696)("filter")},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},3468:(e,t,n)=>{"use strict";var r=n(7248),i=n(9560).findIndex,s=n(5868),o="findIndex",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),r({target:"Array",proto:!0,forced:a},{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s(o)},5092:(e,t,n)=>{"use strict";var r=n(7248),i=n(9560).find,s=n(5868),o="find",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),r({target:"Array",proto:!0,forced:a},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s(o)},8160:(e,t,n)=>{"use strict";var r=n(7248),i=n(793),s=n(1381),o=n(3848),a=n(9183),c=n(1220);r({target:"Array",proto:!0},{flatMap:function(e){var t,n=o(this),r=a(n);return s(e),(t=c(n,0)).length=i(t,n,n,r,0,1,e,arguments.length>1?arguments[1]:void 0),t}})},3608:(e,t,n)=>{"use strict";var r=n(7248),i=n(793),s=n(3848),o=n(9183),a=n(9824),c=n(1220);r({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=s(this),n=o(t),r=c(t,0);return r.length=i(r,t,t,n,0,void 0===e?1:a(e)),r}})},3696:(e,t,n)=>{"use strict";var r=n(7248),i=n(4e3);r({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},5684:(e,t,n)=>{var r=n(7248),i=n(8208);r({target:"Array",stat:!0,forced:!n(6344)((function(e){Array.from(e)}))},{from:i})},3616:(e,t,n)=>{"use strict";var r=n(7248),i=n(6024).includes,s=n(5868);r({target:"Array",proto:!0},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s("includes")},1872:(e,t,n)=>{"use strict";var r=n(7248),i=n(604),s=n(6024).indexOf,o=n(6608),a=i([].indexOf),c=!!a&&1/a([1],1,-0)<0,l=o("indexOf");r({target:"Array",proto:!0,forced:c||!l},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return c?a(this,e,t)||0:s(this,e,t)}})},3784:(e,t,n)=>{n(7248)({target:"Array",stat:!0},{isArray:n(5240)})},3924:(e,t,n)=>{"use strict";var r=n(3068),i=n(5868),s=n(2204),o=n(7932),a=n(7072).f,c=n(2648),l=n(7408),u=n(2828),h="Array Iterator",d=o.set,p=o.getterFor(h);e.exports=c(Array,"Array",(function(e,t){d(this,{type:h,target:r(e),index:0,kind:t})}),(function(){var e=p(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");var f=s.Arguments=s.Array;if(i("keys"),i("values"),i("entries"),!l&&u&&"values"!==f.name)try{a(f,"name",{value:"values"})}catch(e){}},6456:(e,t,n)=>{"use strict";var r=n(7248),i=n(604),s=n(3188),o=n(3068),a=n(6608),c=i([].join),l=s!=Object,u=a("join",",");r({target:"Array",proto:!0,forced:l||!u},{join:function(e){return c(o(this),void 0===e?",":e)}})},444:(e,t,n)=>{var r=n(7248),i=n(5696);r({target:"Array",proto:!0,forced:i!==[].lastIndexOf},{lastIndexOf:i})},5164:(e,t,n)=>{"use strict";var r=n(7248),i=n(9560).map;r({target:"Array",proto:!0,forced:!n(4696)("map")},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},5208:(e,t,n)=>{"use strict";var r=n(7248),i=n(1600),s=n(7004),o=n(5220),a=n(4135),c=i.Array;r({target:"Array",stat:!0,forced:s((function(){function e(){}return!(c.of.call(e)instanceof e)}))},{of:function(){for(var e=0,t=arguments.length,n=new(o(this)?this:c)(t);t>e;)a(n,e,arguments[e++]);return n.length=t,n}})},4404:(e,t,n)=>{"use strict";var r=n(7248),i=n(3680).right,s=n(6608),o=n(2592),a=n(3640);r({target:"Array",proto:!0,forced:!s("reduceRight")||!a&&o>79&&o<83},{reduceRight:function(e){return i(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},2948:(e,t,n)=>{"use strict";var r=n(7248),i=n(3680).left,s=n(6608),o=n(2592),a=n(3640);r({target:"Array",proto:!0,forced:!s("reduce")||!a&&o>79&&o<83},{reduce:function(e){var t=arguments.length;return i(this,e,t,t>1?arguments[1]:void 0)}})},5612:(e,t,n)=>{"use strict";var r=n(7248),i=n(604),s=n(5240),o=i([].reverse),a=[1,2];r({target:"Array",proto:!0,forced:String(a)===String(a.reverse())},{reverse:function(){return s(this)&&(this.length=this.length),o(this)}})},3917:(e,t,n)=>{"use strict";var r=n(7248),i=n(1600),s=n(5240),o=n(5220),a=n(9952),c=n(7920),l=n(9183),u=n(3068),h=n(4135),d=n(3668),p=n(4696),f=n(6100),g=p("slice"),m=d("species"),v=i.Array,_=Math.max;r({target:"Array",proto:!0,forced:!g},{slice:function(e,t){var n,r,i,d=u(this),p=l(d),g=c(e,p),y=c(void 0===t?p:t,p);if(s(d)&&(n=d.constructor,(o(n)&&(n===v||s(n.prototype))||a(n)&&null===(n=n[m]))&&(n=void 0),n===v||void 0===n))return f(d,g,y);for(r=new(void 0===n?v:n)(_(y-g,0)),i=0;g<y;g++,i++)g in d&&h(r,i,d[g]);return r.length=i,r}})},4180:(e,t,n)=>{"use strict";var r=n(7248),i=n(9560).some;r({target:"Array",proto:!0,forced:!n(6608)("some")},{some:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},2e3:(e,t,n)=>{"use strict";var r=n(7248),i=n(604),s=n(1381),o=n(3848),a=n(9183),c=n(748),l=n(7004),u=n(1316),h=n(6608),d=n(732),p=n(2936),f=n(2592),g=n(7413),m=[],v=i(m.sort),_=i(m.push),y=l((function(){m.sort(void 0)})),w=l((function(){m.sort(null)})),b=h("sort"),I=!l((function(){if(f)return f<70;if(!(d&&d>3)){if(p)return!0;if(g)return g<603;var e,t,n,r,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)m.push({k:t+r,v:n})}for(m.sort((function(e,t){return t.v-e.v})),r=0;r<m.length;r++)t=m[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));r({target:"Array",proto:!0,forced:y||!w||!b||!I},{sort:function(e){void 0!==e&&s(e);var t=o(this);if(I)return void 0===e?v(t):v(t,e);var n,r,i=[],l=a(t);for(r=0;r<l;r++)r in t&&_(i,t[r]);for(u(i,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:c(t)>c(n)?1:-1}}(e)),n=i.length,r=0;r<n;)t[r]=i[r++];for(;r<l;)delete t[r++];return t}})},7476:(e,t,n)=>{n(9688)("Array")},7184:(e,t,n)=>{"use strict";var r=n(7248),i=n(1600),s=n(7920),o=n(9824),a=n(9183),c=n(3848),l=n(1220),u=n(4135),h=n(4696)("splice"),d=i.TypeError,p=Math.max,f=Math.min;r({target:"Array",proto:!0,forced:!h},{splice:function(e,t){var n,r,i,h,g,m,v=c(this),_=a(v),y=s(e,_),w=arguments.length;if(0===w?n=r=0:1===w?(n=0,r=_-y):(n=w-2,r=f(p(o(t),0),_-y)),_+n-r>9007199254740991)throw d("Maximum allowed length exceeded");for(i=l(v,r),h=0;h<r;h++)(g=y+h)in v&&u(i,h,v[g]);if(i.length=r,n<r){for(h=y;h<_-r;h++)m=h+n,(g=h+r)in v?v[m]=v[g]:delete v[m];for(h=_;h>_-r+n;h--)delete v[h-1]}else if(n>r)for(h=_-r;h>y;h--)m=h+n-1,(g=h+r-1)in v?v[m]=v[g]:delete v[m];for(h=0;h<n;h++)v[h+y]=arguments[h+2];return v.length=_-r+n,i}})},1228:(e,t,n)=>{n(5868)("flatMap")},2251:(e,t,n)=>{n(5868)("flat")},1480:(e,t,n)=>{var r=n(1600);n(9540)(r.JSON,"JSON",!0)},472:(e,t,n)=>{"use strict";n(6064)("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(7539))},3896:(e,t,n)=>{n(9540)(Math,"Math",!0)},3656:(e,t,n)=>{n(7248)({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},6368:(e,t,n)=>{var r=n(7248),i=n(6984);r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},8896:(e,t,n)=>{n(7248)({target:"Object",stat:!0,sham:!n(2828)},{create:n(124)})},8892:(e,t,n)=>{"use strict";var r=n(7248),i=n(2828),s=n(8664),o=n(1381),a=n(3848),c=n(7072);i&&r({target:"Object",proto:!0,forced:s},{__defineGetter__:function(e,t){c.f(a(this),e,{get:o(t),enumerable:!0,configurable:!0})}})},9e3:(e,t,n)=>{var r=n(7248),i=n(2828);r({target:"Object",stat:!0,forced:!i,sham:!i},{defineProperties:n(1904)})},6200:(e,t,n)=>{var r=n(7248),i=n(2828);r({target:"Object",stat:!0,forced:!i,sham:!i},{defineProperty:n(7072).f})},9920:(e,t,n)=>{"use strict";var r=n(7248),i=n(2828),s=n(8664),o=n(1381),a=n(3848),c=n(7072);i&&r({target:"Object",proto:!0,forced:s},{__defineSetter__:function(e,t){c.f(a(this),e,{set:o(t),enumerable:!0,configurable:!0})}})},8292:(e,t,n)=>{var r=n(7248),i=n(5556).entries;r({target:"Object",stat:!0},{entries:function(e){return i(e)}})},9064:(e,t,n)=>{var r=n(7248),i=n(1748),s=n(7004),o=n(9952),a=n(8756).onFreeze,c=Object.freeze;r({target:"Object",stat:!0,forced:s((function(){c(1)})),sham:!i},{freeze:function(e){return c&&o(e)?c(a(e)):e}})},1243:(e,t,n)=>{var r=n(7248),i=n(9928),s=n(4135);r({target:"Object",stat:!0},{fromEntries:function(e){var t={};return i(e,(function(e,n){s(t,e,n)}),{AS_ENTRIES:!0}),t}})},4440:(e,t,n)=>{var r=n(7248),i=n(7004),s=n(3068),o=n(2920).f,a=n(2828),c=i((function(){o(1)}));r({target:"Object",stat:!0,forced:!a||c,sham:!a},{getOwnPropertyDescriptor:function(e,t){return o(s(e),t)}})},6152:(e,t,n)=>{var r=n(7248),i=n(2828),s=n(4092),o=n(3068),a=n(2920),c=n(4135);r({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(e){for(var t,n,r=o(e),i=a.f,l=s(r),u={},h=0;l.length>h;)void 0!==(n=i(r,t=l[h++]))&&c(u,t,n);return u}})},2260:(e,t,n)=>{var r=n(7248),i=n(7004),s=n(7316).f;r({target:"Object",stat:!0,forced:i((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:s})},864:(e,t,n)=>{var r=n(7248),i=n(7004),s=n(3848),o=n(6232),a=n(1040);r({target:"Object",stat:!0,forced:i((function(){o(1)})),sham:!a},{getPrototypeOf:function(e){return o(s(e))}})},4112:(e,t,n)=>{n(7248)({target:"Object",stat:!0},{hasOwn:n(9180)})},5016:(e,t,n)=>{var r=n(7248),i=n(5548);r({target:"Object",stat:!0,forced:Object.isExtensible!==i},{isExtensible:i})},6228:(e,t,n)=>{var r=n(7248),i=n(7004),s=n(9952),o=n(4108),a=n(4328),c=Object.isFrozen;r({target:"Object",stat:!0,forced:i((function(){c(1)}))||a},{isFrozen:function(e){return!s(e)||!(!a||"ArrayBuffer"!=o(e))||!!c&&c(e)}})},2356:(e,t,n)=>{var r=n(7248),i=n(7004),s=n(9952),o=n(4108),a=n(4328),c=Object.isSealed;r({target:"Object",stat:!0,forced:i((function(){c(1)}))||a},{isSealed:function(e){return!s(e)||!(!a||"ArrayBuffer"!=o(e))||!!c&&c(e)}})},6620:(e,t,n)=>{n(7248)({target:"Object",stat:!0},{is:n(176)})},6124:(e,t,n)=>{var r=n(7248),i=n(3848),s=n(9880);r({target:"Object",stat:!0,forced:n(7004)((function(){s(1)}))},{keys:function(e){return s(i(e))}})},7600:(e,t,n)=>{"use strict";var r=n(7248),i=n(2828),s=n(8664),o=n(3848),a=n(4061),c=n(6232),l=n(2920).f;i&&r({target:"Object",proto:!0,forced:s},{__lookupGetter__:function(e){var t,n=o(this),r=a(e);do{if(t=l(n,r))return t.get}while(n=c(n))}})},5512:(e,t,n)=>{"use strict";var r=n(7248),i=n(2828),s=n(8664),o=n(3848),a=n(4061),c=n(6232),l=n(2920).f;i&&r({target:"Object",proto:!0,forced:s},{__lookupSetter__:function(e){var t,n=o(this),r=a(e);do{if(t=l(n,r))return t.set}while(n=c(n))}})},5312:(e,t,n)=>{var r=n(7248),i=n(9952),s=n(8756).onFreeze,o=n(1748),a=n(7004),c=Object.preventExtensions;r({target:"Object",stat:!0,forced:a((function(){c(1)})),sham:!o},{preventExtensions:function(e){return c&&i(e)?c(s(e)):e}})},3936:(e,t,n)=>{var r=n(7248),i=n(9952),s=n(8756).onFreeze,o=n(1748),a=n(7004),c=Object.seal;r({target:"Object",stat:!0,forced:a((function(){c(1)})),sham:!o},{seal:function(e){return c&&i(e)?c(s(e)):e}})},920:(e,t,n)=>{n(7248)({target:"Object",stat:!0},{setPrototypeOf:n(3440)})},7912:(e,t,n)=>{var r=n(7796),i=n(5028),s=n(2816);r||i(Object.prototype,"toString",s,{unsafe:!0})},1712:(e,t,n)=>{var r=n(7248),i=n(5556).values;r({target:"Object",stat:!0},{values:function(e){return i(e)}})},3652:(e,t,n)=>{var r=n(7248),i=n(1600),s=n(9540);r({global:!0},{Reflect:{}}),s(i.Reflect,"Reflect",!0)},3768:(e,t,n)=>{"use strict";var r=n(7248),i=n(9212);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},4840:(e,t,n)=>{"use strict";n(6064)("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(7539))},3120:(e,t,n)=>{"use strict";var r=n(7248),i=n(240);r({target:"String",proto:!0,forced:n(72)("anchor")},{anchor:function(e){return i(this,"a","name",e)}})},2060:(e,t,n)=>{"use strict";var r=n(7248),i=n(604),s=n(1840),o=n(9824),a=n(748),c=n(7004),l=i("".charAt);r({target:"String",proto:!0,forced:c((function(){return"\ud842"!=="𠮷".at(-2)}))},{at:function(e){var t=a(s(this)),n=t.length,r=o(e),i=r>=0?r:n+r;return i<0||i>=n?void 0:l(t,i)}})},6824:(e,t,n)=>{"use strict";var r=n(7248),i=n(240);r({target:"String",proto:!0,forced:n(72)("big")},{big:function(){return i(this,"big","","")}})},6784:(e,t,n)=>{"use strict";var r=n(7248),i=n(240);r({target:"String",proto:!0,forced:n(72)("blink")},{blink:function(){return i(this,"blink","","")}})},7800:(e,t,n)=>{"use strict";var r=n(7248),i=n(240);r({target:"String",proto:!0,forced:n(72)("bold")},{bold:function(){return i(this,"b","","")}})},9965:(e,t,n)=>{"use strict";var r=n(7248),i=n(2780).codeAt;r({target:"String",proto:!0},{codePointAt:function(e){return i(this,e)}})},5048:(e,t,n)=>{"use strict";var r,i=n(7248),s=n(604),o=n(2920).f,a=n(1868),c=n(748),l=n(6520),u=n(1840),h=n(1275),d=n(7408),p=s("".endsWith),f=s("".slice),g=Math.min,m=h("endsWith");i({target:"String",proto:!0,forced:!(!d&&!m&&(r=o(String.prototype,"endsWith"),r&&!r.writable)||m)},{endsWith:function(e){var t=c(u(this));l(e);var n=arguments.length>1?arguments[1]:void 0,r=t.length,i=void 0===n?r:g(a(n),r),s=c(e);return p?p(t,s,i):f(t,i-s.length,i)===s}})},3340:(e,t,n)=>{"use strict";var r=n(7248),i=n(240);r({target:"String",proto:!0,forced:n(72)("fixed")},{fixed:function(){return i(this,"tt","","")}})},4520:(e,t,n)=>{"use strict";var r=n(7248),i=n(240);r({target:"String",proto:!0,forced:n(72)("fontcolor")},{fontcolor:function(e){return i(this,"font","color",e)}})},2112:(e,t,n)=>{"use strict";var r=n(7248),i=n(240);r({target:"String",proto:!0,forced:n(72)("fontsize")},{fontsize:function(e){return i(this,"font","size",e)}})},2808:(e,t,n)=>{var r=n(7248),i=n(1600),s=n(604),o=n(7920),a=i.RangeError,c=String.fromCharCode,l=String.fromCodePoint,u=s([].join);r({target:"String",stat:!0,forced:!!l&&1!=l.length},{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,i=0;r>i;){if(t=+arguments[i++],o(t,1114111)!==t)throw a(t+" is not a valid code point");n[i]=t<65536?c(t):c(55296+((t-=65536)>>10),t%1024+56320)}return u(n,"")}})},824:(e,t,n)=>{"use strict";var r=n(7248),i=n(604),s=n(6520),o=n(1840),a=n(748),c=n(1275),l=i("".indexOf);r({target:"String",proto:!0,forced:!c("includes")},{includes:function(e){return!!~l(a(o(this)),a(s(e)),arguments.length>1?arguments[1]:void 0)}})},1048:(e,t,n)=>{"use strict";var r=n(7248),i=n(240);r({target:"String",proto:!0,forced:n(72)("italics")},{italics:function(){return i(this,"i","","")}})},8504:(e,t,n)=>{"use strict";var r=n(2780).charAt,i=n(748),s=n(7932),o=n(2648),a="String Iterator",c=s.set,l=s.getterFor(a);o(String,"String",(function(e){c(this,{type:a,string:i(e),index:0})}),(function(){var e,t=l(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},1288:(e,t,n)=>{"use strict";var r=n(7248),i=n(240);r({target:"String",proto:!0,forced:n(72)("link")},{link:function(e){return i(this,"a","href",e)}})},4296:(e,t,n)=>{"use strict";var r=n(7248),i=n(1600),s=n(3032),o=n(604),a=n(9292),c=n(1840),l=n(1868),u=n(748),h=n(3736),d=n(4108),p=n(2408),f=n(7724),g=n(7003),m=n(8808),v=n(5028),_=n(7004),y=n(3668),w=n(7171),b=n(6619),I=n(3800),k=n(7932),C=n(7408),S=y("matchAll"),T="RegExp String",E=T+" Iterator",x=k.set,P=k.getterFor(E),O=RegExp.prototype,R=i.TypeError,N=o(g),A=o("".indexOf),D=o("".matchAll),L=!!D&&!_((function(){D("a",/./)})),M=a((function(e,t,n,r){x(this,{type:E,regexp:e,string:t,global:n,unicode:r,done:!1})}),T,(function(){var e=P(this);if(e.done)return{value:void 0,done:!0};var t=e.regexp,n=e.string,r=I(t,n);return null===r?{value:void 0,done:e.done=!0}:e.global?(""===u(r[0])&&(t.lastIndex=b(n,l(t.lastIndex),e.unicode)),{value:r,done:!1}):(e.done=!0,{value:r,done:!1})})),j=function(e){var t,n,r,i,s,o,a=h(this),c=u(e);return t=w(a,RegExp),void 0===(n=a.flags)&&p(O,a)&&!("flags"in O)&&(n=N(a)),r=void 0===n?"":u(n),i=new t(t===RegExp?a.source:a,r),s=!!~A(r,"g"),o=!!~A(r,"u"),i.lastIndex=l(a.lastIndex),new M(i,c,s,o)};r({target:"String",proto:!0,forced:L},{matchAll:function(e){var t,n,r,i,o=c(this);if(null!=e){if(f(e)&&(t=u(c("flags"in O?e.flags:N(e))),!~A(t,"g")))throw R("`.matchAll` does not allow non-global regexes");if(L)return D(o,e);if(void 0===(r=m(e,S))&&C&&"RegExp"==d(e)&&(r=j),r)return s(r,e,o)}else if(L)return D(o,e);return n=u(o),i=new RegExp(e,"g"),C?s(j,i,n):i[S](n)}}),C||S in O||v(O,S,j)},8080:(e,t,n)=>{"use strict";var r=n(3032),i=n(7712),s=n(3736),o=n(1868),a=n(748),c=n(1840),l=n(8808),u=n(6619),h=n(3800);i("match",(function(e,t,n){return[function(t){var n=c(this),i=null==t?void 0:l(t,e);return i?r(i,t,n):new RegExp(t)[e](a(n))},function(e){var r=s(this),i=a(e),c=n(t,r,i);if(c.done)return c.value;if(!r.global)return h(r,i);var l=r.unicode;r.lastIndex=0;for(var d,p=[],f=0;null!==(d=h(r,i));){var g=a(d[0]);p[f]=g,""===g&&(r.lastIndex=u(i,o(r.lastIndex),l)),f++}return 0===f?null:p}]}))},2056:(e,t,n)=>{"use strict";var r=n(7248),i=n(2532).end;r({target:"String",proto:!0,forced:n(6696)},{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},1876:(e,t,n)=>{"use strict";var r=n(7248),i=n(2532).start;r({target:"String",proto:!0,forced:n(6696)},{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},7588:(e,t,n)=>{var r=n(7248),i=n(604),s=n(3068),o=n(3848),a=n(748),c=n(9183),l=i([].push),u=i([].join);r({target:"String",stat:!0},{raw:function(e){for(var t=s(o(e).raw),n=c(t),r=arguments.length,i=[],h=0;n>h;){if(l(i,a(t[h++])),h===n)return u(i,"");h<r&&l(i,a(arguments[h]))}}})},5720:(e,t,n)=>{n(7248)({target:"String",proto:!0},{repeat:n(7512)})},5024:(e,t,n)=>{"use strict";var r=n(7248),i=n(1600),s=n(3032),o=n(604),a=n(1840),c=n(984),l=n(7724),u=n(748),h=n(8808),d=n(7003),p=n(4208),f=n(3668),g=n(7408),m=f("replace"),v=RegExp.prototype,_=i.TypeError,y=o(d),w=o("".indexOf),b=o("".replace),I=o("".slice),k=Math.max,C=function(e,t,n){return n>e.length?-1:""===t?n:w(e,t,n)};r({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,i,o,d,f,S,T,E,x=a(this),P=0,O=0,R="";if(null!=e){if((n=l(e))&&(r=u(a("flags"in v?e.flags:y(e))),!~w(r,"g")))throw _("`.replaceAll` does not allow non-global regexes");if(i=h(e,m))return s(i,e,x,t);if(g&&n)return b(u(x),e,t)}for(o=u(x),d=u(e),(f=c(t))||(t=u(t)),S=d.length,T=k(1,S),P=C(o,d,0);-1!==P;)E=f?u(t(d,P,o)):p(d,o,P,[],void 0,t),R+=I(o,O,P)+E,O=P+S,P=C(o,d,P+T);return O<o.length&&(R+=I(o,O)),R}})},1259:(e,t,n)=>{"use strict";var r=n(9756),i=n(3032),s=n(604),o=n(7712),a=n(7004),c=n(3736),l=n(984),u=n(9824),h=n(1868),d=n(748),p=n(1840),f=n(6619),g=n(8808),m=n(4208),v=n(3800),_=n(3668)("replace"),y=Math.max,w=Math.min,b=s([].concat),I=s([].push),k=s("".indexOf),C=s("".slice),S="$0"==="a".replace(/./,"$0"),T=!!/./[_]&&""===/./[_]("a","$0");o("replace",(function(e,t,n){var s=T?"$":"$0";return[function(e,n){var r=p(this),s=null==e?void 0:g(e,_);return s?i(s,e,r,n):i(t,d(r),e,n)},function(e,i){var o=c(this),a=d(e);if("string"==typeof i&&-1===k(i,s)&&-1===k(i,"$<")){var p=n(t,o,a,i);if(p.done)return p.value}var g=l(i);g||(i=d(i));var _=o.global;if(_){var S=o.unicode;o.lastIndex=0}for(var T=[];;){var E=v(o,a);if(null===E)break;if(I(T,E),!_)break;""===d(E[0])&&(o.lastIndex=f(a,h(o.lastIndex),S))}for(var x,P="",O=0,R=0;R<T.length;R++){for(var N=d((E=T[R])[0]),A=y(w(u(E.index),a.length),0),D=[],L=1;L<E.length;L++)I(D,void 0===(x=E[L])?x:String(x));var M=E.groups;if(g){var j=b([N],D,A,a);void 0!==M&&I(j,M);var F=d(r(i,void 0,j))}else F=m(N,a,A,D,M,i);A>=O&&(P+=C(a,O,A)+F,O=A+N.length)}return P+C(a,O)}]}),!!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!S||T)},9885:(e,t,n)=>{"use strict";var r=n(3032),i=n(7712),s=n(3736),o=n(1840),a=n(176),c=n(748),l=n(8808),u=n(3800);i("search",(function(e,t,n){return[function(t){var n=o(this),i=null==t?void 0:l(t,e);return i?r(i,t,n):new RegExp(t)[e](c(n))},function(e){var r=s(this),i=c(e),o=n(t,r,i);if(o.done)return o.value;var l=r.lastIndex;a(l,0)||(r.lastIndex=0);var h=u(r,i);return a(r.lastIndex,l)||(r.lastIndex=l),null===h?-1:h.index}]}))},7816:(e,t,n)=>{"use strict";var r=n(7248),i=n(240);r({target:"String",proto:!0,forced:n(72)("small")},{small:function(){return i(this,"small","","")}})},8640:(e,t,n)=>{"use strict";var r=n(9756),i=n(3032),s=n(604),o=n(7712),a=n(7724),c=n(3736),l=n(1840),u=n(7171),h=n(6619),d=n(1868),p=n(748),f=n(8808),g=n(9472),m=n(3800),v=n(9212),_=n(528),y=n(7004),w=_.UNSUPPORTED_Y,b=4294967295,I=Math.min,k=[].push,C=s(/./.exec),S=s(k),T=s("".slice);o("split",(function(e,t,n){var s;return s="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var s=p(l(this)),o=void 0===n?b:n>>>0;if(0===o)return[];if(void 0===e)return[s];if(!a(e))return i(t,s,e,o);for(var c,u,h,d=[],f=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,_=new RegExp(e.source,f+"g");(c=i(v,_,s))&&!((u=_.lastIndex)>m&&(S(d,T(s,m,c.index)),c.length>1&&c.index<s.length&&r(k,d,g(c,1)),h=c[0].length,m=u,d.length>=o));)_.lastIndex===c.index&&_.lastIndex++;return m===s.length?!h&&C(_,"")||S(d,""):S(d,T(s,m)),d.length>o?g(d,0,o):d}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:i(t,this,e,n)}:t,[function(t,n){var r=l(this),o=null==t?void 0:f(t,e);return o?i(o,t,r,n):i(s,p(r),t,n)},function(e,r){var i=c(this),o=p(e),a=n(s,i,o,r,s!==t);if(a.done)return a.value;var l=u(i,RegExp),f=i.unicode,g=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(w?"g":"y"),v=new l(w?"^(?:"+i.source+")":i,g),_=void 0===r?b:r>>>0;if(0===_)return[];if(0===o.length)return null===m(v,o)?[o]:[];for(var y=0,k=0,C=[];k<o.length;){v.lastIndex=w?0:k;var E,x=m(v,w?T(o,k):o);if(null===x||(E=I(d(v.lastIndex+(w?k:0)),o.length))===y)k=h(o,k,f);else{if(S(C,T(o,y,k)),C.length===_)return C;for(var P=1;P<=x.length-1;P++)if(S(C,x[P]),C.length===_)return C;k=y=E}}return S(C,T(o,y)),C}]}),!!y((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),w)},4904:(e,t,n)=>{"use strict";var r,i=n(7248),s=n(604),o=n(2920).f,a=n(1868),c=n(748),l=n(6520),u=n(1840),h=n(1275),d=n(7408),p=s("".startsWith),f=s("".slice),g=Math.min,m=h("startsWith");i({target:"String",proto:!0,forced:!(!d&&!m&&(r=o(String.prototype,"startsWith"),r&&!r.writable)||m)},{startsWith:function(e){var t=c(u(this));l(e);var n=a(g(arguments.length>1?arguments[1]:void 0,t.length)),r=c(e);return p?p(t,r,n):f(t,n,n+r.length)===r}})},5264:(e,t,n)=>{"use strict";var r=n(7248),i=n(240);r({target:"String",proto:!0,forced:n(72)("strike")},{strike:function(){return i(this,"strike","","")}})},628:(e,t,n)=>{"use strict";var r=n(7248),i=n(240);r({target:"String",proto:!0,forced:n(72)("sub")},{sub:function(){return i(this,"sub","","")}})},960:(e,t,n)=>{"use strict";var r=n(7248),i=n(604),s=n(1840),o=n(9824),a=n(748),c=i("".slice),l=Math.max,u=Math.min;r({target:"String",proto:!0,forced:!"".substr||"b"!=="ab".substr(-1)},{substr:function(e,t){var n,r,i=a(s(this)),h=i.length,d=o(e);return d===1/0&&(d=0),d<0&&(d=l(h+d,0)),(n=void 0===t?h:o(t))<=0||n===1/0||d>=(r=u(d+n,h))?"":c(i,d,r)}})},5032:(e,t,n)=>{"use strict";var r=n(7248),i=n(240);r({target:"String",proto:!0,forced:n(72)("sup")},{sup:function(){return i(this,"sup","","")}})},408:(e,t,n)=>{"use strict";var r=n(7248),i=n(1688).end,s=n(2832)("trimEnd"),o=s?function(){return i(this)}:"".trimEnd;r({target:"String",proto:!0,name:"trimEnd",forced:s},{trimEnd:o,trimRight:o})},1315:(e,t,n)=>{"use strict";var r=n(7248),i=n(1688).start,s=n(2832)("trimStart"),o=s?function(){return i(this)}:"".trimStart;r({target:"String",proto:!0,name:"trimStart",forced:s},{trimStart:o,trimLeft:o})},1164:(e,t,n)=>{"use strict";var r=n(7248),i=n(1688).trim;r({target:"String",proto:!0,forced:n(2832)("trim")},{trim:function(){return i(this)}})},2320:(e,t,n)=>{"use strict";var r=n(7248),i=n(1600),s=n(6532),o=n(9756),a=n(3032),c=n(604),l=n(7408),u=n(2828),h=n(3880),d=n(7004),p=n(9180),f=n(5240),g=n(984),m=n(9952),v=n(2408),_=n(1836),y=n(3736),w=n(3848),b=n(3068),I=n(4061),k=n(748),C=n(364),S=n(124),T=n(9880),E=n(4880),x=n(7316),P=n(2128),O=n(2920),R=n(7072),N=n(5988),A=n(6100),D=n(5028),L=n(4624),M=n(280),j=n(6632),F=n(6536),U=n(3668),q=n(6256),W=n(5248),B=n(9540),$=n(7932),V=n(9560).forEach,z=M("hidden"),H="Symbol",K="prototype",Y=U("toPrimitive"),G=$.set,J=$.getterFor(H),Q=Object[K],X=i.Symbol,Z=X&&X[K],ee=i.TypeError,te=i.QObject,ne=s("JSON","stringify"),re=O.f,ie=R.f,se=x.f,oe=N.f,ae=c([].push),ce=L("symbols"),le=L("op-symbols"),ue=L("string-to-symbol-registry"),he=L("symbol-to-string-registry"),de=L("wks"),pe=!te||!te[K]||!te[K].findChild,fe=u&&d((function(){return 7!=S(ie({},"a",{get:function(){return ie(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=re(Q,t);r&&delete Q[t],ie(e,t,n),r&&e!==Q&&ie(Q,t,r)}:ie,ge=function(e,t){var n=ce[e]=S(Z);return G(n,{type:H,tag:e,description:t}),u||(n.description=t),n},me=function(e,t,n){e===Q&&me(le,t,n),y(e);var r=I(t);return y(n),p(ce,r)?(n.enumerable?(p(e,z)&&e[z][r]&&(e[z][r]=!1),n=S(n,{enumerable:C(0,!1)})):(p(e,z)||ie(e,z,C(1,{})),e[z][r]=!0),fe(e,r,n)):ie(e,r,n)},ve=function(e,t){y(e);var n=b(t),r=T(n).concat(be(n));return V(r,(function(t){u&&!a(_e,n,t)||me(e,t,n[t])})),e},_e=function(e){var t=I(e),n=a(oe,this,t);return!(this===Q&&p(ce,t)&&!p(le,t))&&(!(n||!p(this,t)||!p(ce,t)||p(this,z)&&this[z][t])||n)},ye=function(e,t){var n=b(e),r=I(t);if(n!==Q||!p(ce,r)||p(le,r)){var i=re(n,r);return!i||!p(ce,r)||p(n,z)&&n[z][r]||(i.enumerable=!0),i}},we=function(e){var t=se(b(e)),n=[];return V(t,(function(e){p(ce,e)||p(j,e)||ae(n,e)})),n},be=function(e){var t=e===Q,n=se(t?le:b(e)),r=[];return V(n,(function(e){!p(ce,e)||t&&!p(Q,e)||ae(r,ce[e])})),r};if(h||(D(Z=(X=function(){if(v(Z,this))throw ee("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?k(arguments[0]):void 0,t=F(e),n=function(e){this===Q&&a(n,le,e),p(this,z)&&p(this[z],t)&&(this[z][t]=!1),fe(this,t,C(1,e))};return u&&pe&&fe(Q,t,{configurable:!0,set:n}),ge(t,e)})[K],"toString",(function(){return J(this).tag})),D(X,"withoutSetter",(function(e){return ge(F(e),e)})),N.f=_e,R.f=me,O.f=ye,E.f=x.f=we,P.f=be,q.f=function(e){return ge(U(e),e)},u&&(ie(Z,"description",{configurable:!0,get:function(){return J(this).description}}),l||D(Q,"propertyIsEnumerable",_e,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:X}),V(T(de),(function(e){W(e)})),r({target:H,stat:!0,forced:!h},{for:function(e){var t=k(e);if(p(ue,t))return ue[t];var n=X(t);return ue[t]=n,he[n]=t,n},keyFor:function(e){if(!_(e))throw ee(e+" is not a symbol");if(p(he,e))return he[e]},useSetter:function(){pe=!0},useSimple:function(){pe=!1}}),r({target:"Object",stat:!0,forced:!h,sham:!u},{create:function(e,t){return void 0===t?S(e):ve(S(e),t)},defineProperty:me,defineProperties:ve,getOwnPropertyDescriptor:ye}),r({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:we,getOwnPropertySymbols:be}),r({target:"Object",stat:!0,forced:d((function(){P.f(1)}))},{getOwnPropertySymbols:function(e){return P.f(w(e))}}),ne&&r({target:"JSON",stat:!0,forced:!h||d((function(){var e=X();return"[null]"!=ne([e])||"{}"!=ne({a:e})||"{}"!=ne(Object(e))}))},{stringify:function(e,t,n){var r=A(arguments),i=t;if((m(t)||void 0!==e)&&!_(e))return f(t)||(t=function(e,t){if(g(i)&&(t=a(i,this,e,t)),!_(t))return t}),r[1]=t,o(ne,null,r)}}),!Z[Y]){var Ie=Z.valueOf;D(Z,Y,(function(e){return a(Ie,this)}))}B(X,H),j[z]=!0},9384:()=>{},120:()=>{var e,t=((e=t||{})[e.None=-1]="None",e[e.Text=0]="Text",e[e.System=1]="System",e[e.Item=3]="Item",e)},5280:()=>{},7472:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,r,s,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new i(r,s||e,o),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);i<s;i++)o[i]=r[i].fn;return o},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,s,o){var a=n?n+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,s),!0;case 6:return u.fn.call(u.context,t,r,i,s,o),!0}for(l=1,c=new Array(h-1);l<h;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var d,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),h){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,r);break;case 4:u[l].fn.call(u[l].context,t,r,i);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||o(this,s);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||i&&!a[c].once||r&&a[c].context!==r)&&l.push(a[c]);l.length?this._events[s]=1===l.length?l[0]:l:o(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},1976:(e,t,n)=>{"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=n(2032);t.default={name:"sprintf",type:"postProcessor",process:function(e,t,n){return n.sprintf?"[object Array]"===Object.prototype.toString.apply(n.sprintf)?(0,i.vsprintf)(e,n.sprintf):"object"===r(n.sprintf)?(0,i.sprintf)(e,n.sprintf):e:e},overloadTranslationOptionHandler:function(e){for(var t=[],n=1;n<e.length;n++)t.push(e[n]);return{postProcess:"sprintf",sprintf:t}}}},2032:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sprintf=r,t.vsprintf=function(e,t,n){return(n=(t||[]).slice(0)).splice(0,0,e),r.apply(null,n)};var n={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function r(){var e=arguments[0],t=r.cache;return t[e]&&t.hasOwnProperty(e)||(t[e]=r.parse(e)),r.format.call(null,t[e],arguments)}function i(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}r.format=function(e,t){var s,o,a,c,l,u,h,d,p=1,f=e.length,g="",m=[],v=!0,_="";for(o=0;o<f;o++)if("string"===(g=i(e[o])))m[m.length]=e[o];else if("array"===g){if((c=e[o])[2])for(s=t[p],a=0;a<c[2].length;a++){if(!s.hasOwnProperty(c[2][a]))throw new Error(r("[sprintf] property '%s' does not exist",c[2][a]));s=s[c[2][a]]}else s=c[1]?t[c[1]]:t[p++];if("function"==i(s)&&(s=s()),n.not_string.test(c[8])&&n.not_json.test(c[8])&&"number"!=i(s)&&isNaN(s))throw new TypeError(r("[sprintf] expecting number but found %s",i(s)));switch(n.number.test(c[8])&&(v=s>=0),c[8]){case"b":s=s.toString(2);break;case"c":s=String.fromCharCode(s);break;case"d":case"i":s=parseInt(s,10);break;case"j":s=JSON.stringify(s,null,c[6]?parseInt(c[6]):0);break;case"e":s=c[7]?s.toExponential(c[7]):s.toExponential();break;case"f":s=c[7]?parseFloat(s).toFixed(c[7]):parseFloat(s);break;case"g":s=c[7]?parseFloat(s).toPrecision(c[7]):parseFloat(s);break;case"o":s=s.toString(8);break;case"s":s=(s=String(s))&&c[7]?s.substring(0,c[7]):s;break;case"u":s>>>=0;break;case"x":s=s.toString(16);break;case"X":s=s.toString(16).toUpperCase()}n.json.test(c[8])?m[m.length]=s:(!n.number.test(c[8])||v&&!c[3]?_="":(_=v?"+":"-",s=s.toString().replace(n.sign,"")),u=c[4]?"0"===c[4]?"0":c[4].charAt(1):" ",h=c[6]-(_+s).length,l=c[6]&&h>0?(d=u,Array(h+1).join(d)):"",m[m.length]=c[5]?_+s+l:"0"===u?_+l+s:l+_+s)}return m.join("")},r.cache={},r.parse=function(e){for(var t=e,r=[],i=[],s=0;t;){if(null!==(r=n.text.exec(t)))i[i.length]=r[0];else if(null!==(r=n.modulo.exec(t)))i[i.length]="%";else{if(null===(r=n.placeholder.exec(t)))throw new SyntaxError("[sprintf] unexpected placeholder");if(r[2]){s|=1;var o=[],a=r[2],c=[];if(null===(c=n.key.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(o[o.length]=c[1];""!==(a=a.substring(c[0].length));)if(null!==(c=n.key_access.exec(a)))o[o.length]=c[1];else{if(null===(c=n.index_access.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");o[o.length]=c[1]}r[2]=o}else s|=2;if(3===s)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i[i.length]=r}t=t.substring(r[0].length)}return i}},3824:(e,t,n)=>{e.exports=n(1976).default}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};n.r(e),n.d(e,{FirebaseError:()=>se,SDK_VERSION:()=>wt,_DEFAULT_ENTRY_NAME:()=>ct,_addComponent:()=>dt,_addOrOverwriteComponent:()=>pt,_apps:()=>ut,_clearComponents:()=>vt,_components:()=>ht,_getProvider:()=>gt,_registerComponent:()=>ft,_removeServiceInstance:()=>mt,deleteApp:()=>Ct,getApp:()=>It,getApps:()=>kt,initializeApp:()=>bt,onLog:()=>Tt,registerVersion:()=>St,setLogLevel:()=>Et});const t=__BASE_JQUERY__;var r=n.n(t);class i{constructor(){this.children=[]}render(){return this}append(e){if(this.$el){const t=e.render().$el;t&&(this.$el.append(t),this.children.push(e))}}remove(){this.$el&&this.$el.remove()}}n(9384);var s=Object.defineProperty,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,l=(e,t,n)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,u=(e,t)=>{for(var n in t||(t={}))a.call(t,n)&&l(e,n,t[n]);if(o)for(var n of o(t))c.call(t,n)&&l(e,n,t[n]);return e};let h={cacheVersion:"v4",customerPollingIntervals:{message:6e4},ownerPollingIntervals:{message:18e4,room:18e4},isCreatorApp:!1};const d={type:"customer"};function p(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function f(e){p(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}var g,m=Object.defineProperty,v=Object.defineProperties,_=Object.getOwnPropertyDescriptors,y=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,I=(e,t,n)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,k=(e,t)=>{for(var n in t||(t={}))w.call(t,n)&&I(e,n,t[n]);if(y)for(var n of y(t))b.call(t,n)&&I(e,n,t[n]);return e},C=(e,t)=>v(e,_(t)),S=((g=S||{})[g.None=-1]="None",g[g.Text=0]="Text",g[g.System=1]="System",g[g.Item=3]="Item",g);let T=-+new Date%1e5;const E=e=>{let t;t=void 0===e.sentByOwner||"customer"==h.type&&!e.sentByOwner||"owner"==h.type&&e.sentByOwner;const n=e.payload?{url:e.payload.itemUrl,id:e.payload.itemId,imageUrl:e.payload.imageUrl,title:e.payload.title,text:e.payload.text,price:e.payload.price}:null,r=n?n.text:e.text,i=e.images?e.images.map((({id:e,url:t,isDeleted:n,posted:r})=>({id:String(e),url:t,isDeleted:n,posted:new Date(1e3*r)}))):[];return{id:String(e.id),type:e.type||0,text:r||null,payload:n,images:i,posted:new Date(1e3*e.posted),own:t,sync:"synced"}},x=(e,t)=>{parseInt(e.id)<0&&(e.id=t.id),e.text=t.text,e.posted=t.posted,e.sync=t.sync,e.own=t.own,e.payload=t.payload,e.images=t.images?t.images.map(((t,n)=>{const r=e.images?e.images[n]:{};return C(k({},t),{url:r.url||t.url})})):[]},P=(e,t)=>e.id===t.id||e.id===t.localId||e.localId===t.id,O=(e,t)=>[e.sync!==t.sync,e.text!==t.text].includes(!0),R=(e,t)=>function(e,t){p(2,arguments);var n=f(e),r=f(t),i=n.getTime()-r.getTime();return i<0?-1:i>0?1:i}(e.posted,t.posted),N=class{constructor(){this.threshold=5,this.counter=0,this.callback=[]}on(e){this.callback.push(e)}reportFatalError(e){this.callback.length>0&&this.callback.forEach((t=>t(e)))}reportError(e){this.counter++,this.counter>this.threshold&&this.callback.length>0&&this.callback.forEach((t=>t(e)))}};N.default=new N;let A=N;var D=n(7472),L=n.n(D);const M="updated",j=class e{constructor(e,t){this.roomId=e,this.apiClient=t,this.nextTimer=null,this.dead=!1,this.deadDeferred=r().Deferred(),this.maxId=null,this.sinceId=null,this.completePrev=!1,this.eventEmitter=new(L())}on(e){this.eventEmitter.on(M,(t=>{e("update",t)}))}async start(){"owner"===h.type?e.pollingInterval=h.ownerPollingIntervals.message:e.pollingInterval=h.customerPollingIntervals.message;try{const e=await this.apiClient.chat(this.roomId,{});if(Array.isArray(e.messages)){const t=(e.messages||[]).map(E);this.eventEmitter.emit(M,t),t.length>0&&(this.maxId=t[0].id,this.sinceId=t[t.length-1].id)}this.polling()}catch(e){A.default.reportError(e)}}async reload(){return this.next()}async destroy(){this.eventEmitter.removeAllListeners(),this.dead=!0}polling(){this.nextTimer=e.pollingInterval;let t=setInterval((()=>{if(this.dead)return clearInterval(t),void this.deadDeferred.resolve();this.nextTimer&&this.nextTimer>=1e3&&(this.nextTimer-=1e3,0==this.nextTimer&&(this.nextTimer=null,this.next().then((()=>{this.nextTimer=e.pollingInterval}),(()=>{this.nextTimer=e.pollingInterval}))))}),1e3)}async next(){const e=this.maxId?{max_id:this.maxId}:{};try{const t=((await this.apiClient.chat(this.roomId,e)).messages||[]).map(E);this.eventEmitter.emit(M,t),t.length>0&&(this.maxId=t[0].id,this.sinceId=t[t.length-1].id)}catch(e){if(e instanceof Object&&"authError"in e)return void this.destroy();A.default.reportError(e)}}async get(){return null}async prev(){if(this.completePrev||!this.sinceId)return Promise.resolve([]);if(this.dead)return this.deadDeferred.resolve(),Promise.resolve([]);try{const e=await this.apiClient.chat(this.roomId,{since_id:this.sinceId});if(!Array.isArray(e.messages))return this.completePrev=!0,[];const t=(e.messages||[]).map(E);return this.eventEmitter.emit(M,t),0===t.length?(this.completePrev=!0,t):(t[t.length-1].id==this.sinceId?this.completePrev=!0:this.sinceId=t[t.length-1].id,t)}catch(e){return A.default.reportError(e),null}}};j.pollingInterval=h.customerPollingIntervals.message;let F=j;const U=function(e,t){if(!e)throw q(t)},q=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},W=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},B={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,l=i>>2,u=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[l],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(W(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw new V;const c=i<<2|s>>4;if(r.push(c),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class V extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const z=function(e){const t=W(e);return B.encodeByteArray(t,!0)},H=function(e){return z(e).replace(/\./g,"")},K=function(e){try{return B.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Y(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=Y(e[n],t[n]));return e}const G=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&K(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},J=()=>{var e;return null===(e=G())||void 0===e?void 0:e.config};class Q{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function X(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Z(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(X())}function ee(){var e;const t=null===(e=G())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}function te(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function ne(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function re(){const e=X();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function ie(){try{return"object"==typeof indexedDB}catch(e){return!1}}class se extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,se.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,oe.prototype.create)}}class oe{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(ae,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new se(r,o,n)}}const ae=/\{\$([^}]+)}/g;function ce(e){return JSON.parse(e)}function le(e){return JSON.stringify(e)}const ue=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=ce(K(s[0])||""),n=ce(K(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};function he(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function de(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function pe(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function fe(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function ge(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(me(n)&&me(s)){if(!ge(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function me(e){return null!==e&&"object"==typeof e}function ve(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function _e(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function ye(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class we{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=c^o&(a^c),i=1518500249):(r=o^a^c,i=1859775393):e<60?(r=o&a|c&(o|a),i=2400959708):(r=o^a^c,i=3395469782);const t=(s<<5|s>>>27)+r+l+i+n[e]&4294967295;l=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}function be(e,t){const n=new Ie(e,t);return n.subscribe.bind(n)}class Ie{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=ke),void 0===r.error&&(r.error=ke),void 0===r.complete&&(r.complete=ke);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function ke(){}const Ce=function(e,t,n,r){let i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function Se(e,t){return`${e} failed: ${t} argument `}function Te(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(Se(e,t)+"must be a valid function.")}function Ee(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(Se(e,t)+"must be a valid context object.")}const xe=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function Pe(e){return e&&e._delegate?e._delegate:e}class Oe{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Re="[DEFAULT]";class Ne{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Q;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Re})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=Re){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=Re){return this.instances.has(e)}getOptions(e=Re){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===Re?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=Re){return this.component?this.component.multipleInstances?e:Re:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Ae{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Ne(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const De=[];var Le;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Le||(Le={}));const Me={debug:Le.DEBUG,verbose:Le.VERBOSE,info:Le.INFO,warn:Le.WARN,error:Le.ERROR,silent:Le.SILENT},je=Le.INFO,Fe={[Le.DEBUG]:"log",[Le.VERBOSE]:"log",[Le.INFO]:"info",[Le.WARN]:"warn",[Le.ERROR]:"error"},Ue=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=Fe[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class qe{constructor(e){this.name=e,this._logLevel=je,this._logHandler=Ue,this._userLogHandler=null,De.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Me[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Le.DEBUG,...e),this._logHandler(this,Le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Le.VERBOSE,...e),this._logHandler(this,Le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Le.INFO,...e),this._logHandler(this,Le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Le.WARN,...e),this._logHandler(this,Le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Le.ERROR,...e),this._logHandler(this,Le.ERROR,...e)}}const We=(e,t)=>t.some((t=>e instanceof t));let Be,$e;const Ve=new WeakMap,ze=new WeakMap,He=new WeakMap,Ke=new WeakMap,Ye=new WeakMap;let Ge={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ze.get(e);if("objectStoreNames"===t)return e.objectStoreNames||He.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Qe(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Je(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?($e||($e=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Xe(this),e),Qe(Ve.get(this))}:function(...e){return Qe(t.apply(Xe(this),e))}:function(e,...n){const r=t.call(Xe(this),e,...n);return He.set(r,e.sort?e.sort():[e]),Qe(r)}:(e instanceof IDBTransaction&&function(e){if(ze.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));ze.set(e,t)}(e),We(e,Be||(Be=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Ge):e);var t}function Qe(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(Qe(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&Ve.set(t,e)})).catch((()=>{})),Ye.set(t,e),t}(e);if(Ke.has(e))return Ke.get(e);const t=Je(e);return t!==e&&(Ke.set(e,t),Ye.set(t,e)),t}const Xe=e=>Ye.get(e),Ze=["get","getKey","getAll","getAllKeys","count"],et=["put","add","delete","clear"],tt=new Map;function nt(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(tt.get(t))return tt.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=et.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Ze.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return tt.set(t,s),s}var rt;rt=Ge,Ge={...rt,get:(e,t,n)=>nt(e,t)||rt.get(e,t,n),has:(e,t)=>!!nt(e,t)||rt.has(e,t)};class it{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const st="@firebase/app",ot="0.9.25",at=new qe("@firebase/app"),ct="[DEFAULT]",lt={[st]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ut=new Map,ht=new Map;function dt(e,t){try{e.container.addComponent(t)}catch(n){at.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function pt(e,t){e.container.addOrOverwriteComponent(t)}function ft(e){const t=e.name;if(ht.has(t))return at.debug(`There were multiple attempts to register component ${t}.`),!1;ht.set(t,e);for(const t of ut.values())dt(t,e);return!0}function gt(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function mt(e,t,n=ct){gt(e,t).clearInstance(n)}function vt(){ht.clear()}const _t=new oe("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class yt{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Oe("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _t.create("app-deleted",{appName:this._name})}}const wt="10.7.1";function bt(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:ct,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw _t.create("bad-app-name",{appName:String(i)});if(n||(n=J()),!n)throw _t.create("no-options");const s=ut.get(i);if(s){if(ge(n,s.options)&&ge(r,s.config))return s;throw _t.create("duplicate-app",{appName:i})}const o=new Ae(i);for(const e of ht.values())o.addComponent(e);const a=new yt(n,r,o);return ut.set(i,a),a}function It(e=ct){const t=ut.get(e);if(!t&&e===ct&&J())return bt();if(!t)throw _t.create("no-app",{appName:e});return t}function kt(){return Array.from(ut.values())}async function Ct(e){const t=e.name;ut.has(t)&&(ut.delete(t),await Promise.all(e.container.getProviders().map((e=>e.delete()))),e.isDeleted=!0)}function St(e,t,n){var r;let i=null!==(r=lt[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void at.warn(e.join(" "))}ft(new Oe(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}function Tt(e,t){if(null!==e&&"function"!=typeof e)throw _t.create("invalid-log-argument");!function(e,t){for(const n of De){let r=null;t&&t.level&&(r=Me[t.level]),n.userLogHandler=null===e?null:(t,n,...i)=>{const s=i.map((e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((e=>e)).join(" ");n>=(null!=r?r:t.logLevel)&&e({level:Le[n].toLowerCase(),message:s,args:i,type:t.name})}}}(e,t)}function Et(e){var t;t=e,De.forEach((e=>{e.setLogLevel(t)}))}const xt="firebase-heartbeat-database",Pt=1,Ot="firebase-heartbeat-store";let Rt=null;function Nt(){return Rt||(Rt=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=Qe(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(Qe(o.result),e.oldVersion,e.newVersion,Qe(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(xt,Pt,{upgrade:(e,t)=>{0===t&&e.createObjectStore(Ot)}}).catch((e=>{throw _t.create("idb-open",{originalErrorMessage:e.message})}))),Rt}async function At(e,t){try{const n=(await Nt()).transaction(Ot,"readwrite"),r=n.objectStore(Ot);await r.put(t,Dt(e)),await n.done}catch(e){if(e instanceof se)at.warn(e.message);else{const t=_t.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});at.warn(t.message)}}}function Dt(e){return`${e.name}!${e.options.appId}`}class Lt{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new jt(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Mt();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Mt(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Ft(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ft(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=H(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Mt(){return(new Date).toISOString().substring(0,10)}class jt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!ie()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=await Nt();return await t.transaction(Ot).objectStore(Ot).get(Dt(e))}catch(e){if(e instanceof se)at.warn(e.message);else{const t=_t.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});at.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return At(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return At(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Ft(e){return H(JSON.stringify({version:2,heartbeats:e})).length}ft(new Oe("platform-logger",(e=>new it(e)),"PRIVATE")),ft(new Oe("heartbeat",(e=>new Lt(e)),"PRIVATE")),St(st,ot,""),St(st,ot,"esm2017"),St("fire-js","");class Ut{constructor(e,t){this._delegate=e,this.firebase=t,dt(e,new Oe("app-compat",(()=>this),"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise((e=>{this._delegate.checkDestroyed(),e()})).then((()=>(this.firebase.INTERNAL.removeApp(this.name),Ct(this._delegate))))}_getService(e,t=ct){var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=ct){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){dt(this._delegate,e)}_addOrOverwriteComponent(e){pt(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const qt=new oe("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),Wt=function t(){const n=function(t){const n={},r={__esModule:!0,initializeApp:function(e,i={}){const s=bt(e,i);if(he(n,s.name))return n[s.name];const o=new t(s,r);return n[s.name]=o,o},app:i,registerVersion:St,setLogLevel:Et,onLog:Tt,apps:null,SDK_VERSION:wt,INTERNAL:{registerComponent:function(e){const n=e.name,s=n.replace("-compat","");if(ft(e)&&"PUBLIC"===e.type){const o=(e=i())=>{if("function"!=typeof e[s])throw qt.create("invalid-app-argument",{appName:n});return e[s]()};void 0!==e.serviceProps&&Y(o,e.serviceProps),r[s]=o,t.prototype[s]=function(...t){return this._getService.bind(this,n).apply(this,e.multipleInstances?t:[])}}return"PUBLIC"===e.type?r[s]:null},removeApp:function(e){delete n[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:e}};function i(e){if(!he(n,e=e||ct))throw qt.create("no-app",{appName:e});return n[e]}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(n).map((e=>n[e]))}}),i.App=t,r}(Ut);return n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(e){Y(n,e)},createSubscribe:be,ErrorFactory:oe,deepExtend:Y}),n}(),Bt=new qe("@firebase/app-compat");if("object"==typeof self&&self.self===self&&void 0!==self.firebase){Bt.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const e=self.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&Bt.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const $t=Wt;function Vt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}St("@firebase/app-compat","0.2.25",void 0),$t.registerVersion("firebase","10.7.1","app-compat"),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const zt={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};const Ht=function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},Kt=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Yt=new oe("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Gt=new qe("@firebase/auth");function Jt(e,...t){Gt.logLevel<=Le.ERROR&&Gt.error(`Auth (${wt}): ${e}`,...t)}function Qt(e,...t){throw tn(e,...t)}function Xt(e,...t){return tn(e,...t)}function Zt(e,t,n){const r=Object.assign(Object.assign({},Kt()),{[t]:n});return new oe("auth","Firebase",r).create(t,{appName:e.name})}function en(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&Qt(e,"argument-error"),Zt(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function tn(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return Yt.create(e,...t)}function nn(e,t,...n){if(!e)throw tn(t,...n)}function rn(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Jt(t),new Error(t)}function sn(e,t){e||rn(t)}function on(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function an(){return"http:"===cn()||"https:"===cn()}function cn(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class ln{constructor(e,t){this.shortDelay=e,this.longDelay=t,sn(t>e,"Short delay should be less than long delay!"),this.isMobile=Z()||ne()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(an()||te()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function un(e,t){sn(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class hn{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void rn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void rn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void rn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const dn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},pn=new ln(3e4,6e4);function fn(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function gn(e,t,n,r,i={}){return mn(e,i,(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=ve(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),hn.fetch()(_n(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function mn(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},dn),t);try{const t=new wn(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw bn(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw bn(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw bn(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw bn(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Zt(e,a,o);Qt(e,a)}}catch(t){if(t instanceof se)throw t;Qt(e,"network-request-failed",{message:String(t)})}}async function vn(e,t,n,r,i={}){const s=await gn(e,t,n,r,i);return"mfaPendingCredential"in s&&Qt(e,"multi-factor-auth-required",{_serverResponse:s}),s}function _n(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?un(e.config,i):`${e.config.apiScheme}://${i}`}function yn(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class wn{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Xt(this.auth,"network-request-failed"))),pn.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function bn(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Xt(e,t,r);return i.customData._tokenResponse=n,i}function In(e){return void 0!==e&&void 0!==e.getResponse}function kn(e){return void 0!==e&&void 0!==e.enterprise}class Cn{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return yn(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}function Sn(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function Tn(e){return 1e3*Number(e)}function En(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Jt("JWT malformed, contained fewer than 3 sections"),null;try{const e=K(n);return e?JSON.parse(e):(Jt("Failed to decode base64 JWT payload"),null)}catch(e){return Jt("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}async function xn(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof se&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Pn{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class On{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sn(this.lastLoginAt),this.creationTime=Sn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Rn(e){var t;const n=e.auth,r=await e.getIdToken(),i=await xn(e,async function(e,t){return gn(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));nn(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=Vt(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,l=o,[...c.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var c,l;const u=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!u&&h,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new On(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,p)}class Nn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){nn(e.idToken,"internal-error"),nn(void 0!==e.idToken,"internal-error"),nn(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=En(e);return nn(t,"internal-error"),nn(void 0!==t.exp,"internal-error"),nn(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return nn(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await mn(e,{},(async()=>{const n=ve({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=_n(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",hn.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Nn;return n&&(nn("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(nn("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(nn("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Nn,this.toJSON())}_performRefresh(){return rn("not implemented")}}function An(e,t){nn("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Dn{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=Vt(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Pn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new On(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await xn(this,this.stsTokenManager.getToken(this.auth,e));return nn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Pe(e),r=await n.getIdToken(t),i=En(r);nn(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Sn(Tn(i.auth_time)),issuedAtTime:Sn(Tn(i.iat)),expirationTime:Sn(Tn(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Pe(e);await Rn(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(nn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Dn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){nn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Rn(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await xn(this,async function(e,t){return gn(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,l;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,f=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,v=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:_,emailVerified:y,isAnonymous:w,providerData:b,stsTokenManager:I}=t;nn(_&&I,e,"internal-error");const k=Nn.fromJSON(this.name,I);nn("string"==typeof _,e,"internal-error"),An(u,e.name),An(h,e.name),nn("boolean"==typeof y,e,"internal-error"),nn("boolean"==typeof w,e,"internal-error"),An(d,e.name),An(p,e.name),An(f,e.name),An(g,e.name),An(m,e.name),An(v,e.name);const C=new Dn({uid:_,auth:e,email:h,emailVerified:y,displayName:u,isAnonymous:w,photoURL:p,phoneNumber:d,tenantId:f,stsTokenManager:k,createdAt:m,lastLoginAt:v});return b&&Array.isArray(b)&&(C.providerData=b.map((e=>Object.assign({},e)))),g&&(C._redirectEventId=g),C}static async _fromIdTokenResponse(e,t,n=!1){const r=new Nn;r.updateFromServerResponse(t);const i=new Dn({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Rn(i),i}}const Ln=new Map;function Mn(e){sn(e instanceof Function,"Expected a class definition");let t=Ln.get(e);return t?(sn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Ln.set(e,t),t)}class jn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}jn.type="NONE";const Fn=jn;function Un(e,t,n){return`firebase:${e}:${t}:${n}`}class qn{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Un(this.userKey,r.apiKey,i),this.fullPersistenceKey=Un("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Dn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new qn(Mn(Fn),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||Mn(Fn);const s=Un(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const r=Dn._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new qn(i,e,n)):new qn(i,e,n)}}function Wn(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(zn(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Bn(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Kn(t))return"Blackberry";if(Yn(t))return"Webos";if($n(t))return"Safari";if((t.includes("chrome/")||Vn(t))&&!t.includes("edge/"))return"Chrome";if(Hn(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Bn(e=X()){return/firefox\//i.test(e)}function $n(e=X()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Vn(e=X()){return/crios\//i.test(e)}function zn(e=X()){return/iemobile/i.test(e)}function Hn(e=X()){return/android/i.test(e)}function Kn(e=X()){return/blackberry/i.test(e)}function Yn(e=X()){return/webos/i.test(e)}function Gn(e=X()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Jn(e=X()){return Gn(e)||Hn(e)||Yn(e)||Kn(e)||/windows phone/i.test(e)||zn(e)}function Qn(e,t=[]){let n;switch(e){case"Browser":n=Wn(X());break;case"Worker":n=`${Wn(X())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${wt}/${r}`}class Xn{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(e){r(e)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class Zn{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class er{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nr(this),this.idTokenSubscription=new nr(this),this.beforeStateQueue=new Xn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Yt,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Mn(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await qn.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return nn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Rn(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Pe(e):null;return t&&nn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&nn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Mn(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return gn(e,"GET","/v2/passwordPolicy",fn(e,t))}(this),t=new Zn(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new oe("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return gn(e,"POST","/v2/accounts:revokeToken",fn(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Mn(e)||this._popupRedirectResolver;nn(t,this,"argument-error"),this.redirectPersistenceManager=await qn.create(this,[Mn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(nn(o,this,"internal-error"),o.then((()=>{s||i(this.currentUser)})),"function"==typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return nn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Qn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){Gt.logLevel<=Le.WARN&&Gt.warn(`Auth (${wt}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function tr(e){return Pe(e)}class nr{constructor(e){this.auth=e,this.observer=null,this.addObserver=be((e=>this.observer=e))}get next(){return nn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function rr(e){return new Promise(((t,n)=>{const r=document.createElement("script");var i,s;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Xt("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(null!==(s=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==s?s:document).appendChild(r)}))}function ir(e){return`__${e}${Math.floor(1e6*Math.random())}`}class sr{constructor(e){this.type="recaptcha-enterprise",this.auth=tr(e)}async verify(e="verify",t=!1){function n(t,n,r){const i=window.grecaptcha;kn(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{(async function(e,t){return gn(e,"GET","/v2/recaptchaConfig",fn(e,t))})(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new Cn(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&kn(window.grecaptcha))n(i,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));rr("https://www.google.com/recaptcha/enterprise.js?render="+i).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function or(e,t,n,r=!1){const i=new sr(e);let s;try{s=await i.verify(n)}catch(e){s=await i.verify(n,!0)}const o=Object.assign({},t);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function ar(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await or(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await or(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}function cr(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function lr(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class ur{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return rn("not implemented")}_getIdTokenResponse(e){return rn("not implemented")}_linkToIdToken(e,t){return rn("not implemented")}_getReauthenticationResolver(e){return rn("not implemented")}}async function hr(e,t){return gn(e,"POST","/v1/accounts:resetPassword",fn(e,t))}async function dr(e,t){return gn(e,"POST","/v1/accounts:signUp",t)}async function pr(e,t){return vn(e,"POST","/v1/accounts:signInWithPassword",fn(e,t))}async function fr(e,t){return gn(e,"POST","/v1/accounts:sendOobCode",fn(e,t))}async function gr(e,t){return fr(e,t)}async function mr(e,t){return fr(e,t)}class vr extends ur{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new vr(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new vr(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return ar(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",pr);case"emailLink":return async function(e,t){return vn(e,"POST","/v1/accounts:signInWithEmailLink",fn(e,t))}(e,{email:this._email,oobCode:this._password});default:Qt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return ar(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",dr);case"emailLink":return async function(e,t){return vn(e,"POST","/v1/accounts:signInWithEmailLink",fn(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Qt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function _r(e,t){return vn(e,"POST","/v1/accounts:signInWithIdp",fn(e,t))}class yr extends ur{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new yr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Qt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=Vt(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new yr(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return _r(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,_r(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,_r(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ve(t)}return e}}const wr={USER_NOT_FOUND:"user-not-found"};class br extends ur{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new br({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new br({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return vn(e,"POST","/v1/accounts:signInWithPhoneNumber",fn(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await vn(e,"POST","/v1/accounts:signInWithPhoneNumber",fn(e,t));if(n.temporaryProof)throw bn(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return vn(e,"POST","/v1/accounts:signInWithPhoneNumber",fn(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),wr)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new br({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Ir{constructor(e){var t,n,r,i,s,o;const a=_e(ye(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);nn(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=_e(ye(e)).link,n=t?_e(ye(t)).deep_link_id:null,r=_e(ye(e)).deep_link_id;return(r?_e(ye(r)).link:null)||r||n||t||e}(e);try{return new Ir(t)}catch(e){return null}}}class kr{constructor(){this.providerId=kr.PROVIDER_ID}static credential(e,t){return vr._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Ir.parseLink(t);return nn(n,"argument-error"),vr._fromEmailAndCode(e,n.code,n.tenantId)}}kr.PROVIDER_ID="password",kr.EMAIL_PASSWORD_SIGN_IN_METHOD="password",kr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Cr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Sr extends Cr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Tr extends Sr{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return nn("providerId"in t&&"signInMethod"in t,"argument-error"),yr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return nn(e.idToken||e.accessToken,"argument-error"),yr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Tr.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Tr.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:r,pendingToken:i,nonce:s,providerId:o}=e;if(!(n||r||t||i))return null;if(!o)return null;try{return new Tr(o)._credential({idToken:t,accessToken:n,nonce:s,pendingToken:i})}catch(e){return null}}}class Er extends Sr{constructor(){super("facebook.com")}static credential(e){return yr._fromParams({providerId:Er.PROVIDER_ID,signInMethod:Er.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Er.credentialFromTaggedObject(e)}static credentialFromError(e){return Er.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Er.credential(e.oauthAccessToken)}catch(e){return null}}}Er.FACEBOOK_SIGN_IN_METHOD="facebook.com",Er.PROVIDER_ID="facebook.com";class xr extends Sr{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return yr._fromParams({providerId:xr.PROVIDER_ID,signInMethod:xr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return xr.credentialFromTaggedObject(e)}static credentialFromError(e){return xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return xr.credential(t,n)}catch(e){return null}}}xr.GOOGLE_SIGN_IN_METHOD="google.com",xr.PROVIDER_ID="google.com";class Pr extends Sr{constructor(){super("github.com")}static credential(e){return yr._fromParams({providerId:Pr.PROVIDER_ID,signInMethod:Pr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pr.credentialFromTaggedObject(e)}static credentialFromError(e){return Pr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Pr.credential(e.oauthAccessToken)}catch(e){return null}}}Pr.GITHUB_SIGN_IN_METHOD="github.com",Pr.PROVIDER_ID="github.com";class Or extends ur{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return _r(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,_r(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,_r(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new Or(n,i):null}static _create(e,t){return new Or(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Rr extends Cr{constructor(e){nn(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return Rr.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Rr.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Or.fromJSON(e);return nn(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return Or._create(n,t)}catch(e){return null}}}class Nr extends Sr{constructor(){super("twitter.com")}static credential(e,t){return yr._fromParams({providerId:Nr.PROVIDER_ID,signInMethod:Nr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Nr.credentialFromTaggedObject(e)}static credentialFromError(e){return Nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Nr.credential(t,n)}catch(e){return null}}}async function Ar(e,t){return vn(e,"POST","/v1/accounts:signUp",fn(e,t))}Nr.TWITTER_SIGN_IN_METHOD="twitter.com",Nr.PROVIDER_ID="twitter.com";class Dr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await Dn._fromIdTokenResponse(e,n,r),s=Lr(n);return new Dr({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Lr(n);return new Dr({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Lr(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Mr extends se{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Mr.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Mr(e,t,n,r)}}function jr(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Mr._fromErrorAndOperation(e,n,t,r);throw n}))}function Fr(e){return new Set(e.map((({providerId:e})=>e)).filter((e=>!!e)))}async function Ur(e,t,n=!1){const r=await xn(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Dr._forOperation(e,"link",r)}async function qr(e,t,n){await Rn(t);const r=!1===e?"provider-already-linked":"no-such-provider";nn(Fr(t.providerData).has(n)===e,t.auth,r)}async function Wr(e,t,n=!1){const{auth:r}=e,i="reauthenticate";try{const s=await xn(e,jr(r,i,t,e),n);nn(s.idToken,r,"internal-error");const o=En(s.idToken);nn(o,r,"internal-error");const{sub:a}=o;return nn(e.uid===a,r,"user-mismatch"),Dr._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&Qt(r,"user-mismatch"),e}}async function Br(e,t,n=!1){const r="signIn",i=await jr(e,r,t),s=await Dr._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function $r(e,t){return Br(tr(e),t)}async function Vr(e,t){const n=Pe(e);return await qr(!1,n,t.providerId),Ur(n,t)}async function zr(e,t){return Wr(Pe(e),t)}class Hr{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Kr._fromServerResponse(e,t):"totpInfo"in t?Yr._fromServerResponse(e,t):Qt(e,"internal-error")}}class Kr extends Hr{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Kr(t)}}class Yr extends Hr{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Yr(t)}}function Gr(e,t,n){var r;nn((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),nn(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(nn(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(nn(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Jr(e){const t=tr(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function Qr(e,t){const n=Pe(e),r=await hr(n,{oobCode:t}),i=r.requestType;switch(nn(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":nn(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":nn(r.mfaInfo,n,"internal-error");default:nn(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=Hr._fromServerResponse(tr(n),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function Xr(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await xn(e,async function(e,t){return gn(e,"POST","/v1/accounts:update",t)}(r,i));await e._updateTokensIfNecessary(s,!0)}class Zr{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class ei extends Zr{constructor(e,t,n,r){super(e,t,n),this.username=r}}class ti extends Zr{constructor(e,t){super(e,"facebook.com",t)}}class ni extends ei{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class ri extends Zr{constructor(e,t){super(e,"google.com",t)}}class ii extends ei{constructor(e,t,n){super(e,"twitter.com",t,n)}}function si(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null==e?void 0:e.idToken)){const r=null===(n=null===(t=En(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r)return new Zr(s,"anonymous"!==r&&"custom"!==r?r:null)}if(!r)return null;switch(r){case"facebook.com":return new ti(s,i);case"github.com":return new ni(s,i);case"google.com":return new ri(s,i);case"twitter.com":return new ii(s,i,e.screenName||null);case"custom":case"anonymous":return new Zr(s,null);default:return new Zr(s,r,i)}}(n)}class oi{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new oi("enroll",e,t)}static _fromMfaPendingCredential(e){return new oi("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return oi._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return oi._fromIdtoken(e.multiFactorSession.idToken)}return null}}class ai{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=tr(e),r=t.customData._serverResponse,i=(r.mfaInfo||[]).map((e=>Hr._fromServerResponse(n,e)));nn(r.mfaPendingCredential,n,"internal-error");const s=oi._fromMfaPendingCredential(r.mfaPendingCredential);return new ai(s,i,(async e=>{const i=await e._process(n,s);delete r.mfaInfo,delete r.mfaPendingCredential;const o=Object.assign(Object.assign({},r),{idToken:i.idToken,refreshToken:i.refreshToken});switch(t.operationType){case"signIn":const e=await Dr._fromIdTokenResponse(n,t.operationType,o);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return nn(t.user,n,"internal-error"),Dr._forOperation(t.user,t.operationType,o);default:Qt(n,"internal-error")}}))}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}class ci{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload((t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map((t=>Hr._fromServerResponse(e.auth,t))))}))}static _fromUser(e){return new ci(e)}async getSession(){return oi._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,r=await this.getSession(),i=await xn(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken();try{const e=await xn(this.user,(r=this.user.auth,i={idToken:n,mfaEnrollmentId:t},gn(r,"POST","/v2/accounts/mfaEnrollment:withdraw",fn(r,i))));this.enrolledFactors=this.enrolledFactors.filter((({uid:e})=>e!==t)),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(e){throw e}var r,i}}const li=new WeakMap,ui="__sak";class hi{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ui,"1"),this.storage.removeItem(ui),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class di extends hi{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=X();return $n(e)||Gn(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Jn(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);re()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}di.type="LOCAL";const pi=di;class fi extends hi{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}fi.type="SESSION";const gi=fi;class mi{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new mi(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function vi(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}mi.receivers=[];class _i{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=vi("",20);r.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(l),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function yi(){return window}function wi(){return void 0!==yi().WorkerGlobalScope&&"function"==typeof yi().importScripts}const bi="firebaseLocalStorageDb",Ii="firebaseLocalStorage",ki="fbase_key";class Ci{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Si(e,t){return e.transaction([Ii],t?"readwrite":"readonly").objectStore(Ii)}function Ti(){const e=indexedDB.open(bi,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Ii,{keyPath:ki})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Ii)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(bi);return new Ci(e).toPromise()}(),t(await Ti()))}))}))}async function Ei(e,t,n){const r=Si(e,!0).put({[ki]:t,value:n});return new Ci(r).toPromise()}function xi(e,t){const n=Si(e,!0).delete(t);return new Ci(n).toPromise()}class Pi{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Ti()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wi()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=mi._getInstance(wi()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new _i(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ti();return await Ei(e,ui,"1"),await xi(e,ui),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Ei(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Si(e,!1).get(t),r=await new Ci(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>xi(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Si(e,!1).getAll();return new Ci(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Pi.type="LOCAL";const Oi=Pi,Ri=1e12;class Ni{constructor(e){this.auth=e,this.counter=Ri,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new Ai(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||Ri;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||Ri;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||Ri;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class Ai{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"==typeof e?document.getElementById(e):e;nn(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let e=0;e<50;e++)t.push(n.charAt(Math.floor(62*Math.random())));return t.join("")}();const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(e){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(e){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Di=ir("rcb"),Li=new ln(3e4,6e4);class Mi{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=yi().grecaptcha)||void 0===e?void 0:e.render)}load(e,t=""){return nn(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)&&In(yi().grecaptcha)?Promise.resolve(yi().grecaptcha):new Promise(((n,r)=>{const i=yi().setTimeout((()=>{r(Xt(e,"network-request-failed"))}),Li.get());yi()[Di]=()=>{yi().clearTimeout(i),delete yi()[Di];const s=yi().grecaptcha;if(!s||!In(s))return void r(Xt(e,"internal-error"));const o=s.render;s.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(s)},rr(`https://www.google.com/recaptcha/api.js??${ve({onload:Di,render:"explicit",hl:t})}`).catch((()=>{clearTimeout(i),r(Xt(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=yi().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class ji{async load(e){return new Ni(e)}clearedOneInstance(){}}const Fi="recaptcha",Ui={theme:"light",type:"image"};class qi{constructor(e,t,n=Object.assign({},Ui)){this.parameters=n,this.type=Fi,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=tr(e),this.isInvisible="invisible"===this.parameters.size,nn("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"==typeof t?document.getElementById(t):t;nn(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new ji:new Mi,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha();return t.getResponse(e)||new Promise((n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){nn(!this.parameters.sitekey,this.auth,"argument-error"),nn(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),nn("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"==typeof e)e(t);else if("string"==typeof e){const n=yi()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){nn(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){nn(an()&&!wi(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await gn(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);nn(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return nn(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Wi{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=br._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function Bi(e,t,n){var r;const i=await n.verify();try{let s;if(nn("string"==typeof i,e,"argument-error"),nn(n.type===Fi,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){nn("enroll"===t.type,e,"internal-error");const n=await function(e,t){return gn(e,"POST","/v2/accounts/mfaEnrollment:start",fn(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{nn("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;nn(n,e,"missing-multi-factor-info");const o=await function(e,t){return gn(e,"POST","/v2/accounts/mfaSignIn:start",fn(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return gn(e,"POST","/v1/accounts:sendVerificationCode",fn(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class $i{constructor(e){this.providerId=$i.PROVIDER_ID,this.auth=tr(e)}verifyPhoneNumber(e,t){return Bi(this.auth,e,Pe(t))}static credential(e,t){return br._fromVerification(e,t)}static credentialFromResult(e){const t=e;return $i.credentialFromTaggedObject(t)}static credentialFromError(e){return $i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?br._fromTokenResponse(t,n):null}}function Vi(e,t){return t?Mn(t):(nn(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}$i.PROVIDER_ID="phone",$i.PHONE_SIGN_IN_METHOD="phone";class zi extends ur{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return _r(e,this._buildIdpRequest())}_linkToIdToken(e,t){return _r(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return _r(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Hi(e){return Br(e.auth,new zi(e),e.bypassAuthState)}function Ki(e){const{auth:t,user:n}=e;return nn(n,t,"internal-error"),Wr(n,new zi(e),e.bypassAuthState)}async function Yi(e){const{auth:t,user:n}=e;return nn(n,t,"internal-error"),Ur(n,new zi(e),e.bypassAuthState)}class Gi{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Hi;case"linkViaPopup":case"linkViaRedirect":return Yi;case"reauthViaPopup":case"reauthViaRedirect":return Ki;default:Qt(this.auth,"internal-error")}}resolve(e){sn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){sn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Ji=new ln(2e3,1e4);class Qi extends Gi{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Qi.currentPopupAction&&Qi.currentPopupAction.cancel(),Qi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return nn(e,this.auth,"internal-error"),e}async onExecution(){sn(1===this.filter.length,"Popup operations only handle one event");const e=vi();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Xt(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Xt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Xt(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Ji.get())};e()}}Qi.currentPopupAction=null;const Xi="pendingRedirect",Zi=new Map;class es extends Gi{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Zi.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=is(t),r=rs(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Zi.set(this.auth._key(),e)}return this.bypassAuthState||Zi.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function ts(e,t){return rs(e)._set(is(t),"true")}function ns(e,t){Zi.set(e._key(),t)}function rs(e){return Mn(e._redirectPersistence)}function is(e){return Un(Xi,e.config.apiKey,e.name)}async function ss(e,t,n=!1){const r=tr(e),i=Vi(r,t),s=new es(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function os(e){const t=vi(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}class as{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ls(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!ls(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Xt(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(cs(e))}saveEventToCache(e){this.cachedEventUids.add(cs(e)),this.lastProcessedEventTime=Date.now()}}function cs(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function ls({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}async function us(e,t={}){return gn(e,"GET","/v1/projects",t)}const hs=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ds=/^https?/;function ps(e){const t=on(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!ds.test(n))return!1;if(hs.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const fs=new ln(3e4,6e4);function gs(){const e=yi().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let ms=null;function vs(e){return ms=ms||function(e){return new Promise(((t,n)=>{var r,i,s;function o(){gs(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{gs(),n(Xt(e,"network-request-failed"))},timeout:fs.get()})}if(null===(i=null===(r=yi().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=yi().gapi)||void 0===s?void 0:s.load)){const t=ir("iframefcb");return yi()[t]=()=>{gapi.load?o():n(Xt(e,"network-request-failed"))},rr(`https://apis.google.com/js/api.js?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw ms=null,e}))}(e),ms}const _s=new ln(5e3,15e3),ys={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ws=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function bs(e){const t=e.config;nn(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?un(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:wt},i=ws.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${ve(r).slice(1)}`}const Is={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ks{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const Cs="__/auth/handler",Ss="emulator/auth/handler",Ts=encodeURIComponent("fac");async function Es(e,t,n,r,i,s){nn(e.config.authDomain,e,"auth-domain-config-required"),nn(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:wt,eventId:i};if(t instanceof Cr){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",pe(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Sr){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const c=await e._getAppCheckToken(),l=c?`#${Ts}=${encodeURIComponent(c)}`:"";return`${function({config:e}){return e.emulator?un(e,Ss):`https://${e.authDomain}/${Cs}`}(e)}?${ve(a).slice(1)}${l}`}const xs="webStorageSupport",Ps=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gi,this._completeRedirectFn=ss,this._overrideRedirectResult=ns}async _openPopup(e,t,n,r){var i;return sn(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),function(e,t,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Is),{width:r.toString(),height:i.toString(),top:s,left:o}),l=X().toLowerCase();n&&(a=Vn(l)?"_blank":n),Bn(l)&&(t=t||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=X()){var t;return Gn(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new ks(null);const h=window.open(t||"",a,u);nn(h,e,"popup-blocked");try{h.focus()}catch(e){}return new ks(h)}(e,await Es(e,t,n,on(),r),vi())}async _openRedirect(e,t,n,r){return await this._originValidation(e),i=await Es(e,t,n,on(),r),yi().location.href=i,new Promise((()=>{}));var i}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(sn(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await vs(e),n=yi().gapi;return nn(n,e,"internal-error"),t.open({where:document.body,url:bs(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ys,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=Xt(e,"network-request-failed"),s=yi().setTimeout((()=>{r(i)}),_s.get());function o(){yi().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}(e),n=new as(e);return t.register("authEvent",(t=>(nn(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(xs,{type:xs},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[xs];void 0!==i&&t(!!i),Qt(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await us(e);for(const e of t)try{if(ps(e))return}catch(e){}Qt(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Jn()||$n()||Gn()}};class Os{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return rn("unexpected MultiFactorSessionType")}}}class Rs extends Os{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Rs(e)}_finalizeEnroll(e,t,n){return function(e,t){return gn(e,"POST","/v2/accounts/mfaEnrollment:finalize",fn(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return gn(e,"POST","/v2/accounts/mfaSignIn:finalize",fn(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Ns{constructor(){}static assertion(e){return Rs._fromCredential(e)}}Ns.FACTOR_ID="phone";var As,Ds,Ls="@firebase/auth",Ms="1.5.1";class js{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){nn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Fs(){return window}null===(As=G())||void 0===As||As._authIdTokenMaxAge,Ds="Browser",ft(new Oe("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;nn(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:Ds,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Qn(Ds)},c=new er(n,r,i,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Mn);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),ft(new Oe("auth-internal",(e=>{return t=tr(e.getProvider("auth").getImmediate()),new js(t);var t}),"PRIVATE").setInstantiationMode("EXPLICIT")),St(Ls,Ms,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Ds)),St(Ls,Ms,"esm2017");class Us extends as{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise((e=>{this.resolveInialized=e}))}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach((t=>t(e))),super.onEvent(e)}async initialized(){await this.initPromise}}async function qs(e){const t=await Bs()._get($s(e));return t&&await Bs()._remove($s(e)),t}function Ws(){const e=[];for(let t=0;t<20;t++){const t=Math.floor(62*Math.random());e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(t))}return e.join("")}function Bs(){return Mn(pi)}function $s(e){return Un("authEvent",e.config.apiKey,e.name)}function Vs(e){if(!(null==e?void 0:e.includes("?")))return{};const[t,...n]=e.split("?");return _e(n.join("?"))}const zs=class{constructor(){this._redirectPersistence=gi,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=ss,this._overrideRedirectResult=ns}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new Us(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){Qt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){!function(e){var t,n,r,i,s,o,a,c,l,u;const h=Fs();nn("function"==typeof(null===(t=null==h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),nn(void 0!==(null===(n=null==h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),nn("function"==typeof(null===(s=null===(i=null===(r=null==h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===s?void 0:s.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),nn("function"==typeof(null===(c=null===(a=null===(o=null==h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===a?void 0:a.browsertab)||void 0===c?void 0:c.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),nn("function"==typeof(null===(u=null===(l=null==h?void 0:h.cordova)||void 0===l?void 0:l.InAppBrowser)||void 0===u?void 0:u.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),Zi.clear(),await this._originValidation(e);const s=function(e,t,n=null){return{type:t,eventId:n,urlResponse:null,sessionId:Ws(),postBody:null,tenantId:e.tenantId,error:Xt(e,"no-auth-event")}}(e,n,r);await function(e,t){return Bs()._set($s(e),t)}(e,s);const o=await async function(e,t,n){var r;const{BuildInfo:i}=Fs();sn(t.sessionId,"AuthEvent did not contain a session ID");const s=await async function(e){const t=function(e){if(sn(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n}(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t.sessionId),o={};return Gn()?o.ibi=i.packageName:Hn()?o.apn=i.packageName:Qt(e,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,Es(e,n,t.type,void 0,null!==(r=t.eventId)&&void 0!==r?r:void 0,o)}(e,s,t);return async function(e,t,n){const{cordova:r}=Fs();let i=()=>{};try{await new Promise(((s,o)=>{let a=null;function c(){var e;s();const t=null===(e=r.plugins.browsertab)||void 0===e?void 0:e.close;"function"==typeof t&&t(),"function"==typeof(null==n?void 0:n.close)&&n.close()}function l(){a||(a=window.setTimeout((()=>{o(Xt(e,"redirect-cancelled-by-user"))}),2e3))}function u(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&l()}t.addPassiveListener(c),document.addEventListener("resume",l,!1),Hn()&&document.addEventListener("visibilitychange",u,!1),i=()=>{t.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",u,!1),a&&window.clearTimeout(a)}}))}finally{i()}}(e,i,await function(e){const{cordova:t}=Fs();return new Promise((n=>{t.plugins.browsertab.isAvailable((r=>{let i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,function(e=X()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(i)}))}))}(o))}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){const{BuildInfo:t}=Fs(),n={};Gn()?n.iosBundleId=t.packageName:Hn()?n.androidPackageName=t.packageName:Qt(e,"operation-not-supported-in-this-environment"),await us(e,n)}(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:r,BuildInfo:i}=Fs(),s=setTimeout((async()=>{await qs(e),t.onEvent(Hs())}),500),o=async n=>{clearTimeout(s);const r=await qs(e);let i=null;r&&(null==n?void 0:n.url)&&(i=function(e,t){var n,r;const i=function(e){const t=Vs(e),n=t.link?decodeURIComponent(t.link):void 0,r=Vs(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return Vs(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){const t=Vs(i),s=t.firebaseError?function(e){try{return JSON.parse(e)}catch(e){return null}}(decodeURIComponent(t.firebaseError)):null,o=null===(r=null===(n=null==s?void 0:s.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],a=o?Xt(o):null;return a?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:a,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}(r,n.url)),t.onEvent(i||Hs())};void 0!==n&&"function"==typeof n.subscribe&&n.subscribe(null,o);const a=r,c=`${i.packageName.toLowerCase()}://`;Fs().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(c)&&o({url:e}),"function"==typeof a)try{a(e)}catch(e){console.error(e)}}}};function Hs(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Xt("no-auth-event")}}function Ks(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function Ys(e=X()){return!("file:"!==Ks()&&"ionic:"!==Ks()&&"capacitor:"!==Ks()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function Gs(){try{const e=self.localStorage,t=vi();if(e)return e.setItem(t,"1"),e.removeItem(t),!function(e=X()){return re()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(e=X()){return/Edge\/\d+/.test(e)}(e)}()||ie()}catch(e){return Js()&&ie()}return!1}function Js(){return void 0!==n.g&&"WorkerGlobalScope"in n.g&&"importScripts"in n.g}function Qs(){return("http:"===Ks()||"https:"===Ks()||te()||Ys())&&!(ne()||ee())&&Gs()&&!Js()}function Xs(){return Ys()&&"undefined"!=typeof document}const Zs={LOCAL:"local",NONE:"none",SESSION:"session"},eo=nn,to="persistence";async function no(e){await e._initializationPromise;const t=ro(),n=Un(to,e.config.apiKey,e.name);t&&t.setItem(n,e._getPersistence())}function ro(){var e;try{return(null===(e="undefined"!=typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(e){return null}}const io=nn;class so{constructor(){this.browserResolver=Mn(Ps),this.cordovaResolver=Mn(zs),this.underlyingResolver=null,this._redirectPersistence=gi,this._completeRedirectFn=ss,this._overrideRedirectResult=ns}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return Xs()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return io(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await async function(){return!!Xs()&&new Promise((e=>{const t=setTimeout((()=>{e(!1)}),1e3);document.addEventListener("deviceready",(()=>{clearTimeout(t),e(!0)}))}))}();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function oo(e){return e.unwrap()}function ao(e){const{_tokenResponse:t}=e instanceof se?e.customData:e;if(!t)return null;if(!(e instanceof se)&&"temporaryProof"in t&&"phoneNumber"in t)return $i.credentialFromResult(e);const n=t.providerId;if(!n||n===zt.PASSWORD)return null;let r;switch(n){case zt.GOOGLE:r=xr;break;case zt.FACEBOOK:r=Er;break;case zt.GITHUB:r=Pr;break;case zt.TWITTER:r=Nr;break;default:const{oauthIdToken:e,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:o,nonce:a}=t;return i||s||e||o?o?n.startsWith("saml.")?Or._create(n,o):yr._fromParams({providerId:n,signInMethod:n,pendingToken:o,idToken:e,accessToken:i}):new Tr(n).credential({idToken:e,accessToken:i,rawNonce:a}):null}return e instanceof se?r.credentialFromError(e):r.credentialFromResult(e)}function co(e,t){return t.catch((t=>{throw t instanceof se&&function(e,t){var n;const r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null==t?void 0:t.code))t.resolver=new uo(e,function(e,t){var n;const r=Pe(e),i=t;return nn(t.customData.operationType,r,"argument-error"),nn(null===(n=i.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),ai._fromError(r,i)}(e,t));else if(r){const e=ao(t),n=t;e&&(n.credential=e,n.tenantId=r.tenantId||void 0,n.email=r.email||void 0,n.phoneNumber=r.phoneNumber||void 0)}}(e,t),t})).then((e=>{const t=e.operationType,n=e.user;return{operationType:t,credential:(r=e,ao(r)),additionalUserInfo:si(e),user:ho.getOrCreate(n)};var r}))}async function lo(e,t){const n=await t;return{verificationId:n.verificationId,confirm:t=>co(e,n.confirm(t))}}class uo{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return co(oo(this.auth),this.resolver.resolveSignIn(e))}}class ho{constructor(e){this._delegate=e,this.multiFactor=function(e){const t=Pe(e);return li.has(t)||li.set(t,ci._fromUser(t)),li.get(t)}(e)}static getOrCreate(e){return ho.USER_MAP.has(e)||ho.USER_MAP.set(e,new ho(e)),ho.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return co(this.auth,Vr(this._delegate,e))}async linkWithPhoneNumber(e,t){return lo(this.auth,async function(e,t,n){const r=Pe(e);await qr(!1,r,"phone");const i=await Bi(r.auth,t,Pe(n));return new Wi(i,(e=>Vr(r,e)))}(this._delegate,e,t))}async linkWithPopup(e){return co(this.auth,async function(e,t,n){const r=Pe(e);en(r.auth,t,Cr);const i=Vi(r.auth,n);return new Qi(r.auth,"linkViaPopup",t,i,r).executeNotNull()}(this._delegate,e,so))}async linkWithRedirect(e){return await no(tr(this.auth)),function(e,t,n){return async function(e,t,n){const r=Pe(e);en(r.auth,t,Cr),await r.auth._initializationPromise;const i=Vi(r.auth,n);await qr(!1,r,t.providerId),await ts(i,r.auth);const s=await os(r);return i._openRedirect(r.auth,t,"linkViaRedirect",s)}(e,t,n)}(this._delegate,e,so)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return co(this.auth,zr(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return lo(this.auth,async function(e,t,n){const r=Pe(e),i=await Bi(r.auth,t,Pe(n));return new Wi(i,(e=>zr(r,e)))}(this._delegate,e,t))}reauthenticateWithPopup(e){return co(this.auth,async function(e,t,n){const r=Pe(e);en(r.auth,t,Cr);const i=Vi(r.auth,n);return new Qi(r.auth,"reauthViaPopup",t,i,r).executeNotNull()}(this._delegate,e,so))}async reauthenticateWithRedirect(e){return await no(tr(this.auth)),function(e,t,n){return async function(e,t,n){const r=Pe(e);en(r.auth,t,Cr),await r.auth._initializationPromise;const i=Vi(r.auth,n);await ts(i,r.auth);const s=await os(r);return i._openRedirect(r.auth,t,"reauthViaRedirect",s)}(e,t,n)}(this._delegate,e,so)}sendEmailVerification(e){return async function(e,t){const n=Pe(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&Gr(n.auth,r,t);const{email:i}=await async function(e,t){return fr(e,t)}(n.auth,r);i!==e.email&&await e.reload()}(this._delegate,e)}async unlink(e){return await async function(e,t){const n=Pe(e);await qr(!0,n,t);const{providerUserInfo:r}=await async function(e,t){return gn(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),i=Fr(r||[]);return n.providerData=n.providerData.filter((e=>i.has(e.providerId))),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}(this._delegate,e),this}updateEmail(e){return function(e,t){return Xr(Pe(e),t,null)}(this._delegate,e)}updatePassword(e){return function(e,t){return Xr(Pe(e),null,t)}(this._delegate,e)}updatePhoneNumber(e){return async function(e,t){await Ur(Pe(e),t)}(this._delegate,e)}updateProfile(e){return async function(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const r=Pe(e),i={idToken:await r.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},s=await xn(r,async function(e,t){return gn(e,"POST","/v1/accounts:update",t)}(r.auth,i));r.displayName=s.displayName||null,r.photoURL=s.photoUrl||null;const o=r.providerData.find((({providerId:e})=>"password"===e));o&&(o.displayName=r.displayName,o.photoURL=r.photoURL),await r._updateTokensIfNecessary(s)}(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return async function(e,t,n){const r=Pe(e),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&Gr(r.auth,i,n);const{email:s}=await async function(e,t){return fr(e,t)}(r.auth,i);s!==e.email&&await e.reload()}(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}ho.USER_MAP=new WeakMap;const po=nn;class fo{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=e.options;po(n,"invalid-api-key",{appName:e.name}),po(n,"invalid-api-key",{appName:e.name});const r="undefined"!=typeof window?so:void 0;this._delegate=t.initialize({options:{persistence:mo(n,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(Ht),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?ho.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){!function(e,t,n){const r=tr(e);nn(r._canInitEmulator,r,"emulator-config-failed"),nn(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),s=cr(t),{host:o,port:a}=function(e){const t=cr(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:lr(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:lr(t)}}}(t),c=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(this._delegate,e,t)}applyActionCode(e){return async function(e,t){await async function(e,t){return gn(e,"POST","/v1/accounts:update",fn(e,t))}(Pe(e),{oobCode:t})}(this._delegate,e)}checkActionCode(e){return Qr(this._delegate,e)}confirmPasswordReset(e,t){return async function(e,t,n){await hr(Pe(e),{oobCode:t,newPassword:n}).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Jr(e),t}))}(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return co(this._delegate,async function(e,t,n){const r=tr(e),i=ar(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ar),s=await i.catch((t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Jr(e),t})),o=await Dr._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(o.user),o}(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return async function(e,t){const n={identifier:t,continueUri:an()?on():"http://localhost"},{signinMethods:r}=await async function(e,t){return gn(e,"POST","/v1/accounts:createAuthUri",fn(e,t))}(Pe(e),n);return r||[]}(this._delegate,e)}isSignInWithEmailLink(e){return function(e,t){const n=Ir.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}(this._delegate,e)}async getRedirectResult(){po(Qs(),this._delegate,"operation-not-supported-in-this-environment");const e=await async function(e,t){return await tr(e)._initializationPromise,ss(e,t,!1)}(this._delegate,so);return e?co(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){!function(e,t){tr(e)._logFramework(t)}(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:r,error:i,complete:s}=go(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){const{next:r,error:i,complete:s}=go(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){return async function(e,t,n){const r=tr(e),i={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};!function(e,t){nn(t.handleCodeInApp,r,"argument-error"),t&&Gr(r,e,t)}(i,n),await ar(r,i,"getOobCode",mr)}(this._delegate,e,t)}sendPasswordResetEmail(e,t){return async function(e,t,n){const r=tr(e),i={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&Gr(r,i,n),await ar(r,i,"getOobCode",gr)}(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(function(e,t){eo(Object.values(Zs).includes(t),e,"invalid-persistence-type"),ne()?eo(t!==Zs.SESSION,e,"unsupported-persistence-type"):ee()?eo(t===Zs.NONE,e,"unsupported-persistence-type"):Js()?eo(t===Zs.NONE||t===Zs.LOCAL&&ie(),e,"unsupported-persistence-type"):eo(t===Zs.NONE||Gs(),e,"unsupported-persistence-type")}(this._delegate,e),e){case Zs.SESSION:t=gi;break;case Zs.LOCAL:t=await Mn(Oi)._isAvailable()?Oi:pi;break;case Zs.NONE:t=Fn;break;default:return Qt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return co(this._delegate,async function(e){var t;const n=tr(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Dr({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Ar(n,{returnSecureToken:!0}),i=await Dr._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}(this._delegate))}signInWithCredential(e){return co(this._delegate,$r(this._delegate,e))}signInWithCustomToken(e){return co(this._delegate,async function(e,t){const n=tr(e),r=await async function(e,t){return vn(e,"POST","/v1/accounts:signInWithCustomToken",fn(e,t))}(n,{token:t,returnSecureToken:!0}),i=await Dr._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}(this._delegate,e))}signInWithEmailAndPassword(e,t){return co(this._delegate,function(e,t,n){return $r(Pe(e),kr.credential(t,n)).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Jr(e),t}))}(this._delegate,e,t))}signInWithEmailLink(e,t){return co(this._delegate,async function(e,t,n){const r=Pe(e),i=kr.credentialWithLink(t,n||on());return nn(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),$r(r,i)}(this._delegate,e,t))}signInWithPhoneNumber(e,t){return lo(this._delegate,async function(e,t,n){const r=tr(e),i=await Bi(r,t,Pe(n));return new Wi(i,(e=>$r(r,e)))}(this._delegate,e,t))}async signInWithPopup(e){return po(Qs(),this._delegate,"operation-not-supported-in-this-environment"),co(this._delegate,async function(e,t,n){const r=tr(e);en(e,t,Cr);const i=Vi(r,n);return new Qi(r,"signInViaPopup",t,i).executeNotNull()}(this._delegate,e,so))}async signInWithRedirect(e){return po(Qs(),this._delegate,"operation-not-supported-in-this-environment"),await no(this._delegate),function(e,t,n){return async function(e,t,n){const r=tr(e);en(e,t,Cr),await r._initializationPromise;const i=Vi(r,n);return await ts(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}(this._delegate,e,so)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return async function(e,t){const{data:n}=await Qr(Pe(e),t);return n.email}(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function go(e,t,n){let r=e;"function"!=typeof e&&({next:r,error:t,complete:n}=e);const i=r;return{next:e=>i(e&&ho.getOrCreate(e)),error:t,complete:n}}function mo(e,t){const n=function(e,t){const n=ro();if(!n)return[];const r=Un(to,e,t);switch(n.getItem(r)){case Zs.NONE:return[Fn];case Zs.LOCAL:return[Oi,gi];case Zs.SESSION:return[gi];default:return[]}}(e,t);if("undefined"==typeof self||n.includes(Oi)||n.push(Oi),"undefined"!=typeof window)for(const e of[pi,gi])n.includes(e)||n.push(e);return n.includes(Fn)||n.push(Fn),n}fo.Persistence=Zs;class vo{constructor(){this.providerId="phone",this._delegate=new $i(oo($t.auth()))}static credential(e,t){return $i.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}vo.PHONE_SIGN_IN_METHOD=$i.PHONE_SIGN_IN_METHOD,vo.PROVIDER_ID=$i.PROVIDER_ID;const _o=nn;class yo{constructor(e,t,n=$t.app()){var r;_o(null===(r=n.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new qi(n.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function(e){e.INTERNAL.registerComponent(new Oe("auth-compat",(e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new fo(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:kr,FacebookAuthProvider:Er,GithubAuthProvider:Pr,GoogleAuthProvider:xr,OAuthProvider:Tr,SAMLAuthProvider:Rr,PhoneAuthProvider:vo,PhoneMultiFactorGenerator:Ns,RecaptchaVerifier:yo,TwitterAuthProvider:Nr,Auth:fo,AuthCredential:ur,Error:se}).setInstantiationMode("LAZY").setMultipleInstances(!1)),e.registerVersion("@firebase/auth-compat","0.5.1")}($t);const wo="@firebase/database",bo="1.0.2";let Io="";function ko(e){Io=e}class Co{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),le(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:ce(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class So{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return he(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const To=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Co(t)}}catch(e){}return new So},Eo=To("localStorage"),xo=To("sessionStorage"),Po=new qe("@firebase/database"),Oo=function(){let e=1;return function(){return e++}}(),Ro=function(e){const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,U(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new we;n.update(t);const r=n.digest();return B.encodeByteArray(r)},No=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=No.apply(null,r):t+="object"==typeof r?le(r):r,t+=" "}return t};let Ao=null,Do=!0;const Lo=function(e,t){U(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(Po.logLevel=Le.VERBOSE,Ao=Po.log.bind(Po),t&&xo.set("logging_enabled",!0)):"function"==typeof e?Ao=e:(Ao=null,xo.remove("logging_enabled"))},Mo=function(...e){if(!0===Do&&(Do=!1,null===Ao&&!0===xo.get("logging_enabled")&&Lo(!0)),Ao){const t=No.apply(null,e);Ao(t)}},jo=function(e){return function(...t){Mo(e,...t)}},Fo=function(...e){const t="FIREBASE INTERNAL ERROR: "+No(...e);Po.error(t)},Uo=function(...e){const t=`FIREBASE FATAL ERROR: ${No(...e)}`;throw Po.error(t),new Error(t)},qo=function(...e){const t="FIREBASE WARNING: "+No(...e);Po.warn(t)},Wo=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Bo="[MIN_NAME]",$o="[MAX_NAME]",Vo=function(e,t){if(e===t)return 0;if(e===Bo||t===$o)return-1;if(t===Bo||e===$o)return 1;{const n=Xo(e),r=Xo(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},zo=function(e,t){return e===t?0:e<t?-1:1},Ho=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+le(t))},Ko=function(e){if("object"!=typeof e||null===e)return le(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=le(t[r]),n+=":",n+=Ko(e[t[r]]);return n+="}",n},Yo=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function Go(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Jo=function(e){U(!Wo(e),"Invalid JSON number");let t,n,r,i,s;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),n=i+1023,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));const o=[];for(s=52;s;s-=1)o.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;s-=1)o.push(n%2?1:0),n=Math.floor(n/2);o.push(t?1:0),o.reverse();const a=o.join("");let c="";for(s=0;s<64;s+=8){let e=parseInt(a.substr(s,8),2).toString(16);1===e.length&&(e="0"+e),c+=e}return c.toLowerCase()},Qo=new RegExp("^-?(0*)\\d{1,10}$"),Xo=function(e){if(Qo.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Zo=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw qo("Exception was thrown by user callback.",t),e}),Math.floor(0))}},ea=function(e,t){const n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class ta{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){qo(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class na{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Mo("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',qo(e)}}class ra{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}ra.OWNER="owner";const ia="5",sa=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,oa="ac",aa="websocket",ca="long_polling";class la{constructor(e,t,n,r,i=!1,s="",o=!1,a=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Eo.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Eo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function ua(e,t,n){let r;if(U("string"==typeof t,"typeof type must == string"),U("object"==typeof n,"typeof params must == object"),t===aa)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==ca)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return Go(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}class ha{constructor(){this.counters_={}}incrementCounter(e,t=1){he(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Y(void 0,this.counters_)}}const da={},pa={};function fa(e){const t=e.toString();return da[t]||(da[t]=new ha),da[t]}class ga{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&Zo((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const ma="start";class va{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=jo(e),this.stats_=fa(t),this.urlFn=e=>(this.appCheckToken&&(e[oa]=this.appCheckToken),ua(t,ca,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new ga(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new _a(((...e)=>{const[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===ma)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[ma]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=ia,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[oa]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&sa.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){va.forceAllow_=!0}static forceDisallow(){va.forceDisallow_=!0}static isAvailable(){return!(!va.forceAllow_&&(va.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=le(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=z(t),r=Yo(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=le(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class _a{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Oo(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=_a.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){Mo("frame writing exception"),e.stack&&Mo(e.stack),Mo(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Mo("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Mo("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}let ya=null;"undefined"!=typeof MozWebSocket?ya=MozWebSocket:"undefined"!=typeof WebSocket&&(ya=WebSocket);class wa{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=jo(this.connId),this.stats_=fa(t),this.connURL=wa.connectionURL_(t,s,o,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const s={};return s.v=ia,"undefined"!=typeof location&&location.hostname&&sa.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),r&&(s[oa]=r),i&&(s.p=i),ua(e,aa,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Eo.set("previous_websocket_failure",!0);try{let e;0,this.mySock=new ya(this.connURL,[],e)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){wa.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==ya&&!wa.forceDisallow_}static previouslyFailed(){return Eo.isInMemoryStorage||!0===Eo.get("previous_websocket_failure")}markConnectionHealthy(){Eo.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=ce(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(U(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=le(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Yo(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}wa.responsesRequiredToBeHealthy=2,wa.healthyTimeout=3e4;class ba{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[va,wa]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=wa&&wa.isAvailable();let n=t&&!wa.previouslyFailed();if(e.webSocketOnly&&(t||qo("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[wa];else{const e=this.transports_=[];for(const t of ba.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);ba.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ba.globalTransportInitialized_=!1;class Ia{constructor(e,t,n,r,i,s,o,a,c,l){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=jo("c:"+this.id+":"),this.transportManager_=new ba(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=ea((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Ho("t",e),n=Ho("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Ho("t",e),n=Ho("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Ho("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Fo("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Fo("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),ia!==n&&qo("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),ea((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ea((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Eo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class ka{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class Ca{constructor(e){this.allowedEvents_=e,this.listeners_={},U(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){U(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class Sa extends Ca{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Z()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new Sa}getInitialEvent(e){return U("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class Ta{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Ea(){return new Ta("")}function xa(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Pa(e){return e.pieces_.length-e.pieceNum_}function Oa(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new Ta(e.pieces_,t)}function Ra(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Na(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function Aa(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new Ta(t,0)}function Da(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof Ta)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new Ta(n,0)}function La(e){return e.pieceNum_>=e.pieces_.length}function Ma(e,t){const n=xa(e),r=xa(t);if(null===n)return t;if(n===r)return Ma(Oa(e),Oa(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function ja(e,t){const n=Na(e,0),r=Na(t,0);for(let e=0;e<n.length&&e<r.length;e++){const t=Vo(n[e],r[e]);if(0!==t)return t}return n.length===r.length?0:n.length<r.length?-1:1}function Fa(e,t){if(Pa(e)!==Pa(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Ua(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(Pa(e)>Pa(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class qa{constructor(e,t){this.errorPrefix_=t,this.parts_=Na(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=xe(this.parts_[e]);Wa(this)}}function Wa(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Ba(e))}function Ba(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class $a extends Ca{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new $a}getInitialEvent(e){return U("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Va=1e3;class za extends ka{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=za.nextPersistentConnectionId_++,this.log_=jo("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Va,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");$a.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&Sa.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r,a:e,b:t};this.log_(le(i)),U(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new Q,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),U(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),U(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;za.warnOnListenWarnings_(s,t),(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&he(e,"w")){const n=de(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();qo(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=ue(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=ue(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),U(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+le(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Fo("Unrecognized action received from server: "+le(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){U(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Va,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Va,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Va),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+za.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},c=function(e){U(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:c};const l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,c]=await Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)]);s?Mo("getToken() completed but was canceled"):(Mo("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=c&&c.token,o=new Ia(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{qo(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&qo(e),a())}}}interrupt(e){Mo("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Mo("Resuming connection for reason: "+e),delete this.interruptReasons_[e],pe(this.interruptReasons_)&&(this.reconnectDelay_=Va,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Ko(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new Ta(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Mo("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Mo("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+Io.replace(/\./g,"-")]=1,Z()?e["framework.cordova"]=1:ne()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Sa.getInstance().currentlyOnline();return pe(this.interruptReasons_)&&e}}za.nextPersistentConnectionId_=0,za.nextConnectionId_=0;class Ha{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ha(e,t)}}class Ka{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Ha(Bo,e),r=new Ha(Bo,t);return 0!==this.compare(n,r)}minPost(){return Ha.MIN}}let Ya;class Ga extends Ka{static get __EMPTY_NODE(){return Ya}static set __EMPTY_NODE(e){Ya=e}compare(e,t){return Vo(e.name,t.name)}isDefinedOn(e){throw q("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ha.MIN}maxPost(){return new Ha($o,Ya)}makePost(e,t){return U("string"==typeof e,"KeyIndex indexValue must always be a string."),new Ha(e,Ya)}toString(){return".key"}}const Ja=new Ga;class Qa{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Xa{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Xa.RED,this.left=null!=r?r:Za.EMPTY_NODE,this.right=null!=i?i:Za.EMPTY_NODE}copy(e,t,n,r,i){return new Xa(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Za.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Za.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Xa.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Xa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Xa.RED=!0,Xa.BLACK=!1;class Za{constructor(e,t=Za.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Za(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Xa.BLACK,null,null))}remove(e){return new Za(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Xa.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Qa(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Qa(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Qa(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Qa(this.root_,null,this.comparator_,!0,e)}}function ec(e,t){return Vo(e.name,t.name)}function tc(e,t){return Vo(e,t)}let nc;Za.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new Xa(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const rc=function(e){return"number"==typeof e?"number:"+Jo(e):"string:"+e},ic=function(e){if(e.isLeafNode()){const t=e.val();U("string"==typeof t||"number"==typeof t||"object"==typeof t&&he(t,".sv"),"Priority must be a string or number.")}else U(e===nc||e.isEmpty(),"priority of unexpected type.");U(e===nc||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let sc,oc,ac;class cc{constructor(e,t=cc.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,U(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),ic(this.priorityNode_)}static set __childrenNodeConstructor(e){sc=e}static get __childrenNodeConstructor(){return sc}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new cc(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:cc.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return La(e)?this:".priority"===xa(e)?this.priorityNode_:cc.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:cc.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=xa(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(U(".priority"!==n||1===Pa(e),".priority must be the last token in a path"),this.updateImmediateChild(n,cc.__childrenNodeConstructor.EMPTY_NODE.updateChild(Oa(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+rc(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?Jo(this.value_):this.value_,this.lazyHash_=Ro(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===cc.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof cc.__childrenNodeConstructor?-1:(U(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=cc.VALUE_TYPE_ORDER.indexOf(t),i=cc.VALUE_TYPE_ORDER.indexOf(n);return U(r>=0,"Unknown leaf type: "+t),U(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}cc.VALUE_TYPE_ORDER=["object","boolean","number","string"];const lc=new class extends Ka{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?Vo(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ha.MIN}maxPost(){return new Ha($o,new cc("[PRIORITY-POST]",ac))}makePost(e,t){const n=oc(e);return new Ha(t,new cc("[PRIORITY-POST]",n))}toString(){return".priority"}},uc=Math.log(2);class hc{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/uc,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const dc=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new Xa(a,o.node,Xa.BLACK,null,null);{const c=parseInt(s/2,10)+t,l=i(t,c),u=i(c+1,r);return o=e[c],a=n?n(o):o,new Xa(a,o.node,Xa.BLACK,l,u)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const l=i(s+1,a),u=e[s],h=n?n(u):u;c(new Xa(h,u.node,r,null,l))},c=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,Xa.BLACK):(a(r,Xa.BLACK),a(r,Xa.RED))}return s}(new hc(e.length));return new Za(r||t,s)};let pc;const fc={};class gc{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return U(fc&&lc,"ChildrenNode.ts has not been loaded"),pc=pc||new gc({".priority":fc},{".priority":lc}),pc}get(e){const t=de(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Za?t:null}hasIndex(e){return he(this.indexSet_,e.toString())}addIndex(e,t){U(e!==Ja,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(Ha.Wrap);let s,o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=i.getNext();s=r?dc(n,e.getCompare()):fc;const a=e.toString(),c=Object.assign({},this.indexSet_);c[a]=e;const l=Object.assign({},this.indexes_);return l[a]=s,new gc(l,c)}addToIndexes(e,t){const n=fe(this.indexes_,((n,r)=>{const i=de(this.indexSet_,r);if(U(i,"Missing index implementation for "+r),n===fc){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(Ha.Wrap);let s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),dc(n,i.getCompare())}return fc}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new Ha(e.name,r))),i.insert(e,e.node)}}));return new gc(n,this.indexSet_)}removeFromIndexes(e,t){const n=fe(this.indexes_,(n=>{if(n===fc)return n;{const r=t.get(e.name);return r?n.remove(new Ha(e.name,r)):n}}));return new gc(n,this.indexSet_)}}let mc;class vc{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&ic(this.priorityNode_),this.children_.isEmpty()&&U(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return mc||(mc=new vc(new Za(tc),null,gc.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||mc}updatePriority(e){return this.children_.isEmpty()?this:new vc(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?mc:t}}getChild(e){const t=xa(e);return null===t?this:this.getImmediateChild(t).getChild(Oa(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(U(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Ha(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?mc:this.priorityNode_;return new vc(r,s,i)}}updateChild(e,t){const n=xa(e);if(null===n)return t;{U(".priority"!==xa(e)||1===Pa(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(Oa(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(lc,((s,o)=>{t[s]=o.val(e),n++,i&&vc.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+rc(this.getPriority().val())+":"),this.forEachChild(lc,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":Ro(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new Ha(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Ha(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Ha(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Ha.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Ha.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===_c?-1:0}withIndex(e){if(e===Ja||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new vc(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Ja||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(lc),n=t.getIterator(lc);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===Ja?null:this.indexMap_.get(e.toString())}}vc.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const _c=new class extends vc{constructor(){super(new Za(tc),vc.EMPTY_NODE,gc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return vc.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Ha,{MIN:{value:new Ha(Bo,vc.EMPTY_NODE)},MAX:{value:new Ha($o,_c)}}),Ga.__EMPTY_NODE=vc.EMPTY_NODE,cc.__childrenNodeConstructor=vc,nc=_c,ac=_c;const yc=!0;function wc(e,t=null){if(null===e)return vc.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),U(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new cc(e,wc(t));if(e instanceof Array||!yc){let n=vc.EMPTY_NODE;return Go(e,((t,r)=>{if(he(e,t)&&"."!==t.substring(0,1)){const e=wc(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(wc(t))}{const n=[];let r=!1;if(Go(e,((e,t)=>{if("."!==e.substring(0,1)){const i=wc(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new Ha(e,i)))}})),0===n.length)return vc.EMPTY_NODE;const i=dc(n,ec,(e=>e.name),tc);if(r){const e=dc(n,lc.getCompare());return new vc(i,wc(t),new gc({".priority":e},{".priority":lc}))}return new vc(i,wc(t),gc.Default)}}!function(e){oc=e}(wc);class bc extends Ka{constructor(e){super(),this.indexPath_=e,U(!La(e)&&".priority"!==xa(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?Vo(e.name,t.name):i}makePost(e,t){const n=wc(e),r=vc.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ha(t,r)}maxPost(){const e=vc.EMPTY_NODE.updateChild(this.indexPath_,_c);return new Ha($o,e)}toString(){return Na(this.indexPath_,0).join("/")}}const Ic=new class extends Ka{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?Vo(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ha.MIN}maxPost(){return Ha.MAX}makePost(e,t){const n=wc(e);return new Ha(t,n)}toString(){return".value"}};function kc(e){return{type:"value",snapshotNode:e}}function Cc(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Sc(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Tc(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class Ec{constructor(e){this.index_=e}updateChild(e,t,n,r,i,s){U(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(Sc(t,o)):U(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(Cc(t,n)):s.trackChildChange(Tc(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(lc,((e,r)=>{t.hasChild(e)||n.trackChildChange(Sc(e,r))})),t.isLeafNode()||t.forEachChild(lc,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(Tc(t,r,i))}else n.trackChildChange(Cc(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?vc.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class xc{constructor(e){this.indexedFilter_=new Ec(e.getIndex()),this.index_=e.getIndex(),this.startPost_=xc.getStartPost_(e),this.endPost_=xc.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,i,s){return this.matches(new Ha(t,n))||(n=vc.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=vc.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(vc.EMPTY_NODE);const i=this;return t.forEachChild(lc,((e,t)=>{i.matches(new Ha(e,t))||(r=r.updateImmediateChild(e,vc.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Pc{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new xc(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new Ha(t,n))||(n=vc.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=vc.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=vc.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;r=r.updateImmediateChild(t.name,t.node),n++}}}else{let e;r=t.withIndex(this.index_),r=r.updatePriority(vc.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:r=r.updateImmediateChild(t.name,vc.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const o=e;U(o.numChildren()===this.limit_,"");const a=new Ha(t,n),c=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),l=this.rangedFilter_.matches(a);if(o.hasChild(t)){const e=o.getImmediateChild(t);let u=r.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=u&&(u.name===t||o.hasChild(u.name));)u=r.getChildAfterChild(this.index_,u,this.reverse_);const h=null==u?1:s(u,a);if(l&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(Tc(t,n,e)),o.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(Sc(t,e));const n=o.updateImmediateChild(t,vc.EMPTY_NODE);return null!=u&&this.rangedFilter_.matches(u)?(null!=i&&i.trackChildChange(Cc(u.name,u.node)),n.updateImmediateChild(u.name,u.node)):n}}return n.isEmpty()?e:l&&s(c,a)>=0?(null!=i&&(i.trackChildChange(Sc(c.name,c.node)),i.trackChildChange(Cc(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(c.name,vc.EMPTY_NODE)):e}}class Oc{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=lc}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return U(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return U(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Bo}hasEnd(){return this.endSet_}getIndexEndValue(){return U(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return U(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:$o}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return U(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===lc}copy(){const e=new Oc;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Rc(e,t,n){const r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Nc(e,t,n){const r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Ac(e,t){const n=e.copy();return n.index_=t,n}function Dc(e){const t={};if(e.isDefault())return t;let n;if(e.index_===lc?n="$priority":e.index_===Ic?n="$value":e.index_===Ja?n="$key":(U(e.index_ instanceof bc,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=le(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=le(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+le(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=le(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+le(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Lc(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==lc&&(t.i=e.index_.toString()),t}class Mc extends ka{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=jo("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(U(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=Mc.getListenId_(e,n),o={};this.listens_[s]=o;const a=Dc(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),de(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=Mc.getListenId_(e,t);delete this.listens_[n]}get(e){const t=Dc(e._queryParams),n=e._path.toString(),r=new Q;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ve(t);this.log_("Sending REST request for "+s);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=ce(o.responseText)}catch(e){qo("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&qo("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()}))}}class jc{constructor(){this.rootNode_=vc.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function Fc(){return{value:null,children:new Map}}function Uc(e,t,n){if(La(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=xa(t);e.children.has(r)||e.children.set(r,Fc()),Uc(e.children.get(r),t=Oa(t),n)}}function qc(e,t){if(La(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;{const n=e.value;return e.value=null,n.forEachChild(lc,((t,n)=>{Uc(e,new Ta(t),n)})),qc(e,t)}}if(e.children.size>0){const n=xa(t);return t=Oa(t),e.children.has(n)&&qc(e.children.get(n),t)&&e.children.delete(n),0===e.children.size}return!0}function Wc(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{Wc(r,new Ta(t.toString()+"/"+e),n)}))}class Bc{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Go(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class $c{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Bc(e);const n=1e4+2e4*Math.random();ea(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;Go(e,((e,r)=>{r>0&&he(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),ea(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Vc,zc;function Hc(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}(zc=Vc||(Vc={}))[zc.OVERWRITE=0]="OVERWRITE",zc[zc.MERGE=1]="MERGE",zc[zc.ACK_USER_WRITE=2]="ACK_USER_WRITE",zc[zc.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";class Kc{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Vc.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(La(this.path)){if(null!=this.affectedTree.value)return U(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Ta(e));return new Kc(Ea(),t,this.revert)}}return U(xa(this.path)===e,"operationForChild called for unrelated child."),new Kc(Oa(this.path),this.affectedTree,this.revert)}}class Yc{constructor(e,t){this.source=e,this.path=t,this.type=Vc.LISTEN_COMPLETE}operationForChild(e){return La(this.path)?new Yc(this.source,Ea()):new Yc(this.source,Oa(this.path))}}class Gc{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Vc.OVERWRITE}operationForChild(e){return La(this.path)?new Gc(this.source,Ea(),this.snap.getImmediateChild(e)):new Gc(this.source,Oa(this.path),this.snap)}}class Jc{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Vc.MERGE}operationForChild(e){if(La(this.path)){const t=this.children.subtree(new Ta(e));return t.isEmpty()?null:t.value?new Gc(this.source,Ea(),t.value):new Jc(this.source,Ea(),t)}return U(xa(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Jc(this.source,Oa(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Qc{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(La(e))return this.isFullyInitialized()&&!this.filtered_;const t=xa(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Xc{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Zc(e,t,n,r,i,s){const o=r.filter((e=>e.type===n));o.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw q("Should only compare child_ events.");const r=new Ha(t.childName,t.snapshotNode),i=new Ha(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n))),o.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function el(e,t){return{eventCache:e,serverCache:t}}function tl(e,t,n,r){return el(new Qc(t,n,r),e.serverCache)}function nl(e,t,n,r){return el(e.eventCache,new Qc(t,n,r))}function rl(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function il(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let sl;class ol{constructor(e,t=(()=>(sl||(sl=new Za(zo)),sl))()){this.value=e,this.children=t}static fromObject(e){let t=new ol(null);return Go(e,((e,n)=>{t=t.set(new Ta(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Ea(),value:this.value};if(La(e))return null;{const n=xa(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(Oa(e),t);return null!=i?{path:Da(new Ta(n),i.path),value:i.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(La(e))return this;{const t=xa(e),n=this.children.get(t);return null!==n?n.subtree(Oa(e)):new ol(null)}}set(e,t){if(La(e))return new ol(t,this.children);{const n=xa(e),r=(this.children.get(n)||new ol(null)).set(Oa(e),t),i=this.children.insert(n,r);return new ol(this.value,i)}}remove(e){if(La(e))return this.children.isEmpty()?new ol(null):new ol(null,this.children);{const t=xa(e),n=this.children.get(t);if(n){const r=n.remove(Oa(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new ol(null):new ol(this.value,i)}return this}}get(e){if(La(e))return this.value;{const t=xa(e),n=this.children.get(t);return n?n.get(Oa(e)):null}}setTree(e,t){if(La(e))return t;{const n=xa(e),r=(this.children.get(n)||new ol(null)).setTree(Oa(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new ol(this.value,i)}}fold(e){return this.fold_(Ea(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(Da(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,Ea(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(La(e))return null;{const r=xa(e),i=this.children.get(r);return i?i.findOnPath_(Oa(e),Da(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ea(),t)}foreachOnPath_(e,t,n){if(La(e))return this;{this.value&&n(t,this.value);const r=xa(e),i=this.children.get(r);return i?i.foreachOnPath_(Oa(e),Da(t,r),n):new ol(null)}}foreach(e){this.foreach_(Ea(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(Da(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class al{constructor(e){this.writeTree_=e}static empty(){return new al(new ol(null))}}function cl(e,t,n){if(La(t))return new al(new ol(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=Ma(i,t);return s=s.updateChild(o,n),new al(e.writeTree_.set(i,s))}{const r=new ol(n),i=e.writeTree_.setTree(t,r);return new al(i)}}}function ll(e,t,n){let r=e;return Go(n,((e,n)=>{r=cl(r,Da(t,e),n)})),r}function ul(e,t){if(La(t))return al.empty();{const n=e.writeTree_.setTree(t,new ol(null));return new al(n)}}function hl(e,t){return null!=dl(e,t)}function dl(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Ma(n.path,t)):null}function pl(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(lc,((e,n)=>{t.push(new Ha(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Ha(e,n.value))})),t}function fl(e,t){if(La(t))return e;{const n=dl(e,t);return new al(null!=n?new ol(n):e.writeTree_.subtree(t))}}function gl(e){return e.writeTree_.isEmpty()}function ml(e,t){return vl(Ea(),e.writeTree_,t)}function vl(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?(U(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=vl(Da(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Da(e,".priority"),r)),n}}function _l(e,t){return Pl(t,e)}function yl(e,t){if(e.snap)return Ua(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Ua(Da(e.path,n),t))return!0;return!1}function wl(e){return e.visible}function bl(e,t,n){let r=al.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)Ua(n,e)?(t=Ma(n,e),r=cl(r,t,s.snap)):Ua(e,n)&&(t=Ma(e,n),r=cl(r,Ea(),s.snap.getChild(t)));else{if(!s.children)throw q("WriteRecord should have .snap or .children");if(Ua(n,e))t=Ma(n,e),r=ll(r,t,s.children);else if(Ua(e,n))if(t=Ma(e,n),La(t))r=ll(r,Ea(),s.children);else{const e=de(s.children,xa(t));if(e){const n=e.getChild(Oa(t));r=cl(r,Ea(),n)}}}}}return r}function Il(e,t,n,r,i){if(r||i){const s=fl(e.visibleWrites,t);if(!i&&gl(s))return n;if(i||null!=n||hl(s,Ea())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Ua(e.path,t)||Ua(t,e.path))};return ml(bl(e.allWrites,s,t),n||vc.EMPTY_NODE)}return null}{const r=dl(e.visibleWrites,t);if(null!=r)return r;{const r=fl(e.visibleWrites,t);return gl(r)?n:null!=n||hl(r,Ea())?ml(r,n||vc.EMPTY_NODE):null}}}function kl(e,t,n,r){return Il(e.writeTree,e.treePath,t,n,r)}function Cl(e,t){return function(e,t,n){let r=vc.EMPTY_NODE;const i=dl(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(lc,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=fl(e.visibleWrites,t);return n.forEachChild(lc,((e,t)=>{const n=ml(fl(i,new Ta(e)),t);r=r.updateImmediateChild(e,n)})),pl(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return pl(fl(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function Sl(e,t,n,r){return function(e,t,n,r,i){U(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Da(t,n);if(hl(e.visibleWrites,s))return null;{const t=fl(e.visibleWrites,s);return gl(t)?i.getChild(n):ml(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function Tl(e,t){return function(e,t){return dl(e.visibleWrites,t)}(e.writeTree,Da(e.treePath,t))}function El(e,t,n){return function(e,t,n,r){const i=Da(t,n),s=dl(e.visibleWrites,i);return null!=s?s:r.isCompleteForChild(n)?ml(fl(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function xl(e,t){return Pl(Da(e.treePath,t),e.writeTree)}function Pl(e,t){return{treePath:e,writeTree:t}}class Ol{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;U("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),U(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,Tc(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,Sc(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,Cc(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw q("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,Tc(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const Rl=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class Nl{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Qc(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return El(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:il(this.viewCache_),i=function(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const c=fl(e.visibleWrites,t),l=dl(c,Ea());if(null!=l)a=l;else{if(null==n)return[];a=ml(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let c=n.getNext();for(;c&&e.length<i;)0!==t(c,r)&&e.push(c),c=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function Al(e,t,n,r,i,s){const o=t.eventCache;if(null!=Tl(r,n))return t;{let a,c;if(La(n))if(U(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=il(t),i=Cl(r,n instanceof vc?n:vc.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{const n=kl(r,il(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const l=xa(n);if(".priority"===l){U(1===Pa(n),"Can't have a priority with additional path components");const i=o.getNode();c=t.serverCache.getNode();const s=Sl(r,n,i,c);a=null!=s?e.filter.updatePriority(i,s):o.getNode()}else{const u=Oa(n);let h;if(o.isCompleteForChild(l)){c=t.serverCache.getNode();const e=Sl(r,n,o.getNode(),c);h=null!=e?o.getNode().getImmediateChild(l).updateChild(u,e):o.getNode().getImmediateChild(l)}else h=El(r,l,t.serverCache);a=null!=h?e.filter.updateChild(o.getNode(),l,h,u,i,s):o.getNode()}}return tl(t,a,o.isFullyInitialized()||La(n),e.filter.filtersNodes())}}function Dl(e,t,n,r,i,s,o,a){const c=t.serverCache;let l;const u=o?e.filter:e.filter.getIndexedFilter();if(La(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),e,null)}else{const e=xa(n);if(!c.isCompleteForPath(n)&&Pa(n)>1)return t;const i=Oa(n),s=c.getNode().getImmediateChild(e).updateChild(i,r);l=".priority"===e?u.updatePriority(c.getNode(),s):u.updateChild(c.getNode(),e,s,i,Rl,null)}const h=nl(t,l,c.isFullyInitialized()||La(n),u.filtersNodes());return Al(e,h,n,i,new Nl(i,h,s),a)}function Ll(e,t,n,r,i,s,o){const a=t.eventCache;let c,l;const u=new Nl(i,t,s);if(La(n))l=e.filter.updateFullNode(t.eventCache.getNode(),r,o),c=tl(t,l,!0,e.filter.filtersNodes());else{const i=xa(n);if(".priority"===i)l=e.filter.updatePriority(t.eventCache.getNode(),r),c=tl(t,l,a.isFullyInitialized(),a.isFiltered());else{const s=Oa(n),l=a.getNode().getImmediateChild(i);let h;if(La(s))h=r;else{const e=u.getCompleteChild(i);h=null!=e?".priority"===Ra(s)&&e.getChild(Aa(s)).isEmpty()?e:e.updateChild(s,r):vc.EMPTY_NODE}c=l.equals(h)?t:tl(t,e.filter.updateChild(a.getNode(),i,h,s,u,o),a.isFullyInitialized(),e.filter.filtersNodes())}}return c}function Ml(e,t){return e.eventCache.isCompleteForChild(t)}function jl(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function Fl(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,l=t;c=La(n)?r:new ol(null).setTree(n,r);const u=t.serverCache.getNode();return c.children.inorderTraversal(((n,r)=>{if(u.hasChild(n)){const c=jl(0,t.serverCache.getNode().getImmediateChild(n),r);l=Dl(e,l,new Ta(n),c,i,s,o,a)}})),c.children.inorderTraversal(((n,r)=>{const c=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!u.hasChild(n)&&!c){const c=jl(0,t.serverCache.getNode().getImmediateChild(n),r);l=Dl(e,l,new Ta(n),c,i,s,o,a)}})),l}class Ul{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new Ec(n.getIndex()),i=(s=n).loadsAllData()?new Ec(s.getIndex()):s.hasLimit()?new Pc(s):new xc(s);var s;this.processor_=function(e){return{filter:e}}(i);const o=t.serverCache,a=t.eventCache,c=r.updateFullNode(vc.EMPTY_NODE,o.getNode(),null),l=i.updateFullNode(vc.EMPTY_NODE,a.getNode(),null),u=new Qc(c,o.isFullyInitialized(),r.filtersNodes()),h=new Qc(l,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=el(h,u),this.eventGenerator_=new Xc(this.query_)}get query(){return this.query_}}function ql(e,t){const n=il(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!La(t)&&!n.getImmediateChild(xa(t)).isEmpty())?n.getChild(t):null}function Wl(e){return 0===e.eventRegistrations_.length}function Bl(e,t,n){const r=[];if(n){U(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function $l(e,t,n,r){t.type===Vc.MERGE&&null!==t.source.queryId&&(U(il(e.viewCache_),"We should always have a full cache before handling merges"),U(rl(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=function(e,t,n,r,i){const s=new Ol;let o,a;if(n.type===Vc.OVERWRITE){const c=n;c.source.fromUser?o=Ll(e,t,c.path,c.snap,r,i,s):(U(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered()&&!La(c.path),o=Dl(e,t,c.path,c.snap,r,i,a,s))}else if(n.type===Vc.MERGE){const c=n;c.source.fromUser?o=function(e,t,n,r,i,s,o){let a=t;return r.foreach(((r,c)=>{const l=Da(n,r);Ml(t,xa(l))&&(a=Ll(e,a,l,c,i,s,o))})),r.foreach(((r,c)=>{const l=Da(n,r);Ml(t,xa(l))||(a=Ll(e,a,l,c,i,s,o))})),a}(e,t,c.path,c.children,r,i,s):(U(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),o=Fl(e,t,c.path,c.children,r,i,a,s))}else if(n.type===Vc.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,r,i,s){let o;if(null!=Tl(r,n))return t;{const a=new Nl(r,t,i),c=t.eventCache.getNode();let l;if(La(n)||".priority"===xa(n)){let n;if(t.serverCache.isFullyInitialized())n=kl(r,il(t));else{const e=t.serverCache.getNode();U(e instanceof vc,"serverChildren would be complete if leaf node"),n=Cl(r,e)}l=e.filter.updateFullNode(c,n,s)}else{const i=xa(n);let u=El(r,i,t.serverCache);null==u&&t.serverCache.isCompleteForChild(i)&&(u=c.getImmediateChild(i)),l=null!=u?e.filter.updateChild(c,i,u,Oa(n),a,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(c,i,vc.EMPTY_NODE,Oa(n),a,s):c,l.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=kl(r,il(t)),o.isLeafNode()&&(l=e.filter.updateFullNode(l,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=Tl(r,Ea()),tl(t,l,o,e.filter.filtersNodes())}}(e,t,a.path,r,i,s):function(e,t,n,r,i,s,o){if(null!=Tl(i,n))return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(La(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Dl(e,t,n,c.getNode().getChild(n),i,s,a,o);if(La(n)){let r=new ol(null);return c.getNode().forEachChild(Ja,((e,t)=>{r=r.set(new Ta(e),t)})),Fl(e,t,n,r,i,s,a,o)}return t}{let l=new ol(null);return r.foreach(((e,t)=>{const r=Da(n,e);c.isCompleteForPath(r)&&(l=l.set(e,c.getNode().getChild(r)))})),Fl(e,t,n,l,i,s,a,o)}}(e,t,a.path,a.affectedTree,r,i,s)}else{if(n.type!==Vc.LISTEN_COMPLETE)throw q("Unknown operation type: "+n.type);o=function(e,t,n,r,i){const s=t.serverCache;return Al(e,nl(t,s.getNode(),s.isFullyInitialized()||La(n),s.isFiltered()),n,r,Rl,i)}(e,t,n.path,r,s)}const c=s.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=rl(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(kc(rl(t)))}}(t,o,c),{viewCache:o,changes:c}}(e.processor_,i,t,n,r);var o,a;return o=e.processor_,a=s.viewCache,U(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),U(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),U(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,Vl(e,s.changes,s.viewCache.eventCache.getNode(),null)}function Vl(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Zc(e,i,"child_removed",t,r,n),Zc(e,i,"child_added",t,r,n),Zc(e,i,"child_moved",s,r,n),Zc(e,i,"child_changed",t,r,n),Zc(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}let zl,Hl;class Kl{constructor(){this.views=new Map}}function Yl(e,t,n,r){const i=t.source.queryId;if(null!==i){const s=e.views.get(i);return U(null!=s,"SyncTree gave us an op for an invalid query."),$l(s,t,n,r)}{let i=[];for(const s of e.views.values())i=i.concat($l(s,t,n,r));return i}}function Gl(e,t,n,r,i){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=kl(n,i?r:null),s=!1;e?s=!0:r instanceof vc?(e=Cl(n,r),s=!1):(e=vc.EMPTY_NODE,s=!1);const o=el(new Qc(e,s,!1),new Qc(r,i,!1));return new Ul(t,o)}return o}function Jl(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function Ql(e,t){let n=null;for(const r of e.views.values())n=n||ql(r,t);return n}function Xl(e,t){if(t._queryParams.loadsAllData())return tu(e);{const n=t._queryIdentifier;return e.views.get(n)}}function Zl(e,t){return null!=Xl(e,t)}function eu(e){return null!=tu(e)}function tu(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let nu=1;class ru{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ol(null),this.pendingWriteTree_={visibleWrites:al.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function iu(e,t,n,r,i){return function(e,t,n,r,i){U(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=cl(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?hu(e,new Gc({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function su(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));U(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&yl(t,r.path)?i=!1:Ua(r.path,t.path)&&(s=!0)),o--}return!!i&&(s?(function(e){e.visibleWrites=bl(e.allWrites,wl,Ea()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0):(r.snap?e.visibleWrites=ul(e.visibleWrites,r.path):Go(r.children,(t=>{e.visibleWrites=ul(e.visibleWrites,Da(r.path,t))})),!0))}(e.pendingWriteTree_,t)){let t=new ol(null);return null!=r.snap?t=t.set(Ea(),!0):Go(r.children,(e=>{t=t.set(new Ta(e),!0)})),hu(e,new Kc(r.path,t,n))}return[]}function ou(e,t,n){return hu(e,new Gc({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function au(e,t,n,r,i=!1){const s=t._path,o=e.syncPointTree_.get(s);let a=[];if(o&&("default"===t._queryIdentifier||Zl(o,t))){const c=function(e,t,n,r){const i=t._queryIdentifier,s=[];let o=[];const a=eu(e);if("default"===i)for(const[t,i]of e.views.entries())o=o.concat(Bl(i,n,r)),Wl(i)&&(e.views.delete(t),i.query._queryParams.loadsAllData()||s.push(i.query));else{const t=e.views.get(i);t&&(o=o.concat(Bl(t,n,r)),Wl(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||s.push(t.query)))}return a&&!eu(e)&&s.push(new(U(zl,"Reference.ts has not been loaded"),zl)(t._repo,t._path)),{removed:s,events:o}}(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));const l=c.removed;if(a=c.events,!i){const n=-1!==l.findIndex((e=>e._queryParams.loadsAllData())),i=e.syncPointTree_.findOnPath(s,((e,t)=>eu(t)));if(n&&!i){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&eu(t))return[tu(t)];{let e=[];return t&&(e=Jl(t)),Go(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,s=fu(e,r);e.listenProvider_.startListening(wu(i),gu(e,i),s.hashFn,s.onComplete)}}}if(!i&&l.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(wu(t),n)}else l.forEach((t=>{const n=e.queryToTagMap.get(mu(t));e.listenProvider_.stopListening(wu(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=mu(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,l)}return a}function cu(e,t,n,r){const i=vu(e,r);if(null!=i){const r=_u(i),s=r.path,o=r.queryId,a=Ma(s,t);return yu(e,s,new Gc(Hc(o),a,n))}return[]}function lu(e,t,n,r=!1){const i=t._path;let s=null,o=!1;e.syncPointTree_.foreachOnPath(i,((e,t)=>{const n=Ma(e,i);s=s||Ql(t,n),o=o||eu(t)}));let a,c=e.syncPointTree_.get(i);c?(o=o||eu(c),s=s||Ql(c,Ea())):(c=new Kl,e.syncPointTree_=e.syncPointTree_.set(i,c)),null!=s?a=!0:(a=!1,s=vc.EMPTY_NODE,e.syncPointTree_.subtree(i).foreachChild(((e,t)=>{const n=Ql(t,Ea());n&&(s=s.updateImmediateChild(e,n))})));const l=Zl(c,t);if(!l&&!t._queryParams.loadsAllData()){const n=mu(t);U(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=nu++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let u=function(e,t,n,r,i,s){const o=Gl(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(lc,((e,t)=>{r.push(Cc(e,t))})),n.isFullyInitialized()&&r.push(kc(n.getNode())),Vl(e,r,n.getNode(),t)}(o,n)}(c,t,n,_l(e.pendingWriteTree_,i),s,a);if(!l&&!o&&!r){const n=Xl(c,t);u=u.concat(function(e,t,n){const r=t._path,i=gu(e,t),s=fu(e,n),o=e.listenProvider_.startListening(wu(t),i,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(r);if(i)U(!eu(a.value),"If we're adding a query, it shouldn't be shadowed");else{const t=a.fold(((e,t,n)=>{if(!La(e)&&t&&eu(t))return[tu(t).query];{let e=[];return t&&(e=e.concat(Jl(t).map((e=>e.query)))),Go(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(wu(r),gu(e,r))}}return o}(e,t,n))}return u}function uu(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=Ql(n,Ma(e,t));if(r)return r}));return Il(r,t,i,n,!0)}function hu(e,t){return du(t,e.syncPointTree_,null,_l(e.pendingWriteTree_,Ea()))}function du(e,t,n,r){if(La(e.path))return pu(e,t,n,r);{const i=t.get(Ea());null==n&&null!=i&&(n=Ql(i,Ea()));let s=[];const o=xa(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const e=n?n.getImmediateChild(o):null,t=xl(r,o);s=s.concat(du(a,c,e,t))}return i&&(s=s.concat(Yl(i,e,r,n))),s}}function pu(e,t,n,r){const i=t.get(Ea());null==n&&null!=i&&(n=Ql(i,Ea()));let s=[];return t.children.inorderTraversal(((t,i)=>{const o=n?n.getImmediateChild(t):null,a=xl(r,t),c=e.operationForChild(t);c&&(s=s.concat(pu(c,i,o,a)))})),i&&(s=s.concat(Yl(i,e,r,n))),s}function fu(e,t){const n=t.query,r=gu(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||vc.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=vu(e,n);if(r){const n=_u(r),i=n.path,s=n.queryId,o=Ma(i,t);return yu(e,i,new Yc(Hc(s),o))}return[]}(e,n._path,r):function(e,t){return hu(e,new Yc({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return au(e,n,null,r)}}}}function gu(e,t){const n=mu(t);return e.queryToTagMap.get(n)}function mu(e){return e._path.toString()+"$"+e._queryIdentifier}function vu(e,t){return e.tagToQueryMap.get(t)}function _u(e){const t=e.indexOf("$");return U(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Ta(e.substr(0,t))}}function yu(e,t,n){const r=e.syncPointTree_.get(t);return U(r,"Missing sync point for query tag that we're tracking"),Yl(r,n,_l(e.pendingWriteTree_,t),null)}function wu(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(U(Hl,"Reference.ts has not been loaded"),Hl)(e._repo,e._path):e}class bu{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new bu(t)}node(){return this.node_}}class Iu{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Da(this.path_,e);return new Iu(this.syncTree_,t)}node(){return uu(this.syncTree_,this.path_)}}const ku=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},Cu=function(e,t,n){return e&&"object"==typeof e?(U(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Su(e[".sv"],t,n):"object"==typeof e[".sv"]?Tu(e[".sv"],t):void U(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Su=function(e,t,n){if("timestamp"===e)return n.timestamp;U(!1,"Unexpected server value: "+e)},Tu=function(e,t,n){e.hasOwnProperty("increment")||U(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&U(!1,"Unexpected increment value: "+r);const i=t.node();if(U(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i.getValue();return"number"!=typeof s?r:s+r},Eu=function(e,t,n,r){return Pu(t,new Iu(n,e),r)},xu=function(e,t,n){return Pu(e,new bu(t),n)};function Pu(e,t,n){const r=e.getPriority().val(),i=Cu(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=Cu(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new cc(s,wc(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new cc(i))),r.forEachChild(lc,((e,r)=>{const i=Pu(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}}class Ou{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function Ru(e,t){let n=t instanceof Ta?t:new Ta(t),r=e,i=xa(n);for(;null!==i;){const e=de(r.node.children,i)||{children:{},childCount:0};r=new Ou(i,r,e),n=Oa(n),i=xa(n)}return r}function Nu(e){return e.node.value}function Au(e,t){e.node.value=t,Fu(e)}function Du(e){return e.node.childCount>0}function Lu(e,t){Go(e.node.children,((n,r)=>{t(new Ou(n,e,r))}))}function Mu(e,t,n,r){n&&!r&&t(e),Lu(e,(e=>{Mu(e,t,!0,r)})),n&&r&&t(e)}function ju(e){return new Ta(null===e.parent?e.name:ju(e.parent)+"/"+e.name)}function Fu(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===Nu(e)&&!Du(e)}(n),i=he(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Fu(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,Fu(e))}(e.parent,e.name,e)}const Uu=/[\[\].#$\/\u0000-\u001F\u007F]/,qu=/[\[\].#$\u0000-\u001F\u007F]/,Wu=10485760,Bu=function(e){return"string"==typeof e&&0!==e.length&&!Uu.test(e)},$u=function(e){return"string"==typeof e&&0!==e.length&&!qu.test(e)},Vu=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!Wo(e)||e&&"object"==typeof e&&he(e,".sv")},zu=function(e,t,n,r){r&&void 0===t||Hu(Se(e,"value"),t,n)},Hu=function(e,t,n){const r=n instanceof Ta?new qa(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Ba(r));if("function"==typeof t)throw new Error(e+"contains a function "+Ba(r)+" with contents = "+t.toString());if(Wo(t))throw new Error(e+"contains "+t.toString()+" "+Ba(r));if("string"==typeof t&&t.length>Wu/3&&xe(t)>Wu)throw new Error(e+"contains a string greater than "+Wu+" utf8 bytes "+Ba(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(Go(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!Bu(t)))throw new Error(e+" contains an invalid key ("+t+") "+Ba(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=xe(t),Wa(e)}(r,t),Hu(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=xe(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+Ba(r)+" in addition to actual children.")}},Ku=function(e,t,n,r){if(r&&void 0===t)return;const i=Se(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];Go(t,((e,t)=>{const r=new Ta(e);if(Hu(i,t,Da(n,r)),".priority"===Ra(r)&&!Vu(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(r)})),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const i=Na(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!Bu(i[t]))throw new Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(ja);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&Ua(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},Yu=function(e,t,n){if(!n||void 0!==t){if(Wo(t))throw new Error(Se(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Vu(t))throw new Error(Se(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Gu=function(e,t,n,r){if(!(r&&void 0===n||Bu(n)))throw new Error(Se(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Ju=function(e,t,n,r){if(!(r&&void 0===n||$u(n)))throw new Error(Se(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Qu=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Ju(e,t,n,r)},Xu=function(e,t){if(".info"===xa(t))throw new Error(e+" failed = Can't modify data under /.info/")},Zu=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Bu(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),$u(e)}(n))throw new Error(Se(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class eh{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function th(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||Fa(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function nh(e,t,n){th(e,n),ih(e,(e=>Fa(e,t)))}function rh(e,t,n){th(e,n),ih(e,(e=>Ua(e,t)||Ua(t,e)))}function ih(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];i&&(t(i.path)?(sh(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}function sh(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();Ao&&Mo("event: "+n.toString()),Zo(r)}}}const oh="repo_interrupt",ah=25;class ch{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new eh,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Fc(),this.transactionQueueTree_=new Ou,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function lh(e,t,n){if(e.stats_=fa(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Mc(e.repoInfo_,((t,n,r,i)=>{dh(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>ph(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{le(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new za(e.repoInfo_,t,((t,n,r,i)=>{dh(e,t,n,r,i)}),(t=>{ph(e,t)}),(t=>{!function(e,t){Go(t,((t,n)=>{fh(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(t,n){const r=t.toString();return pa[r]||(pa[r]=new $c(e.stats_,e.server_)),pa[r]}(e.repoInfo_),e.infoData_=new jc,e.infoSyncTree_=new ru({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=ou(e.infoSyncTree_,t._path,o),setTimeout((()=>{i("ok")}),0)),s},stopListening:()=>{}}),fh(e,"connected",!1),e.serverSyncTree_=new ru({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const s=i(n,r);rh(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function uh(e){const t=e.infoData_.getNode(new Ta(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function hh(e){return ku({timestamp:uh(e)})}function dh(e,t,n,r,i){e.dataUpdateCount++;const s=new Ta(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=fe(n,(e=>wc(e)));o=function(e,t,n,r){const i=vu(e,r);if(i){const r=_u(i),s=r.path,o=r.queryId,a=Ma(s,t),c=ol.fromObject(n);return yu(e,s,new Jc(Hc(o),a,c))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=wc(n);o=cu(e.serverSyncTree_,s,t,i)}else if(r){const t=fe(n,(e=>wc(e)));o=function(e,t,n){const r=ol.fromObject(n);return hu(e,new Jc({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=wc(n);o=ou(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=Sh(e,s)),rh(e.eventQueue_,a,o)}function ph(e,t){fh(e,"connected",t),!1===t&&function(e){bh(e,"onDisconnectEvents");const t=hh(e),n=Fc();Wc(e.onDisconnect_,Ea(),((r,i)=>{const s=Eu(r,i,e.serverSyncTree_,t);Uc(n,r,s)}));let r=[];Wc(n,Ea(),((t,n)=>{r=r.concat(ou(e.serverSyncTree_,t,n));const i=Oh(e,t);Sh(e,i)})),e.onDisconnect_=Fc(),rh(e.eventQueue_,Ea(),r)}(e)}function fh(e,t,n){const r=new Ta("/.info/"+t),i=wc(n);e.infoData_.updateSnapshot(r,i);const s=ou(e.infoSyncTree_,r,i);rh(e.eventQueue_,r,s)}function gh(e){return e.nextWriteId_++}function mh(e,t,n,r,i){bh(e,"set",{path:t.toString(),value:n,priority:r});const s=hh(e),o=wc(n,r),a=uu(e.serverSyncTree_,t),c=xu(o,a,s),l=gh(e),u=iu(e.serverSyncTree_,t,c,l,!0);th(e.eventQueue_,u),e.server_.put(t.toString(),o.val(!0),((n,r)=>{const s="ok"===n;s||qo("set at "+t+" failed: "+n);const o=su(e.serverSyncTree_,l,!s);rh(e.eventQueue_,t,o),Ih(0,i,n,r)}));const h=Oh(e,t);Sh(e,h),rh(e.eventQueue_,h,[])}function vh(e,t,n){e.server_.onDisconnectCancel(t.toString(),((r,i)=>{"ok"===r&&qc(e.onDisconnect_,t),Ih(0,n,r,i)}))}function _h(e,t,n,r){const i=wc(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),((n,s)=>{"ok"===n&&Uc(e.onDisconnect_,t,i),Ih(0,r,n,s)}))}function yh(e,t,n){let r;r=".info"===xa(t._path)?au(e.infoSyncTree_,t,n):au(e.serverSyncTree_,t,n),nh(e.eventQueue_,t._path,r)}function wh(e){e.persistentConnection_&&e.persistentConnection_.interrupt(oh)}function bh(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Mo(n,...t)}function Ih(e,t,n,r){t&&Zo((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const s=new Error(i);s.code=e,t(s)}}))}function kh(e,t,n){return uu(e.serverSyncTree_,t,n)||vc.EMPTY_NODE}function Ch(e,t=e.transactionQueueTree_){if(t||Ph(e,t),Nu(t)){const n=Eh(e,t);U(n.length>0,"Sending zero length transaction queue"),n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=kh(e,t,r);let s=i;const o=i.hash();for(let e=0;e<n.length;e++){const r=n[e];U(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=Ma(t,r.path);s=s.updateChild(i,r.currentOutputSnapshotRaw)}const a=s.val(!0),c=t;e.server_.put(c.toString(),a,(r=>{bh(e,"transaction put response",{path:c.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(su(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();Ph(e,Ru(e.transactionQueueTree_,t)),Ch(e,e.transactionQueueTree_),rh(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)Zo(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{qo("transaction at "+c.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}Sh(e,t)}}),o)}(e,ju(t),n)}else Du(t)&&Lu(t,(t=>{Ch(e,t)}))}function Sh(e,t){const n=Th(e,t),r=ju(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const s=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let a=0;a<t.length;a++){const c=t[a],l=Ma(n,c.path);let u,h=!1;if(U(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,u=c.abortReason,i=i.concat(su(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=ah)h=!0,u="maxretry",i=i.concat(su(e.serverSyncTree_,c.currentWriteId,!0));else{const n=kh(e,c.path,s);c.currentInputSnapshot=n;const r=t[a].update(n.val());if(void 0!==r){Hu("transaction failed: Data returned ",r,c.path);let t=wc(r);"object"==typeof r&&null!=r&&he(r,".priority")||(t=t.updatePriority(n.getPriority()));const o=c.currentWriteId,a=hh(e),l=xu(t,n,a);c.currentOutputSnapshotRaw=t,c.currentOutputSnapshotResolved=l,c.currentWriteId=gh(e),s.splice(s.indexOf(o),1),i=i.concat(iu(e.serverSyncTree_,c.path,l,c.currentWriteId,c.applyLocally)),i=i.concat(su(e.serverSyncTree_,o,!0))}else h=!0,u="nodata",i=i.concat(su(e.serverSyncTree_,c.currentWriteId,!0))}rh(e.eventQueue_,n,i),i=[],h&&(t[a].status=2,o=t[a].unwatcher,setTimeout(o,Math.floor(0)),t[a].onComplete&&("nodata"===u?r.push((()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot))):r.push((()=>t[a].onComplete(new Error(u),!1,null)))))}var o;Ph(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)Zo(r[e]);Ch(e,e.transactionQueueTree_)}(e,Eh(e,n),r),r}function Th(e,t){let n,r=e.transactionQueueTree_;for(n=xa(t);null!==n&&void 0===Nu(r);)r=Ru(r,n),n=xa(t=Oa(t));return r}function Eh(e,t){const n=[];return xh(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function xh(e,t,n){const r=Nu(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);Lu(t,(t=>{xh(e,t,n)}))}function Ph(e,t){const n=Nu(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,Au(t,n.length>0?n:void 0)}Lu(t,(t=>{Ph(e,t)}))}function Oh(e,t){const n=ju(Th(e,t)),r=Ru(e.transactionQueueTree_,t);return function(e,t,n){let r=e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{Rh(e,t)})),Rh(e,r),Mu(r,(t=>{Rh(e,t)})),n}function Rh(e,t){const n=Nu(t);if(n){const r=[];let i=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(U(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(U(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(su(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?Au(t,void 0):n.length=s+1,rh(e.eventQueue_,ju(t),i);for(let e=0;e<r.length;e++)Zo(r[e])}}const Nh=function(e,t){const n=Ah(e),r=n.namespace;"firebase.com"===n.domain&&Uo(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Uo("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&qo("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new la(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new Ta(n.pathString)}},Ah=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",c=443;if("string"==typeof e){let l=e.indexOf("//");l>=0&&(a=e.substring(0,l-1),e=e.substring(l+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):qo(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));l=t.indexOf(":"),l>=0?(o="https"===a||"wss"===a,c=parseInt(t.substring(l+1),10)):l=t.length;const p=t.slice(0,l);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},Dh="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Lh=function(){let e=0;const t=[];return function(n){const r=n===e;let i;e=n;const s=new Array(8);for(i=7;i>=0;i--)s[i]=Dh.charAt(n%64),n=Math.floor(n/64);U(0===n,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===t[i];i--)t[i]=0;t[i]++}else for(i=0;i<12;i++)t[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=Dh.charAt(t[i]);return U(20===o.length,"nextPushId: Length should be 20."),o}}();class Mh{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+le(this.snapshot.exportVal())}}class jh{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Fh{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return U(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Uh{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new Q;return vh(this._repo,this._path,e.wrapCallback((()=>{}))),e.promise}remove(){Xu("OnDisconnect.remove",this._path);const e=new Q;return _h(this._repo,this._path,null,e.wrapCallback((()=>{}))),e.promise}set(e){Xu("OnDisconnect.set",this._path),zu("OnDisconnect.set",e,this._path,!1);const t=new Q;return _h(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}setWithPriority(e,t){Xu("OnDisconnect.setWithPriority",this._path),zu("OnDisconnect.setWithPriority",e,this._path,!1),Yu("OnDisconnect.setWithPriority",t,!1);const n=new Q;return function(e,t,n,r,i){const s=wc(n,r);e.server_.onDisconnectPut(t.toString(),s.val(!0),((n,r)=>{"ok"===n&&Uc(e.onDisconnect_,t,s),Ih(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((()=>{}))),n.promise}update(e){Xu("OnDisconnect.update",this._path),Ku("OnDisconnect.update",e,this._path,!1);const t=new Q;return function(e,t,n,r){if(pe(n))return Mo("onDisconnect().update() called with empty data.  Don't do anything."),void Ih(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,((i,s)=>{"ok"===i&&Go(n,((n,r)=>{const i=wc(r);Uc(e.onDisconnect_,Da(t,n),i)})),Ih(0,r,i,s)}))}(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}}class qh{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return La(this._path)?null:Ra(this._path)}get ref(){return new Vh(this._repo,this._path)}get _queryIdentifier(){const e=Lc(this._queryParams),t=Ko(e);return"{}"===t?"default":t}get _queryObject(){return Lc(this._queryParams)}isEqual(e){if(!((e=Pe(e))instanceof qh))return!1;const t=this._repo===e._repo,n=Fa(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}function Wh(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function Bh(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Ja){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==Bo)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==$o)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===lc){if(null!=t&&!Vu(t)||null!=n&&!Vu(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(U(e.getIndex()instanceof bc||e.getIndex()===Ic,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function $h(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Vh extends qh{constructor(e,t){super(e,t,new Oc,!1)}get parent(){const e=Aa(this._path);return null===e?null:new Vh(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class zh{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Ta(e),n=Yh(this.ref,e);return new zh(this._node.getChild(t),n,lc)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,((t,n)=>e(new zh(n,Yh(this.ref,t),lc))))}hasChild(e){const t=new Ta(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Hh(e,t){return(e=Pe(e))._checkNotDeleted("ref"),void 0!==t?Yh(e._root,t):e._root}function Kh(e,t){(e=Pe(e))._checkNotDeleted("refFromURL");const n=Nh(t,e._repo.repoInfo_.nodeAdmin);Zu("refFromURL",n);const r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||Uo("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),Hh(e,n.path.toString())}function Yh(e,t){return null===xa((e=Pe(e))._path)?Qu("child","path",t,!1):Ju("child","path",t,!1),new Vh(e._repo,Da(e._path,t))}function Gh(e,t){e=Pe(e),Xu("set",e._path),zu("set",t,e._path,!1);const n=new Q;return mh(e._repo,e._path,t,null,n.wrapCallback((()=>{}))),n.promise}function Jh(e,t){Ku("update",t,e._path,!1);const n=new Q;return function(e,t,n,r){bh(e,"update",{path:t.toString(),value:n});let i=!0;const s=hh(e),o={};if(Go(n,((n,r)=>{i=!1,o[n]=Eu(Da(t,n),wc(r),e.serverSyncTree_,s)})),i)Mo("update() called with empty data.  Don't do anything."),Ih(0,r,"ok",void 0);else{const i=gh(e),s=function(e,t,n,r){!function(e,t,n,r){U(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=ll(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);const i=ol.fromObject(n);return hu(e,new Jc({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,t,o,i);th(e.eventQueue_,s),e.server_.merge(t.toString(),n,((n,s)=>{const o="ok"===n;o||qo("update at "+t+" failed: "+n);const a=su(e.serverSyncTree_,i,!o),c=a.length>0?Sh(e,t):t;rh(e.eventQueue_,c,a),Ih(0,r,n,s)})),Go(n,(n=>{const r=Oh(e,Da(t,n));Sh(e,r)})),rh(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}function Qh(e){e=Pe(e);const t=new Fh((()=>{})),n=new Xh(t);return function(e,t,n){const r=function(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const i=Ma(e,n);r=r||Ql(t,i)}));let i=e.syncPointTree_.get(n);i?r=r||Ql(i,Ea()):(i=new Kl,e.syncPointTree_=e.syncPointTree_.set(n,i));const s=null!=r,o=s?new Qc(r,!0,!1):null;return rl(Gl(i,t,_l(e.pendingWriteTree_,t._path),s?o.getNode():vc.EMPTY_NODE,s).viewCache_)}(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then((r=>{const i=wc(r).withIndex(t._queryParams.getIndex());let s;if(lu(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())s=ou(e.serverSyncTree_,t._path,i);else{const n=gu(e.serverSyncTree_,t);s=cu(e.serverSyncTree_,t._path,i,n)}return rh(e.eventQueue_,t._path,s),au(e.serverSyncTree_,t,n,null,!0),i}),(n=>(bh(e,"get for query "+le(t)+" failed: "+n),Promise.reject(new Error(n)))))}(e._repo,e,n).then((t=>new zh(t,new Vh(e._repo,e._path),e._queryParams.getIndex())))}class Xh{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new Mh("value",this,new zh(e.snapshotNode,new Vh(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new jh(this,e,t):null}matches(e){return e instanceof Xh&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Zh{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new jh(this,e,t):null}createEvent(e,t){U(null!=e.childName,"Child events should have a childName.");const n=Yh(new Vh(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new Mh(e.type,this,new zh(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Zh&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function ed(e,t,n,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const t=n,r=(n,r)=>{yh(e._repo,e,a),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const o=new Fh(n,s||void 0),a="value"===t?new Xh(o):new Zh(t,o);return function(e,t,n){let r;r=".info"===xa(t._path)?lu(e.infoSyncTree_,t,n):lu(e.serverSyncTree_,t,n),nh(e.eventQueue_,t._path,r)}(e._repo,e,a),()=>yh(e._repo,e,a)}function td(e,t,n,r){return ed(e,"value",t,n,r)}function nd(e,t,n,r){return ed(e,"child_added",t,n,r)}function rd(e,t,n,r){return ed(e,"child_changed",t,n,r)}function id(e,t,n,r){return ed(e,"child_moved",t,n,r)}function sd(e,t,n,r){return ed(e,"child_removed",t,n,r)}function od(e,t,n){let r=null;const i=n?new Fh(n):null;"value"===t?r=new Xh(i):t&&(r=new Zh(t,i)),yh(e._repo,e,r)}class ad{}class cd extends ad{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){zu("endAt",this._value,e._path,!0);const t=Nc(e._queryParams,this._value,this._key);if($h(t),Bh(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new qh(e._repo,e._path,t,e._orderByCalled)}}class ld extends ad{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){zu("endBefore",this._value,e._path,!1);const t=function(e,t,n){let r;return r=e.index_===Ja||n?Nc(e,t,n):Nc(e,t,Bo),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if($h(t),Bh(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new qh(e._repo,e._path,t,e._orderByCalled)}}class ud extends ad{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){zu("startAt",this._value,e._path,!0);const t=Rc(e._queryParams,this._value,this._key);if($h(t),Bh(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new qh(e._repo,e._path,t,e._orderByCalled)}}class hd extends ad{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){zu("startAfter",this._value,e._path,!1);const t=function(e,t,n){let r;return r=e.index_===Ja||n?Rc(e,t,n):Rc(e,t,$o),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if($h(t),Bh(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new qh(e._repo,e._path,t,e._orderByCalled)}}class dd extends ad{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new qh(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}class pd extends ad{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new qh(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}class fd extends ad{constructor(e){super(),this._path=e}_apply(e){Wh(e,"orderByChild");const t=new Ta(this._path);if(La(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new bc(t),r=Ac(e._queryParams,n);return Bh(r),new qh(e._repo,e._path,r,!0)}}class gd extends ad{_apply(e){Wh(e,"orderByKey");const t=Ac(e._queryParams,Ja);return Bh(t),new qh(e._repo,e._path,t,!0)}}class md extends ad{_apply(e){Wh(e,"orderByPriority");const t=Ac(e._queryParams,lc);return Bh(t),new qh(e._repo,e._path,t,!0)}}class vd extends ad{_apply(e){Wh(e,"orderByValue");const t=Ac(e._queryParams,Ic);return Bh(t),new qh(e._repo,e._path,t,!0)}}class _d extends ad{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(zu("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new cd(this._value,this._key)._apply(new ud(this._value,this._key)._apply(e))}}function yd(e,...t){let n=Pe(e);for(const e of t)n=e._apply(n);return n}!function(e){U(!zl,"__referenceConstructor has already been defined"),zl=e}(Vh),function(e){U(!Hl,"__referenceConstructor has already been defined"),Hl=e}(Vh);const wd={};function bd(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||Uo("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Mo("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a,c=Nh(s,i),l=c.repoInfo;"undefined"!=typeof process&&process.env&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${l.namespace}`,c=Nh(s,i),l=c.repoInfo):o=!c.repoInfo.secure;const u=i&&o?new ra(ra.OWNER):new na(e.name,e.options,t);Zu("Invalid Firebase Database URL",c),La(c.path)||Uo("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=wd[t.name];i||(i={},wd[t.name]=i);let s=i[e.toURLString()];return s&&Uo("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new ch(e,false,n,r),i[e.toURLString()]=s,s}(l,e,u,new ta(e.name,n));return new Id(h,e)}class Id{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(lh(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Vh(this._repo,Ea())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){const n=wd[t];n&&n[e.key]===e||Uo(`Database ${t}(${e.repoInfo_}) has already been deleted.`),wh(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Uo("Cannot call "+e+" on a deleted database.")}}function kd(){ba.IS_TRANSPORT_INITIALIZED&&qo("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Cd(){kd(),va.forceDisallow()}function Sd(){kd(),wa.forceDisallow(),va.forceAllow()}function Td(e,t){Lo(e,t)}class Ed{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function xd(e,t,n){var r;if(e=Pe(e),Xu("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";const i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,s=new Q,o=td(e,(()=>{}));return function(t,n,r,i,o,a){bh(t,"transaction on "+n);const c={path:n,update:r,onComplete:(t,n,r)=>{let i=null;t?s.reject(t):(i=new zh(r,new Vh(e._repo,e._path),lc),s.resolve(new Ed(n,i)))},status:null,order:Oo(),applyLocally:a,retryCount:0,unwatcher:o,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=kh(t,n,void 0);c.currentInputSnapshot=l;const u=c.update(l.val());if(void 0===u)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{Hu("transaction failed: Data returned ",u,c.path),c.status=0;const e=Ru(t.transactionQueueTree_,n),r=Nu(e)||[];let i;r.push(c),Au(e,r),"object"==typeof u&&null!==u&&he(u,".priority")?(i=de(u,".priority"),U(Vu(i),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):i=(uu(t.serverSyncTree_,n)||vc.EMPTY_NODE).getPriority().val();const s=hh(t),o=wc(u,i),a=xu(o,l,s);c.currentOutputSnapshotRaw=o,c.currentOutputSnapshotResolved=a,c.currentWriteId=gh(t);const h=iu(t.serverSyncTree_,n,a,c.currentWriteId,c.applyLocally);rh(t.eventQueue_,n,h),Ch(t,t.transactionQueueTree_)}}(e._repo,e._path,t,0,o,i),s.promise}za.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},za.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},ko(wt),ft(new Oe("database",((e,{instanceIdentifier:t})=>bd(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),St(wo,bo,void 0),St(wo,bo,"esm2017");const Pd=new qe("@firebase/database-compat"),Od=function(e){const t="FIREBASE WARNING: "+e;Pd.warn(t)};class Rd{constructor(e){this._delegate=e}cancel(e){Ce("OnDisconnect.cancel",0,1,arguments.length),Te("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then((()=>e(null)),(t=>e(t))),t}remove(e){Ce("OnDisconnect.remove",0,1,arguments.length),Te("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then((()=>e(null)),(t=>e(t))),t}set(e,t){Ce("OnDisconnect.set",1,2,arguments.length),Te("OnDisconnect.set","onComplete",t,!0);const n=this._delegate.set(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){Ce("OnDisconnect.setWithPriority",2,3,arguments.length),Te("OnDisconnect.setWithPriority","onComplete",n,!0);const r=this._delegate.setWithPriority(e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}update(e,t){if(Ce("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,Od("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Te("OnDisconnect.update","onComplete",t,!0);const n=this._delegate.update(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}}class Nd{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return Ce("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class Ad{constructor(e,t){this._database=e,this._delegate=t}val(){return Ce("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return Ce("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return Ce("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return Ce("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return Ce("DataSnapshot.child",0,1,arguments.length),e=String(e),Ju("DataSnapshot.child","path",e,!1),new Ad(this._database,this._delegate.child(e))}hasChild(e){return Ce("DataSnapshot.hasChild",1,1,arguments.length),Ju("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return Ce("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return Ce("DataSnapshot.forEach",1,1,arguments.length),Te("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((t=>e(new Ad(this._database,t))))}hasChildren(){return Ce("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return Ce("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return Ce("DataSnapshot.ref",0,0,arguments.length),new Ld(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Dd{constructor(e,t){this.database=e,this._delegate=t}on(e,t,n,r){var i;Ce("Query.on",2,4,arguments.length),Te("Query.on","callback",t,!1);const s=Dd.getCancelAndContextArgs_("Query.on",n,r),o=(e,n)=>{t.call(s.context,new Ad(this.database,e),n)};o.userCallback=t,o.context=s.context;const a=null===(i=s.cancel)||void 0===i?void 0:i.bind(s.context);switch(e){case"value":return td(this._delegate,o,a),t;case"child_added":return nd(this._delegate,o,a),t;case"child_removed":return sd(this._delegate,o,a),t;case"child_changed":return rd(this._delegate,o,a),t;case"child_moved":return id(this._delegate,o,a),t;default:throw new Error(Se("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,n){if(Ce("Query.off",0,3,arguments.length),function(e,t,n){if(void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Se("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),Te("Query.off","callback",t,!0),Ee("Query.off","context",n,!0),t){const r=()=>{};r.userCallback=t,r.context=n,od(this._delegate,e,r)}else od(this._delegate,e)}get(){return Qh(this._delegate).then((e=>new Ad(this.database,e)))}once(e,t,n,r){Ce("Query.once",1,4,arguments.length),Te("Query.once","callback",t,!0);const i=Dd.getCancelAndContextArgs_("Query.once",n,r),s=new Q,o=(e,n)=>{const r=new Ad(this.database,e);t&&t.call(i.context,r,n),s.resolve(r)};o.userCallback=t,o.context=i.context;const a=e=>{i.cancel&&i.cancel.call(i.context,e),s.reject(e)};switch(e){case"value":td(this._delegate,o,a,{onlyOnce:!0});break;case"child_added":nd(this._delegate,o,a,{onlyOnce:!0});break;case"child_removed":sd(this._delegate,o,a,{onlyOnce:!0});break;case"child_changed":rd(this._delegate,o,a,{onlyOnce:!0});break;case"child_moved":id(this._delegate,o,a,{onlyOnce:!0});break;default:throw new Error(Se("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}limitToFirst(e){return Ce("Query.limitToFirst",1,1,arguments.length),new Dd(this.database,yd(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new dd(e)}(e)))}limitToLast(e){return Ce("Query.limitToLast",1,1,arguments.length),new Dd(this.database,yd(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new pd(e)}(e)))}orderByChild(e){return Ce("Query.orderByChild",1,1,arguments.length),new Dd(this.database,yd(this._delegate,function(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Ju("orderByChild","path",e,!1),new fd(e)}(e)))}orderByKey(){return Ce("Query.orderByKey",0,0,arguments.length),new Dd(this.database,yd(this._delegate,new gd))}orderByPriority(){return Ce("Query.orderByPriority",0,0,arguments.length),new Dd(this.database,yd(this._delegate,new md))}orderByValue(){return Ce("Query.orderByValue",0,0,arguments.length),new Dd(this.database,yd(this._delegate,new vd))}startAt(e=null,t){return Ce("Query.startAt",0,2,arguments.length),new Dd(this.database,yd(this._delegate,function(e=null,t){return Gu("startAt","key",t,!0),new ud(e,t)}(e,t)))}startAfter(e=null,t){return Ce("Query.startAfter",0,2,arguments.length),new Dd(this.database,yd(this._delegate,function(e,t){return Gu("startAfter","key",t,!0),new hd(e,t)}(e,t)))}endAt(e=null,t){return Ce("Query.endAt",0,2,arguments.length),new Dd(this.database,yd(this._delegate,function(e,t){return Gu("endAt","key",t,!0),new cd(e,t)}(e,t)))}endBefore(e=null,t){return Ce("Query.endBefore",0,2,arguments.length),new Dd(this.database,yd(this._delegate,function(e,t){return Gu("endBefore","key",t,!0),new ld(e,t)}(e,t)))}equalTo(e,t){return Ce("Query.equalTo",1,2,arguments.length),new Dd(this.database,yd(this._delegate,function(e,t){return Gu("equalTo","key",t,!0),new _d(e,t)}(e,t)))}toString(){return Ce("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return Ce("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(Ce("Query.isEqual",1,1,arguments.length),!(e instanceof Dd))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,n){const r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,Te(e,"cancel",r.cancel,!0),r.context=n,Ee(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(Se(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}get ref(){return new Ld(this.database,new Vh(this._delegate._repo,this._delegate._path))}}class Ld extends Dd{constructor(e,t){super(e,new qh(t._repo,t._path,new Oc,!1)),this.database=e,this._delegate=t}getKey(){return Ce("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return Ce("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new Ld(this.database,Yh(this._delegate,e))}getParent(){Ce("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Ld(this.database,e):null}getRoot(){return Ce("Reference.root",0,0,arguments.length),new Ld(this.database,this._delegate.root)}set(e,t){Ce("Reference.set",1,2,arguments.length),Te("Reference.set","onComplete",t,!0);const n=Gh(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}update(e,t){if(Ce("Reference.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,Od("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Xu("Reference.update",this._delegate._path),Te("Reference.update","onComplete",t,!0);const n=Jh(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){Ce("Reference.setWithPriority",2,3,arguments.length),Te("Reference.setWithPriority","onComplete",n,!0);const r=function(e,t,n){if(Xu("setWithPriority",e._path),zu("setWithPriority",t,e._path,!1),Yu("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";const r=new Q;return mh(e._repo,e._path,t,n,r.wrapCallback((()=>{}))),r.promise}(this._delegate,e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}remove(e){Ce("Reference.remove",0,1,arguments.length),Te("Reference.remove","onComplete",e,!0);const t=function(e){return Xu("remove",e._path),Gh(e,null)}(this._delegate);return e&&t.then((()=>e(null)),(t=>e(t))),t}transaction(e,t,n){Ce("Reference.transaction",1,3,arguments.length),Te("Reference.transaction","transactionUpdate",e,!1),Te("Reference.transaction","onComplete",t,!0),function(e,t,n,r){if(void 0!==n&&"boolean"!=typeof n)throw new Error(Se("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,n);const r=xd(this._delegate,e,{applyLocally:n}).then((e=>new Nd(e.committed,new Ad(this.database,e.snapshot))));return t&&r.then((e=>t(null,e.committed,e.snapshot)),(e=>t(e,!1,null))),r}setPriority(e,t){Ce("Reference.setPriority",1,2,arguments.length),Te("Reference.setPriority","onComplete",t,!0);const n=function(e,t){e=Pe(e),Xu("setPriority",e._path),Yu("setPriority",t,!1);const n=new Q;return mh(e._repo,Da(e._path,".priority"),t,null,n.wrapCallback((()=>{}))),n.promise}(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}push(e,t){Ce("Reference.push",0,2,arguments.length),Te("Reference.push","onComplete",t,!0);const n=function(e,t){e=Pe(e),Xu("push",e._path),zu("push",t,e._path,!0);const n=uh(e._repo),r=Lh(n),i=Yh(e,r),s=Yh(e,r);let o;return o=null!=t?Gh(s,t).then((()=>s)):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,e),r=n.then((e=>new Ld(this.database,e)));t&&r.then((()=>t(null)),(e=>t(e)));const i=new Ld(this.database,n);return i.then=r.then.bind(r),i.catch=r.catch.bind(r,void 0),i}onDisconnect(){return Xu("Reference.onDisconnect",this._delegate._path),new Rd(new Uh(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class Md{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:Cd,forceLongPolling:Sd}}useEmulator(e,t,n={}){!function(e,t,n,r={}){(e=Pe(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&Uo("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Uo('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new ra(ra.OWNER);else if(r.mockUserToken){const t="string"==typeof r.mockUserToken?r.mockUserToken:function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[H(JSON.stringify({alg:"none",type:"JWT"})),H(JSON.stringify(s)),""].join(".")}(r.mockUserToken,e.app.options.projectId);s=new ra(t)}!function(e,t,n,r){e.repoInfo_=new la(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}(i,t,n,s)}(this._delegate,e,t,n)}ref(e){if(Ce("database.ref",0,1,arguments.length),e instanceof Ld){const t=Kh(this._delegate,e.toString());return new Ld(this,t)}{const t=Hh(this._delegate,e);return new Ld(this,t)}}refFromURL(e){Ce("database.refFromURL",1,1,arguments.length);const t=Kh(this._delegate,e);return new Ld(this,t)}goOffline(){return Ce("database.goOffline",0,0,arguments.length),(e=Pe(e=this._delegate))._checkNotDeleted("goOffline"),void wh(e._repo);var e}goOnline(){return Ce("database.goOnline",0,0,arguments.length),(e=Pe(e=this._delegate))._checkNotDeleted("goOnline"),void((t=e._repo).persistentConnection_&&t.persistentConnection_.resume(oh));var e,t}}Md.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:e=>function(e){return{".sv":{increment:e}}}(e)};var jd=Object.freeze({__proto__:null,initStandalone:function({app:e,url:t,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){ko(n);const a=new Ae("database-standalone"),c=new Ne("auth-internal",a);let l;return c.setComponent(new Oe("auth-internal",(()=>r),"PRIVATE")),i&&(l=new Ne("app-check-internal",a),l.setComponent(new Oe("app-check-internal",(()=>i),"PRIVATE"))),{instance:new Md(bd(e,c,l,t,o),e),namespace:s}}});const Fd=Md.ServerValue;!function(e){e.INTERNAL.registerComponent(new Oe("database-compat",((e,{instanceIdentifier:t})=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database").getImmediate({identifier:t});return new Md(r,n)}),"PUBLIC").setServiceProps({Reference:Ld,Query:Dd,Database:Md,DataSnapshot:Ad,enableLogging:Td,INTERNAL:jd,ServerValue:Fd}).setMultipleInstances(!0)),e.registerVersion("@firebase/database-compat","1.0.2")}($t),Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,$t.auth,$t.database,L(),Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var Ud=n(468);n(1260);var qd,Wd=((qd=Wd||{}).READ_USERS="read_users",qd.READ_USERS_MAIL="read_users_mail",qd.READ_ITEMS="read_items",qd.READ_ORDERS="read_orders",qd.READ_SAVINGS="read_savings",qd.WRITE_USERS="write_users",qd.WRITE_ITEMS="write_items",qd.WRITE_ORDERS="write_orders",qd);(0,Ud.camelizeDeeply)([{id:"191640",name:"opusyonn ",price:15003,discount_price:null,stock:321,visible:!0,list_order:1,image_url:"https://static.basedev.info/img/shop/no_image.png",available:{available:!0,reason:""},labels:[],apps:[]},{id:"191196",name:"定期便",price:1234,discount_price:null,stock:1233,visible:!0,list_order:2,image_url:"https://static.basedev.info/img/shop/no_image.png",available:{available:!1,reason:"定期便商品は設定できません"},labels:["repeat"],apps:[]},{id:"190903",name:"しゃっしゃ",price:1470,discount_price:null,stock:39,visible:!0,list_order:3,image_url:"https://base-ec2if-dev2.akamaized.net/w=76,a=0,q=90,u=1/images/item/origin/6d8e583e5766f07ad5637c07f945d130.jpg",available:{available:!1,reason:"Tシャツ商品は設定できません"},labels:["club_t"],apps:[]},{id:"175228",name:"真のコピー",price:11500,discount_price:null,stock:1998,visible:!0,list_order:4,image_url:"https://static.basedev.info/img/shop/no_image.png",available:{available:!0,reason:""},labels:["sales_period"],apps:{sales_period:{begin_at:new Date,end_at:null}}},{id:"174835",name:"コピー：コピー：てｓｔ",price:1500,discount_price:null,stock:399,visible:!0,list_order:5,image_url:"https://base-ec2if-dev2.akamaized.net/w=76,a=0,q=90,u=1/images/item/origin/e4942f85aab91c801ae67a80311bfd08.jpg",available:{available:!0,reason:""},labels:["sales_period"],apps:{sales_period:{begin_at:new Date,end_at:null}}},{id:"174833",name:"コピー：コピー：てｓｔ",price:1500,discount_price:null,stock:400,visible:!1,list_order:6,image_url:"https://static.basedev.info/img/shop/no_image.png",available:{available:!0,reason:""},labels:[],apps:[]},{id:"174822",name:"コピー：てｓｔ",price:1500,discount_price:null,stock:400,visible:!0,list_order:7,image_url:"https://static.basedev.info/img/shop/no_image.png",available:{available:!0,reason:""},labels:[],apps:[]},{id:"174832",name:"コピー：コピー：コピー：てｓｔ",price:1500,discount_price:null,stock:398,visible:!0,list_order:8,image_url:"https://static.basedev.info/img/shop/no_image.png",available:{available:!0,reason:""},labels:[],apps:[]}]),Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var Bd,$d,Vd=(($d=Vd||{})[$d.STANDARD=1]="STANDARD",$d[$d.REDUCED=2]="REDUCED",$d),zd=((Bd=zd||{})[Bd.Other=0]="Other",Bd[Bd.Yamato=1]="Yamato",Bd[Bd.Sagawa=2]="Sagawa",Bd[Bd.Yuubin=3]="Yuubin",Bd);Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,n(120),Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var Hd,Kd=(e=>(e[e.NONE=0]="NONE",e[e.SMS=1]="SMS",e[e.APP=2]="APP",e[e.RECOVERY_CODE=9999]="RECOVERY_CODE",e))(Kd||{}),Yd=((Hd=Yd||{})[Hd.FALSE=0]="FALSE",Hd[Hd.TRUE=1]="TRUE",Hd),Gd=(e=>(e[e.FALSE=0]="FALSE",e[e.TRUE=1]="TRUE",e))(Gd||{});Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;class Jd{constructor(e,t=[]){this.functions=e,this.data=t,this.eventEmtiter=new(L()),this.data.sort(this.functions.compare)}write(e){const t=[],n=[];e.forEach((e=>{this.search(e)?n.push(e):t.push(e)})),t.length>0&&(this.data.push(...t),this.eventEmtiter.emit("create",[...t]));const r=[];n.length>0&&(this.data.forEach((e=>{const t=n.find((t=>this.functions.equals(e,t)));t&&this.functions.diff(e,t)&&(this.functions.merge(e,t),r.push(t))})),r.length>0&&this.eventEmtiter.emit("update",[...r])),this.data.sort(this.functions.compare),(t.length>0||r.length>0)&&this.eventEmtiter.emit("value",[...this.data])}search(e){return this.data.find((t=>this.functions.equals(t,e)))}on(e,t,n=!0){"value"===e&&n&&t(this.data),this.eventEmtiter.on(e,t)}destroy(){this.eventEmtiter.removeAllListeners()}has(e){return null!==this.get(e)}get(e){return this.data.find((t=>this.functions.match(e,t)))||null}getLast(){return 0===this.data.length?null:this.data[this.data.length-1]}}const Qd=(e,t)=>{t.on(((t,n)=>{e.write(n)}))};class Xd extends Jd{constructor(e=[]){super({match:(e,{id:t})=>e===t,equals:P,merge:x,diff:O,compare:R},e)}}n(5280);var Zd=Object.defineProperty,ep=Object.getOwnPropertySymbols,tp=Object.prototype.hasOwnProperty,np=Object.prototype.propertyIsEnumerable,rp=(e,t,n)=>t in e?Zd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ip=(e,t)=>{for(var n in t||(t={}))tp.call(t,n)&&rp(e,n,t[n]);if(ep)for(var n of ep(t))np.call(t,n)&&rp(e,n,t[n]);return e};const sp={xhrFields:{withCredentials:!0},contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Accept","application/json")}},op="システムで問題が発生しました。時間をおいて再度お試しください。";function ap(e,t){return e?e.user_message?{message:e.user_message,status:t,name:"Error",code:e.code||void 0,payload:e}:e.error&&e.error.user_message?{message:e.error.user_message,status:t,code:e.error.code||void 0,name:e.error.reason||"Error",payload:e}:null:null}class cp{static onAuthError(e){window.__apiClient_authErrorCallback=e}static get authErrorCallback(){return window.__apiClient_authErrorCallback}request(e,t={}){t=Object.assign({catch403:!1},t);let n=e;const i=n.type;return"PUT"==i?(n.beforeSend=function(e){e.setRequestHeader("Accept","application/json"),e.setRequestHeader("X-HTTP-Method-Override","PUT")},n.type="POST"):"DELETE"==i&&(n.beforeSend=function(e){e.setRequestHeader("Accept","application/json"),e.setRequestHeader("X-HTTP-Method-Override","DELETE")},n.type="POST"),new Promise(((e,i)=>{r().ajax(ip(ip({},sp),n)).done((t=>{if(!t)return i(new Error(op));if(n.callback&&(t=n.callback(t)),t.status&&t.status>=200&&t.status<300)e(t);else{let e=ap(t,t.status);i(e||new Error(op))}})).fail((e=>{if(403==e.status&&(cp.authErrorCallback&&e.responseJSON&&e.responseJSON.login_url&&cp.authErrorCallback(),!t.catch403))return;if(t.bypassError)return void i(e);let n=ap(e.responseJSON,e.status);i(n||new Error(op))}))}))}}class lp extends cp{constructor(e){super(),this.shopId=e}post(e,t,n,r,i){const s={room:{unique_id:r},message:{type:e,text:t,images:n,item_id:i}};return this.request({url:"/message/post",type:"POST",data:JSON.stringify(s)}).then((e=>(0,Ud.camelizeDeeply)(e)))}chat(e,t={}){return this.request({url:"/message/chat",type:"GET",data:r().extend(t,{room_unique_id:e,shop_id:this.shopId})}).then((e=>(0,Ud.camelizeDeeply)(e)))}updateNotificationMethod(e,t,n){const r={room:{unique_id:e},room_user:{notification_type:t,address:n}};return this.request({url:"/message/update_notification_method",type:"POST",data:JSON.stringify(r)})}ping(e){return this.request({url:"/message/ping",type:"GET",data:{shop_id:e}}).then((e=>(0,Ud.camelizeDeeply)(e)))}createRoom(e){const t={shop_id:e};return this.request({url:"/message/create_room",type:"POST",data:JSON.stringify(t)}).then((e=>(0,Ud.camelizeDeeply)(e)))}uploadTmpImage(e){const t=new FormData;return t.append("file",e,e.name),this.request({url:"/message/upload_tmp_image",type:"POST",data:t,processData:!1,contentType:!1})}deleteImage(e,t){const n={room:{unique_id:e},message_image:{id:t}};return this.request({url:"/message/delete_image",type:"DELETE",data:JSON.stringify(n)})}}var up=Object.defineProperty,hp=Object.defineProperties,dp=Object.getOwnPropertyDescriptors,pp=Object.getOwnPropertySymbols,fp=Object.prototype.hasOwnProperty,gp=Object.prototype.propertyIsEnumerable,mp=(e,t,n)=>t in e?up(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,vp=(e,t)=>{for(var n in t||(t={}))fp.call(t,n)&&mp(e,n,t[n]);if(pp)for(var n of pp(t))gp.call(t,n)&&mp(e,n,t[n]);return e},_p=(e,t)=>hp(e,dp(t));const yp=async(e,t)=>{if(!t)return{id:null,stream:new Xd,connections:{}};const n=new Xd([]),r=new F(t,new lp(e));return Qd(n,r),await r.start(),{id:t,stream:n,connections:{api:r}}},wp=async(e,t,n="syncing")=>{e.stream.write([_p(vp({},t),{sync:n})])};function bp(e){return bp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bp(e)}function Ip(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kp(e){var t=function(e,t){if("object"!=bp(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=bp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==bp(t)?t:String(t)}function Cp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,kp(r.key),r)}}function Sp(e,t,n){return t&&Cp(e.prototype,t),n&&Cp(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ep(e,t){return Ep=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ep(e,t)}function xp(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ep(e,t)}function Pp(e,t){if(t&&("object"===bp(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Tp(e)}function Op(e){return Op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Op(e)}function Rp(e,t,n){return(t=kp(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Np(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ap(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ap(Object(n),!0).forEach((function(t){Rp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ap(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Lp={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]&&console[e].apply(console,t)}},Mp=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ip(this,e),this.init(t,n)}return Sp(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||Lp,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,n,r){return r&&!this.debug?null:("string"==typeof e[0]&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(t){return new e(this.logger,Dp(Dp({},{prefix:"".concat(this.prefix,":").concat(t,":")}),this.options))}}]),e}(),jp=new Mp,Fp=function(){function e(){Ip(this,e),this.observers={}}return Sp(e,[{key:"on",value:function(e,t){var n=this;return e.split(" ").forEach((function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)})),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter((function(e){return e!==t})):delete this.observers[e])}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.observers[e]&&[].concat(this.observers[e]).forEach((function(e){e.apply(void 0,n)})),this.observers["*"]&&[].concat(this.observers["*"]).forEach((function(t){t.apply(t,[e].concat(n))}))}}]),e}();function Up(){var e,t,n=new Promise((function(n,r){e=n,t=r}));return n.resolve=e,n.reject=t,n}function qp(e){return null==e?"":""+e}function Wp(e,t,n){function r(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function i(){return!e||"string"==typeof e}for(var s="string"!=typeof t?[].concat(t):t.split(".");s.length>1;){if(i())return{};var o=r(s.shift());!e[o]&&n&&(e[o]=new n),e=Object.prototype.hasOwnProperty.call(e,o)?e[o]:{}}return i()?{}:{obj:e,k:r(s.shift())}}function Bp(e,t,n){var r=Wp(e,t,Object);r.obj[r.k]=n}function $p(e,t){var n=Wp(e,t),r=n.obj,i=n.k;if(r)return r[i]}function Vp(e,t,n){var r=$p(e,n);return void 0!==r?r:$p(t,n)}function zp(e,t,n){for(var r in t)"__proto__"!==r&&"constructor"!==r&&(r in e?"string"==typeof e[r]||e[r]instanceof String||"string"==typeof t[r]||t[r]instanceof String?n&&(e[r]=t[r]):zp(e[r],t[r],n):e[r]=t[r]);return e}function Hp(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var Kp={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function Yp(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(function(e){return Kp[e]})):e}var Gp="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,Jp=[" ",",","?","!",";"];function Qp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qp(Object(n),!0).forEach((function(t){Rp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zp(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(e){if(e[t])return e[t];for(var r=t.split(n),i=e,s=0;s<r.length;++s){if(!i)return;if("string"==typeof i[r[s]]&&s+1<r.length)return;if(void 0===i[r[s]]){for(var o=2,a=r.slice(s,s+o).join(n),c=i[a];void 0===c&&r.length>s+o;)o++,c=i[a=r.slice(s,s+o).join(n)];if(void 0===c)return;if(t.endsWith(a)){if("string"==typeof c)return c;if(a&&"string"==typeof c[a])return c[a]}var l=r.slice(s+o).join(n);return l?Zp(c,l,n):void 0}i=i[r[s]]}return i}}var ef=function(e){xp(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=Op(t);if(n){var i=Op(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Pp(this,e)});function i(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return Ip(this,i),t=r.call(this),Gp&&Fp.call(Tp(t)),t.data=e||{},t.options=n,void 0===t.options.keySeparator&&(t.options.keySeparator="."),void 0===t.options.ignoreJSONStructure&&(t.options.ignoreJSONStructure=!0),t}return Sp(i,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,s=void 0!==r.ignoreJSONStructure?r.ignoreJSONStructure:this.options.ignoreJSONStructure,o=[e,t];n&&"string"!=typeof n&&(o=o.concat(n)),n&&"string"==typeof n&&(o=o.concat(i?n.split(i):n)),e.indexOf(".")>-1&&(o=e.split("."));var a=$p(this.data,o);return a||!s||"string"!=typeof n?a:Zp(this.data&&this.data[e]&&this.data[e][t],n,i)}},{key:"addResource",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},s=this.options.keySeparator;void 0===s&&(s=".");var o=[e,t];n&&(o=o.concat(s?n.split(s):n)),e.indexOf(".")>-1&&(r=t,t=(o=e.split("."))[1]),this.addNamespaces(t),Bp(this.data,o,r),i.silent||this.emit("added",e,t,n,r)}},{key:"addResources",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var i in n)"string"!=typeof n[i]&&"[object Array]"!==Object.prototype.toString.apply(n[i])||this.addResource(e,t,i,n[i],{silent:!0});r.silent||this.emit("added",e,t,n)}},{key:"addResourceBundle",value:function(e,t,n,r,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},o=[e,t];e.indexOf(".")>-1&&(r=n,n=t,t=(o=e.split("."))[1]),this.addNamespaces(t);var a=$p(this.data,o)||{};r?zp(a,n,i):a=Xp(Xp({},a),n),Bp(this.data,o,a),s.silent||this.emit("added",e,t,n)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?Xp(Xp({},{}),this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"hasLanguageSomeTranslations",value:function(e){var t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((function(e){return t[e]&&Object.keys(t[e]).length>0}))}},{key:"toJSON",value:function(){return this.data}}]),i}(Fp),tf={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,r,i){var s=this;return e.forEach((function(e){s.processors[e]&&(t=s.processors[e].process(t,n,r,i))})),t}};function nf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nf(Object(n),!0).forEach((function(t){Rp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var sf={},of=function(e){xp(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=Op(t);if(n){var i=Op(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Pp(this,e)});function i(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ip(this,i),t=r.call(this),Gp&&Fp.call(Tp(t)),function(e,t,n){["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"].forEach((function(e){t[e]&&(n[e]=t[e])}))}(0,e,Tp(t)),t.options=n,void 0===t.options.keySeparator&&(t.options.keySeparator="."),t.logger=jp.create("translator"),t}return Sp(i,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;var n=this.resolve(e,t);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(e,t){var n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var r=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,i=t.ns||this.options.defaultNS||[],s=n&&e.indexOf(n)>-1,o=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||function(e,t,n){t=t||"",n=n||"";var r=Jp.filter((function(e){return t.indexOf(e)<0&&n.indexOf(e)<0}));if(0===r.length)return!0;var i=new RegExp("(".concat(r.map((function(e){return"?"===e?"\\?":e})).join("|"),")")),s=!i.test(e);if(!s){var o=e.indexOf(n);o>0&&!i.test(e.substring(0,o))&&(s=!0)}return s}(e,n,r));if(s&&!o){var a=e.match(this.interpolator.nestingRegexp);if(a&&a.length>0)return{key:e,namespaces:i};var c=e.split(n);(n!==r||n===r&&this.options.ns.indexOf(c[0])>-1)&&(i=c.shift()),e=c.join(r)}return"string"==typeof i&&(i=[i]),{key:e,namespaces:i}}},{key:"translate",value:function(e,t,n){var r=this;if("object"!==bp(t)&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),t||(t={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);var s=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,o=this.extractFromKey(e[e.length-1],t),a=o.key,c=o.namespaces,l=c[c.length-1],u=t.lng||this.language,h=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&"cimode"===u.toLowerCase()){if(h){var d=t.nsSeparator||this.options.nsSeparator;return l+d+a}return a}var p=this.resolve(e,t),f=p&&p.res,g=p&&p.usedKey||a,m=p&&p.exactUsedKey||a,v=Object.prototype.toString.apply(f),_=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,y=!this.i18nFormat||this.i18nFormat.handleAsObject;if(y&&f&&"string"!=typeof f&&"boolean"!=typeof f&&"number"!=typeof f&&["[object Number]","[object Function]","[object RegExp]"].indexOf(v)<0&&("string"!=typeof _||"[object Array]"!==v)){if(!t.returnObjects&&!this.options.returnObjects)return this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,f,rf(rf({},t),{},{ns:c})):"key '".concat(a," (").concat(this.language,")' returned an object instead of string.");if(s){var w="[object Array]"===v,b=w?[]:{},I=w?m:g;for(var k in f)if(Object.prototype.hasOwnProperty.call(f,k)){var C="".concat(I).concat(s).concat(k);b[k]=this.translate(C,rf(rf({},t),{joinArrays:!1,ns:c})),b[k]===C&&(b[k]=f[k])}f=b}}else if(y&&"string"==typeof _&&"[object Array]"===v)(f=f.join(_))&&(f=this.extendTranslation(f,e,t,n));else{var S=!1,T=!1,E=void 0!==t.count&&"string"!=typeof t.count,x=i.hasDefaultValue(t),P=E?this.pluralResolver.getSuffix(u,t.count,t):"",O=t["defaultValue".concat(P)]||t.defaultValue;!this.isValidLookup(f)&&x&&(S=!0,f=O),this.isValidLookup(f)||(T=!0,f=a);var R=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&T?void 0:f,N=x&&O!==f&&this.options.updateMissing;if(T||S||N){if(this.logger.log(N?"updateKey":"missingKey",u,l,a,N?O:f),s){var A=this.resolve(a,rf(rf({},t),{},{keySeparator:!1}));A&&A.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var D=[],L=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&L&&L[0])for(var M=0;M<L.length;M++)D.push(L[M]);else"all"===this.options.saveMissingTo?D=this.languageUtils.toResolveHierarchy(t.lng||this.language):D.push(t.lng||this.language);var j=function(e,n,i){var s=x&&i!==f?i:R;r.options.missingKeyHandler?r.options.missingKeyHandler(e,l,n,s,N,t):r.backendConnector&&r.backendConnector.saveMissing&&r.backendConnector.saveMissing(e,l,n,s,N,t),r.emit("missingKey",e,l,n,f)};this.options.saveMissing&&(this.options.saveMissingPlurals&&E?D.forEach((function(e){r.pluralResolver.getSuffixes(e).forEach((function(n){j([e],a+n,t["defaultValue".concat(n)]||O)}))})):j(D,a,O))}f=this.extendTranslation(f,e,t,p,n),T&&f===a&&this.options.appendNamespaceToMissingKey&&(f="".concat(l,":").concat(a)),(T||S)&&this.options.parseMissingKeyHandler&&(f="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(a,S?f:void 0):this.options.parseMissingKeyHandler(f))}return f}},{key:"extendTranslation",value:function(e,t,n,r,i){var s=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,n,r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(rf(rf({},n),{interpolation:rf(rf({},this.options.interpolation),n.interpolation)}));var o,a="string"==typeof e&&(n&&n.interpolation&&void 0!==n.interpolation.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);if(a){var c=e.match(this.interpolator.nestingRegexp);o=c&&c.length}var l=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(l=rf(rf({},this.options.interpolation.defaultVariables),l)),e=this.interpolator.interpolate(e,l,n.lng||this.language,n),a){var u=e.match(this.interpolator.nestingRegexp);o<(u&&u.length)&&(n.nest=!1)}!1!==n.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return i&&i[0]===r[0]&&!n.context?(s.logger.warn("It seems you are nesting recursively key: ".concat(r[0]," in key: ").concat(t[0])),null):s.translate.apply(s,r.concat([t]))}),n)),n.interpolation&&this.interpolator.reset()}var h=n.postProcess||this.options.postProcess,d="string"==typeof h?[h]:h;return null!=e&&d&&d.length&&!1!==n.applyPostProcessor&&(e=tf.handle(d,e,t,this.options&&this.options.postProcessPassResolved?rf({i18nResolved:r},n):n,this)),e}},{key:"resolve",value:function(e){var t,n,r,i,s,o=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e&&(e=[e]),e.forEach((function(e){if(!o.isValidLookup(t)){var c=o.extractFromKey(e,a),l=c.key;n=l;var u=c.namespaces;o.options.fallbackNS&&(u=u.concat(o.options.fallbackNS));var h=void 0!==a.count&&"string"!=typeof a.count,d=h&&!a.ordinal&&0===a.count&&o.pluralResolver.shouldUseIntlApi(),p=void 0!==a.context&&("string"==typeof a.context||"number"==typeof a.context)&&""!==a.context,f=a.lngs?a.lngs:o.languageUtils.toResolveHierarchy(a.lng||o.language,a.fallbackLng);u.forEach((function(e){o.isValidLookup(t)||(s=e,!sf["".concat(f[0],"-").concat(e)]&&o.utils&&o.utils.hasLoadedNamespace&&!o.utils.hasLoadedNamespace(s)&&(sf["".concat(f[0],"-").concat(e)]=!0,o.logger.warn('key "'.concat(n,'" for languages "').concat(f.join(", "),'" won\'t get resolved as namespace "').concat(s,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),f.forEach((function(n){if(!o.isValidLookup(t)){i=n;var s,c=[l];if(o.i18nFormat&&o.i18nFormat.addLookupKeys)o.i18nFormat.addLookupKeys(c,l,n,e,a);else{var u;h&&(u=o.pluralResolver.getSuffix(n,a.count,a));var f="_zero";if(h&&(c.push(l+u),d&&c.push(l+f)),p){var g="".concat(l).concat(o.options.contextSeparator).concat(a.context);c.push(g),h&&(c.push(g+u),d&&c.push(g+f))}}for(;s=c.pop();)o.isValidLookup(t)||(r=s,t=o.getResource(n,e,s,a))}})))}))}})),{res:t,usedKey:n,exactUsedKey:r,usedLng:i,usedNS:s}}},{key:"isValidLookup",value:function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,r):this.resourceStore.getResource(e,t,n,r)}}],[{key:"hasDefaultValue",value:function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&"defaultValue"===t.substring(0,12)&&void 0!==e[t])return!0;return!1}}]),i}(Fp);function af(e){return e.charAt(0).toUpperCase()+e.slice(1)}var cf=function(){function e(t){Ip(this,e),this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=jp.create("languageUtils")}return Sp(e,[{key:"getScriptPartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}},{key:"getLanguagePartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])}},{key:"formatLanguageCode",value:function(e){if("string"==typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-");return this.options.lowerCaseLng?n=n.map((function(e){return e.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=af(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=af(n[1].toLowerCase())),t.indexOf(n[2].toLowerCase())>-1&&(n[2]=af(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isSupportedCode",value:function(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}},{key:"getBestMatchFromCodes",value:function(e){var t,n=this;return e?(e.forEach((function(e){if(!t){var r=n.formatLanguageCode(e);n.options.supportedLngs&&!n.isSupportedCode(r)||(t=r)}})),!t&&this.options.supportedLngs&&e.forEach((function(e){if(!t){var r=n.getLanguagePartFromCode(e);if(n.isSupportedCode(r))return t=r;t=n.options.supportedLngs.find((function(e){if(0===e.indexOf(r))return e}))}})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),"string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}},{key:"toResolveHierarchy",value:function(e,t){var n=this,r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[],s=function(e){e&&(n.isSupportedCode(e)?i.push(e):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&s(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&s(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&s(this.getLanguagePartFromCode(e))):"string"==typeof e&&s(this.formatLanguageCode(e)),r.forEach((function(e){i.indexOf(e)<0&&s(n.formatLanguageCode(e))})),i}}]),e}(),lf=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],uf={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)}},hf=["v1","v2","v3"],df={zero:0,one:1,two:2,few:3,many:4,other:5},pf=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ip(this,e),this.languageUtils=t,this.options=r,this.logger=jp.create("pluralResolver"),this.options.compatibilityJSON&&"v4"!==this.options.compatibilityJSON||"undefined"!=typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=(n={},lf.forEach((function(e){e.lngs.forEach((function(t){n[t]={numbers:e.nr,plurals:uf[e.fc]}}))})),n)}return Sp(e,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(e,{type:t.ordinal?"ordinal":"cardinal"})}catch(e){return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(e,t);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,n).map((function(e){return"".concat(t).concat(e)}))}},{key:"getSuffixes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getRule(e,n);return r?this.shouldUseIntlApi()?r.resolvedOptions().pluralCategories.sort((function(e,t){return df[e]-df[t]})).map((function(e){return"".concat(t.options.prepend).concat(e)})):r.numbers.map((function(r){return t.getSuffix(e,r,n)})):[]}},{key:"getSuffix",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.getRule(e,n);return r?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(r.select(t)):this.getSuffixRetroCompatible(r,t):(this.logger.warn("no plural rule found for: ".concat(e)),"")}},{key:"getSuffixRetroCompatible",value:function(e,t){var n=this,r=e.noAbs?e.plurals(t):e.plurals(Math.abs(t)),i=e.numbers[r];this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]&&(2===i?i="plural":1===i&&(i=""));var s=function(){return n.options.prepend&&i.toString()?n.options.prepend+i.toString():i.toString()};return"v1"===this.options.compatibilityJSON?1===i?"":"number"==typeof i?"_plural_".concat(i.toString()):s():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]?s():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}},{key:"shouldUseIntlApi",value:function(){return!hf.includes(this.options.compatibilityJSON)}}]),e}();function ff(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ff(Object(n),!0).forEach((function(t){Rp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ff(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mf=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ip(this,e),this.logger=jp.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(e){return e},this.init(t)}return Sp(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});var t=e.interpolation;this.escape=void 0!==t.escape?t.escape:Yp,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?Hp(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?Hp(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?Hp(t.nestingPrefix):t.nestingPrefixEscaped||Hp("$t("),this.nestingSuffix=t.nestingSuffix?Hp(t.nestingSuffix):t.nestingSuffixEscaped||Hp(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(e,"g");var t="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(t,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(e,t,n,r){var i,s,o,a=this,c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function l(e){return e.replace(/\$/g,"$$$$")}var u=function(e){if(e.indexOf(a.formatSeparator)<0){var i=Vp(t,c,e);return a.alwaysFormat?a.format(i,void 0,n,gf(gf(gf({},r),t),{},{interpolationkey:e})):i}var s=e.split(a.formatSeparator),o=s.shift().trim(),l=s.join(a.formatSeparator).trim();return a.format(Vp(t,c,o),l,n,gf(gf(gf({},r),t),{},{interpolationkey:o}))};this.resetRegExp();var h=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,d=r&&r.interpolation&&void 0!==r.interpolation.skipOnVariables?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables,p=[{regex:this.regexpUnescape,safeValue:function(e){return l(e)}},{regex:this.regexp,safeValue:function(e){return a.escapeValue?l(a.escape(e)):l(e)}}];return p.forEach((function(t){for(o=0;i=t.regex.exec(e);){var n=i[1].trim();if(void 0===(s=u(n)))if("function"==typeof h){var c=h(e,i,r);s="string"==typeof c?c:""}else if(r&&r.hasOwnProperty(n))s="";else{if(d){s=i[0];continue}a.logger.warn("missed to pass in variable ".concat(n," for interpolating ").concat(e)),s=""}else"string"==typeof s||a.useRawValueToEscape||(s=qp(s));var l=t.safeValue(s);if(e=e.replace(i[0],l),d?(t.regex.lastIndex+=l.length,t.regex.lastIndex-=i[0].length):t.regex.lastIndex=0,++o>=a.maxReplaces)break}})),e}},{key:"nest",value:function(e,t){var n,r,i=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=gf({},s);function a(e,t){var n=this.nestingOptionsSeparator;if(e.indexOf(n)<0)return e;var r=e.split(new RegExp("".concat(n,"[ ]*{"))),i="{".concat(r[1]);e=r[0],i=(i=this.interpolate(i,o)).replace(/'/g,'"');try{o=JSON.parse(i),t&&(o=gf(gf({},t),o))}catch(t){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),t),"".concat(e).concat(n).concat(i)}return delete o.defaultValue,e}for(o.applyPostProcessor=!1,delete o.defaultValue;n=this.nestingRegexp.exec(e);){var c=[],l=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){var u=n[1].split(this.formatSeparator).map((function(e){return e.trim()}));n[1]=u.shift(),c=u,l=!0}if((r=t(a.call(this,n[1].trim(),o),o))&&n[0]===e&&"string"!=typeof r)return r;"string"!=typeof r&&(r=qp(r)),r||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(e)),r=""),l&&(r=c.reduce((function(e,t){return i.format(e,t,s.lng,gf(gf({},s),{},{interpolationkey:n[1].trim()}))}),r.trim())),e=e.replace(n[0],r),this.regexp.lastIndex=0}return e}}]),e}();function vf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vf(Object(n),!0).forEach((function(t){Rp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var yf=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ip(this,e),this.logger=jp.create("formatter"),this.options=t,this.formats={number:function(e,t,n){return new Intl.NumberFormat(t,n).format(e)},currency:function(e,t,n){return new Intl.NumberFormat(t,_f(_f({},n),{},{style:"currency"})).format(e)},datetime:function(e,t,n){return new Intl.DateTimeFormat(t,_f({},n)).format(e)},relativetime:function(e,t,n){return new Intl.RelativeTimeFormat(t,_f({},n)).format(e,n.range||"day")},list:function(e,t,n){return new Intl.ListFormat(t,_f({},n)).format(e)}},this.init(t)}return Sp(e,[{key:"init",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||","}},{key:"add",value:function(e,t){this.formats[e.toLowerCase().trim()]=t}},{key:"format",value:function(e,t,n,r){var i=this,s=t.split(this.formatSeparator).reduce((function(e,t){var s=function(e){var t=e.toLowerCase().trim(),n={};if(e.indexOf("(")>-1){var r=e.split("(");t=r[0].toLowerCase().trim();var i=r[1].substring(0,r[1].length-1);"currency"===t&&i.indexOf(":")<0?n.currency||(n.currency=i.trim()):"relativetime"===t&&i.indexOf(":")<0?n.range||(n.range=i.trim()):i.split(";").forEach((function(e){if(e){var t=function(e){if(Array.isArray(e))return e}(s=e.split(":"))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(s)||function(e,t){if(e){if("string"==typeof e)return Np(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Np(e,t):void 0}}(s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),r=t[0],i=t.slice(1).join(":");"false"===i.trim()&&(n[r.trim()]=!1),"true"===i.trim()&&(n[r.trim()]=!0),isNaN(i.trim())||(n[r.trim()]=parseInt(i.trim(),10)),n[r.trim()]||(n[r.trim()]=i.trim())}var s}))}return{formatName:t,formatOptions:n}}(t),o=s.formatName,a=s.formatOptions;if(i.formats[o]){var c=e;try{var l=r&&r.formatParams&&r.formatParams[r.interpolationkey]||{},u=l.locale||l.lng||r.locale||r.lng||n;c=i.formats[o](e,u,_f(_f(_f({},a),r),l))}catch(e){i.logger.warn(e)}return c}return i.logger.warn("there was no format function for ".concat(o)),e}),e);return s}}]),e}();function wf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wf(Object(n),!0).forEach((function(t){Rp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var If=function(e){xp(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=Op(t);if(n){var i=Op(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Pp(this,e)});function i(e,t,n){var s,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Ip(this,i),s=r.call(this),Gp&&Fp.call(Tp(s)),s.backend=e,s.store=t,s.services=n,s.languageUtils=n.languageUtils,s.options=o,s.logger=jp.create("backendConnector"),s.state={},s.queue=[],s.backend&&s.backend.init&&s.backend.init(n,o.backend,o),s}return Sp(i,[{key:"queueLoad",value:function(e,t,n,r){var i=this,s=[],o=[],a=[],c=[];return e.forEach((function(e){var r=!0;t.forEach((function(t){var a="".concat(e,"|").concat(t);!n.reload&&i.store.hasResourceBundle(e,t)?i.state[a]=2:i.state[a]<0||(1===i.state[a]?o.indexOf(a)<0&&o.push(a):(i.state[a]=1,r=!1,o.indexOf(a)<0&&o.push(a),s.indexOf(a)<0&&s.push(a),c.indexOf(t)<0&&c.push(t)))})),r||a.push(e)})),(s.length||o.length)&&this.queue.push({pending:o,loaded:{},errors:[],callback:r}),{toLoad:s,pending:o,toLoadLanguages:a,toLoadNamespaces:c}}},{key:"loaded",value:function(e,t,n){var r=e.split("|"),i=r[0],s=r[1];t&&this.emit("failedLoading",i,s,t),n&&this.store.addResourceBundle(i,s,n),this.state[e]=t?-1:2;var o={};this.queue.forEach((function(n){var r,a,c,l,u;r=n.loaded,a=s,c=Wp(r,[i],Object),l=c.obj,u=c.k,l[u]=l[u]||[],l[u].push(a),function(e,t){for(var n=e.indexOf(t);-1!==n;)e.splice(n,1),n=e.indexOf(t)}(n.pending,e),t&&n.errors.push(t),0!==n.pending.length||n.done||(Object.keys(n.loaded).forEach((function(e){o[e]||(o[e]=[]),n.loaded[e].length&&n.loaded[e].forEach((function(t){o[e].indexOf(t)<0&&o[e].push(t)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",o),this.queue=this.queue.filter((function(e){return!e.done}))}},{key:"read",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:350,o=arguments.length>5?arguments[5]:void 0;return e.length?this.backend[n](e,t,(function(a,c){a&&c&&i<5?setTimeout((function(){r.read.call(r,e,t,n,i+1,2*s,o)}),s):o(a,c)})):o(null,{})}},{key:"prepareLoading",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);var s=this.queueLoad(e,t,r,i);if(!s.toLoad.length)return s.pending.length||i(),null;s.toLoad.forEach((function(e){n.loadOne(e)}))}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.split("|"),i=r[0],s=r[1];this.read(i,s,"read",void 0,void 0,(function(r,o){r&&t.logger.warn("".concat(n,"loading namespace ").concat(s," for language ").concat(i," failed"),r),!r&&o&&t.logger.log("".concat(n,"loaded namespace ").concat(s," for language ").concat(i),o),t.loaded(e,r,o)}))}},{key:"saveMissing",value:function(e,t,n,r,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(e,t,n,r,null,bf(bf({},s),{},{isUpdate:i})),e&&e[0]&&this.store.addResource(e[0],t,n,r))}}]),i}(Fp);function kf(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function Cf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cf(Object(n),!0).forEach((function(t){Rp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tf(){}var Ef=function(e){xp(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=Op(t);if(n){var i=Op(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Pp(this,e)});function i(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;if(Ip(this,i),e=r.call(this),Gp&&Fp.call(Tp(e)),e.options=kf(n),e.services={},e.logger=jp,e.modules={external:[]},t=Tp(e),Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach((function(e){"function"==typeof t[e]&&(t[e]=t[e].bind(t))})),s&&!e.isInitialized&&!n.isClone){if(!e.options.initImmediate)return e.init(n,s),Pp(e,Tp(e));setTimeout((function(){e.init(n,s)}),0)}return e}return Sp(i,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;"function"==typeof t&&(n=t,t={}),!t.defaultNS&&t.ns&&("string"==typeof t.ns?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));var r={debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};if("object"===bp(e[1])&&(t=e[1]),"string"==typeof e[1]&&(t.defaultValue=e[1]),"string"==typeof e[2]&&(t.tDescription=e[2]),"object"===bp(e[2])||"object"===bp(e[3])){var n=e[3]||e[2];Object.keys(n).forEach((function(e){t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:function(e,t,n,r){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}};function i(e){return e?"function"==typeof e?new e:e:null}if(this.options=Sf(Sf(Sf({},r),this.options),kf(t)),"v1"!==this.options.compatibilityAPI&&(this.options.interpolation=Sf(Sf({},r.interpolation),this.options.interpolation)),void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator),!this.options.isClone){var s;this.modules.logger?jp.init(i(this.modules.logger),this.options):jp.init(null,this.options),this.modules.formatter?s=this.modules.formatter:"undefined"!=typeof Intl&&(s=yf);var o=new cf(this.options);this.store=new ef(this.options.resources,this.options);var a=this.services;a.logger=jp,a.resourceStore=this.store,a.languageUtils=o,a.pluralResolver=new pf(o,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!s||this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format||(a.formatter=i(s),a.formatter.init(a,this.options),this.options.interpolation.format=a.formatter.format.bind(a.formatter)),a.interpolator=new mf(this.options),a.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},a.backendConnector=new If(i(this.modules.backend),a.resourceStore,a,this.options),a.backendConnector.on("*",(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.emit.apply(e,[t].concat(r))})),this.modules.languageDetector&&(a.languageDetector=i(this.modules.languageDetector),a.languageDetector.init(a,this.options.detection,this.options)),this.modules.i18nFormat&&(a.i18nFormat=i(this.modules.i18nFormat),a.i18nFormat.init&&a.i18nFormat.init(this)),this.translator=new of(this.services,this.options),this.translator.on("*",(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.emit.apply(e,[t].concat(r))})),this.modules.external.forEach((function(t){t.init&&t.init(e)}))}if(this.format=this.options.interpolation.format,n||(n=Tf),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&"dev"!==c[0]&&(this.options.lng=c[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments)}})),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments),e}}));var l=Up(),u=function(){var t=function(t,r){e.isInitialized&&!e.initializedStoreOnce&&e.logger.warn("init: i18next is already initialized. You should call init just once!"),e.isInitialized=!0,e.options.isClone||e.logger.log("initialized",e.options),e.emit("initialized",e.options),l.resolve(r),n(t,r)};if(e.languages&&"v1"!==e.options.compatibilityAPI&&!e.isInitialized)return t(null,e.t.bind(e));e.changeLanguage(e.options.lng,t)};return this.options.resources||!this.options.initImmediate?u():setTimeout(u,0),l}},{key:"loadResources",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tf,r="string"==typeof e?e:this.language;if("function"==typeof e&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(r&&"cimode"===r.toLowerCase())return n();var i=[],s=function(e){e&&t.services.languageUtils.toResolveHierarchy(e).forEach((function(e){i.indexOf(e)<0&&i.push(e)}))};r?s(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((function(e){return s(e)})),this.options.preload&&this.options.preload.forEach((function(e){return s(e)})),this.services.backendConnector.load(i,this.options.ns,n)}else n(null)}},{key:"reloadResources",value:function(e,t,n){var r=Up();return e||(e=this.languages),t||(t=this.options.ns),n||(n=Tf),this.services.backendConnector.reload(e,t,(function(e){r.resolve(),n(e)})),r}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&tf.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"changeLanguage",value:function(e,t){var n=this;this.isLanguageChangingTo=e;var r=Up();this.emit("languageChanging",e);var i=function(e){if(n.language=e,n.languages=n.services.languageUtils.toResolveHierarchy(e),n.resolvedLanguage=void 0,!(["cimode","dev"].indexOf(e)>-1))for(var t=0;t<n.languages.length;t++){var r=n.languages[t];if(!(["cimode","dev"].indexOf(r)>-1)&&n.store.hasLanguageSomeTranslations(r)){n.resolvedLanguage=r;break}}},s=function(s){e||s||!n.services.languageDetector||(s=[]);var o="string"==typeof s?s:n.services.languageUtils.getBestMatchFromCodes(s);o&&(n.language||i(o),n.translator.language||n.translator.changeLanguage(o),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(o)),n.loadResources(o,(function(e){!function(e,s){s?(i(s),n.translator.changeLanguage(s),n.isLanguageChangingTo=void 0,n.emit("languageChanged",s),n.logger.log("languageChanged",s)):n.isLanguageChangingTo=void 0,r.resolve((function(){return n.t.apply(n,arguments)})),t&&t(e,(function(){return n.t.apply(n,arguments)}))}(e,o)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(s):s(e):s(this.services.languageDetector.detect()),r}},{key:"getFixedT",value:function(e,t,n){var r=this,i=function e(t,i){var s;if("object"!==bp(i)){for(var o=arguments.length,a=new Array(o>2?o-2:0),c=2;c<o;c++)a[c-2]=arguments[c];s=r.options.overloadTranslationOptionHandler([t,i].concat(a))}else s=Sf({},i);s.lng=s.lng||e.lng,s.lngs=s.lngs||e.lngs,s.ns=s.ns||e.ns;var l=r.options.keySeparator||".",u=n?"".concat(n).concat(l).concat(t):t;return r.t(u,s)};return"string"==typeof e?i.lng=e:i.lngs=e,i.ns=t,i.keyPrefix=n,i}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var r=this.resolvedLanguage||this.languages[0],i=!!this.options&&this.options.fallbackLng,s=this.languages[this.languages.length-1];if("cimode"===r.toLowerCase())return!0;var o=function(e,n){var r=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===r||2===r};if(n.precheck){var a=n.precheck(this,o);if(void 0!==a)return a}return!!this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||!(!o(r,e)||i&&!o(s,e))}},{key:"loadNamespaces",value:function(e,t){var n=this,r=Up();return this.options.ns?("string"==typeof e&&(e=[e]),e.forEach((function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)})),this.loadResources((function(e){r.resolve(),t&&t(e)})),r):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var n=Up();"string"==typeof e&&(e=[e]);var r=this.options.preload||[],i=e.filter((function(e){return r.indexOf(e)<0}));return i.length?(this.options.preload=r.concat(i),this.loadResources((function(e){n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){return e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),e?["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr":"rtl"}},{key:"cloneInstance",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tf,r=Sf(Sf(Sf({},this.options),t),{isClone:!0}),s=new i(r);return["store","services","language"].forEach((function(t){s[t]=e[t]})),s.services=Sf({},this.services),s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s.translator=new of(s.services,s.options),s.translator.on("*",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];s.emit.apply(s,[e].concat(n))})),s.init(r,n),s.translator.options=s.options,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),i}(Fp);Rp(Ef,"createInstance",(function(){return new Ef(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}));var xf=Ef.createInstance();xf.createInstance=Ef.createInstance,xf.createInstance,xf.init,xf.loadResources,xf.reloadResources;var Pf=xf.use,Of=(xf.changeLanguage,xf.getFixedT,xf.t);xf.exists,xf.setDefaultNamespace,xf.hasLoadedNamespace,xf.loadNamespaces,xf.loadLanguages;const Rf=xf;var Nf=n(3824),Af=n.n(Nf),Df=Object.defineProperty,Lf=Object.getOwnPropertySymbols,Mf=Object.prototype.hasOwnProperty,jf=Object.prototype.propertyIsEnumerable,Ff=(e,t,n)=>t in e?Df(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Uf=(e,t)=>{for(var n in t||(t={}))Mf.call(t,n)&&Ff(e,n,t[n]);if(Lf)for(var n of Lf(t))jf.call(t,n)&&Ff(e,n,t[n]);return e};(({debug:e}={debug:!1})=>{const t=document.querySelector("#x_phrases");t&&Pf(Af()).init({lng:t.dataset.lang,debug:e,resources:{[t.dataset.lang]:{translation:Uf({},JSON.parse(t.value))}}})})();const qf=(e,...t)=>Of(e,{postProcess:"sprintf",sprintf:t}),Wf=(()=>{if(Intl&&Intl.NumberFormat){const e=Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY",currencyDisplay:"name"});return function(t){const n=parseFloat(t);return isNaN(n)?t:e.format(n)}}return function(e){return e}})();var Bf=Object.defineProperty,$f=Object.defineProperties,Vf=Object.getOwnPropertyDescriptors,zf=Object.getOwnPropertySymbols,Hf=Object.prototype.hasOwnProperty,Kf=Object.prototype.propertyIsEnumerable,Yf=(e,t,n)=>t in e?Bf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Gf extends(L()){constructor(e,t,n,r,i,s,o,a){super(),this.state={shop:{shopId:"",name:"",logo:null,text:null},theme:{mainColor:"#ffffff",textColor:"#000000"},payload:null,status:"normal",roomId:null,messages:[],imageUrls:[]},this.needsUpdateNotification=!1,this.state.shop={shopId:e,name:n,logo:r,text:i},this.state.theme={mainColor:s,textColor:o},this.state.status=t,this.state.imageUrls=[],this.state.payload=a}static set(e,t,n,r,i,s,o,a){const c=(l=a)?{id:l.item_id,url:l.item_url,title:l.title,price:l.price,imageUrl:l.image_url}:null;var l;Gf.instance=new Gf(e,t,n,r,i,s,o,c)}async ping(){if(t=((e,t)=>{for(var n in t||(t={}))Hf.call(t,n)&&Yf(e,n,t[n]);if(zf)for(var n of zf(t))Kf.call(t,n)&&Yf(e,n,t[n]);return e})({},d),e=$f(t,Vf({customerPollingIntervals:{message:6e4}})),h=u(u({},h),e),this.state.roomId)return;var e,t;const{roomId:n,notification:r}=await(async(e,t=new lp(e))=>{var n;const r=await t.ping(e),i=null==(n=r.room)?void 0:n.uniqueId;return i?{roomId:i,notification:r.notificationSetting}:{roomId:null,notification:!1}})(this.state.shop.shopId);return n?(this.state.roomId=n,this.client=await yp(this.state.shop.shopId,n)):this.client=await yp(this.state.shop.shopId),this.client.stream.on("value",(e=>{this.state.messages=e,this.emit("update")})),this.needsUpdateNotification=!r,n}async post(e,t,n){const r=((e,t=[],n=null)=>{let r=null;n&&(r=C(k({},n),{text:e}));const i=r?3:0,s=t.map((e=>({url:e})));return{id:"".concat(T--),type:i,text:e,payload:r,images:s,posted:new Date,own:!0,sync:"waiting"}})(e,t,n);this.state.imageUrls=[],this.postMessage(r)}async postMessage(e){if(null===this.state.roomId)try{const e=await(async(e,t,n=new lp(t))=>{const r=await n.createRoom(t);if(200===r.status){const t=r.room.uniqueId,i=new F(t,n);return e.id=t,Qd(e.stream,i),await i.start(),t}throw new Error})(this.client,this.state.shop.shopId);this.state.roomId=e}catch(e){return void window.alert(qf("apps.message.system_error"))}await(async(e,t,n,r=new lp(t))=>{if(e.id){e.stream.has(n.id)||wp(e,n);try{const t=(n.payload||{}).id,i=await r.post(n.type,n.text,n.images.map((e=>e.url)),e.id,t);if(200!==i.status)throw new Error;const s=E(i.message);wp(e,_p(vp({},s),{localId:n.id}),"synced")}catch(t){wp(e,n,"failed")}}})(this.client,this.state.shop.shopId,e),this.removePayload()}async uploadImage(e){const t=new lp(this.state.shop.shopId),n=await t.uploadTmpImage(e);this.state.imageUrls.push(n.image.url)}async deleteImage(e,t){await(async(e,t,n,r,i=new lp(t))=>{var s;wp(e,vp({},n),"syncing");try{const t=e.id;if(!t)return;if(200!==(await i.deleteImage(t,r)).status)throw new Error;null==(s=n.images)||s.forEach((e=>{e.id===String(r)&&(e.isDeleted=!0,e.url="")}))}finally{wp(e,vp({},n),"synced")}})(this.client,this.state.shop.shopId,e,t)}removePayload(){this.state.payload=null}}class Jf extends i{constructor(){super(),this.forms={mail:{placeholder:"email@example.com",type:"email"},sms:{placeholder:"09012345678",type:"tel"}}}get store(){return Gf.instance}static needsUpdateNotif(){return"readonly"!=Gf.instance.state.status&&Gf.instance.needsUpdateNotification}render(){return this.$el=r()("<div></div>").append(r()(`\n<div class="msg_smsAuth">\n    <h3 class="msg_smsAuth__title">${qf("apps.message.receive_notifications_title")}</h3>\n    <p class="msg_smsAuth__text">${qf("apps.message.receive_notifications_body")}</p>\n    <div class="x_content msg_smsAuth__selectDialog">\n        <div class="section-">\n            <input class="x_types section-radio" id="tab1" name="tab" type="radio" value="1" data-type="mail" checked>\n            <label class="section-name section-one" for="tab1">${qf("apps.message.receive_notifications_mail")}</label>\n            <input class="x_types section-radio" id="tab2" name="tab" type="radio" value="2" data-type="sms">\n            <label class="section-name section-two" for="tab2">${qf("apps.message.receive_notifications_sms")}</label>\n            <div class="section-content">\n                <div class="msg_smsAuth__formArea">\n                    <input class="x_address" placeholder="email@example.com" type="email">\n                    <button class="x_submit" disabled>${qf("apps.message.receive_notifications_done")}</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>`)),this.$types=this.$el.find("input.x_types"),this.$address=this.$el.find("input.x_address"),this.$submit=this.$el.find("button.x_submit"),this.$types.on("change",(()=>{this.$types&&this.$address&&("mail"==this.$types.filter(":checked").attr("data-type")?(this.$address.attr("placeholder",this.forms.mail.placeholder),this.$address.prop("type",this.forms.mail.type)):(this.$address.attr("placeholder",this.forms.sms.placeholder),this.$address.prop("type",this.forms.sms.type)))})),this.store.state.roomId&&this.$submit.removeAttr("disabled"),this.store.on("update",(()=>{var e;null==(e=this.$submit)||e.removeAttr("disabled")})),this.$submit.on("click",(e=>{e.preventDefault(),this.submit()})),this}submit(){if(this.$address&&this.$types){let e=Number(this.$types.filter(":checked").val()),t=Gf.instance.state.roomId,n=this.$address.val();new lp(this.store.state.shop.shopId).updateNotificationMethod(t,e,n).then((e=>{this.complete(e.updated)}),(e=>{this.rejected(e.message)}))}}complete(e){this.$el&&(this.$el.find(".msg_smsAuth").remove(),this.$el.append(`\n<div class="msg_smsAuth">\n    <h3 class="msg_smsAuth__title">${qf("apps.message.complete_notifications_setting_title")}</h3>\n    <p class="x_addressComplete msg_smsAuth__text"></p>\n    <p class="msg_smsAuth__text">${qf("apps.message.complete_notifications_setting_body")}</p>\n</div>`),this.$el.find(".x_addressComplete").text(this.$address.val()),localStorage.setItem("BASE.message.updateNotif",`${e}`))}rejected(e){if(this.$el){const t=this.$el.find(".x_content");t.find(".msg_smsAuth__error").remove(),t.append(r()(`<div class="msg_smsAuth__error">${e||"登録に失敗しました。入力内容に間違いがないか確認してください。"}</div>`))}}}class Qf extends i{constructor(){super(),this.userScalable=!1,this.viewportOrigin=null}static instance(){return Qf._instance||(Qf._instance=new Qf),Qf._instance}render(){this.$el=$('\n<div class="msg_messageModal">\n    <div class="msg_messageModal__bg x_bg">\n        <div class="x_container">\n        </div>\n    </div>\n</div>\n'),this.$el.find(".x_bg").on("click",(()=>this.close()));const e=this.$el.find(".x_container");return e.on("click",(e=>{e.stopPropagation()})),this.container=e,this.close(),this}show(e){this.container.append(e),this.setViewport(),this.open()}open(){this.$el&&this.$el.css("display","block")}close(){this.$el&&this.$el.css("display","none"),this.resetViewport(),this.clear()}clear(){this.container.empty()}setHeight(){if(!this.$el)return;const e=document.body.clientHeight;this.$el.css("height",`${e}px`),this.$el.find(".x_bg").css("height",e-32+"px")}setViewport(){if(!this.userScalable)return;const e=document.querySelector("meta[name='viewport']"),t=null==e?void 0:e.getAttribute("content");if(e&&t){this.viewportOrigin=t;const n=this.viewportOrigin.replace(/[, ]*user-scalable=no/,"").replace(/[, ]*maximum-scale=[\d\.]+/,"");e.setAttribute("content",n)}}resetViewport(){if(this.userScalable&&this.viewportOrigin){const e=document.querySelector("meta[name='viewport']");null==e||e.setAttribute("content",this.viewportOrigin)}}enableUserScalable(){this.userScalable=!0}}class Xf{static show(e){this.modal=Qf.instance();const t=$('\n<div>\n    <div class="msg_messageModal__close x_close"><span class="appsicon-cross"></span></div>\n    <img class="msg_messageModal__img x_img" />\n</div>\n');t.find(".x_close").on("click",(()=>{window.removeEventListener("change",this.watchHeight),this.modal.close()})),this.img=t.find(".x_img"),this.img.attr("src",e),this.mql=window.matchMedia("(max-width: 480px)"),window.addEventListener("resize",this.watchHeight),this.mql.matches&&this.setHeight(),this.modal.enableUserScalable(),this.modal.show(t)}static watchHeight(){const e=window.innerHeight;this.mql&&this.mql.matches&&this.height!==e&&(this.height=e,this.setHeight())}static setHeight(){setTimeout((()=>{const e=document.body.clientHeight;this.modal.setHeight(),this.img.css("max-height",e-50+"px")}),50)}}Xf.height=0;class Zf{static show(e,t){const n=Qf.instance(),r=$(`\n<div class="msg_imgDeleteModal">\n    <h2 class="msg_imgDeleteModal__title">${(i=qf)("apps.message.img_delete_dialog")}</h2>\n    <div class="msg_imgDeleteModal__actions">\n        <div class="msg_imgDeleteModal__action msg_imgDeleteModal__cancel">${i("apps.message.action_cancel")}</div>\n        <span class="msg_imgDeleteModal__space"></span>\n        <div class="msg_imgDeleteModal__action msg_imgDeleteModal__delete">${i("apps.message.action_delete")}</div>\n    </div>\n</div>\n`);var i;r.on("click",(e=>{e.stopPropagation()})),r.find(".msg_imgDeleteModal__cancel").on("click",(()=>{n.close()}));const s=r.find(".msg_imgDeleteModal__delete");s.on("click",(async()=>{const r=Gf.instance;r&&(r.deleteImage(e,t).then((()=>{window.alert(qf("apps.message.img_delete_success"))})).catch((()=>{window.alert(qf("apps.message.system_error"))})).finally((()=>{n.close()})),s.html('<img width="20px" src="https://static.thebase.in/shop/loading-circle.svg" />'))})),n.show(r)}}function eg(e){p(1,arguments);var t=f(e);return t.setHours(0,0,0,0),t}var tg={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function ng(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}var rg={date:ng({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:ng({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:ng({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},ig={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function sg(e){return function(t,n){var r,i=n||{};if("formatting"===(i.context?String(i.context):"standalone")&&e.formattingValues){var s=e.defaultFormattingWidth||e.defaultWidth,o=i.width?String(i.width):s;r=e.formattingValues[o]||e.formattingValues[s]}else{var a=e.defaultWidth,c=i.width?String(i.width):e.defaultWidth;r=e.values[c]||e.values[a]}return r[e.argumentCallback?e.argumentCallback(t):t]}}function og(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.width,i=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;var o,a=s[0],c=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(c)?function(e,t){for(var n=0;n<e.length;n++)if(e[n].test(a))return n}(c):function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&e[n].test(a))return n}(c);return o=e.valueCallback?e.valueCallback(l):l,{value:o=n.valueCallback?n.valueCallback(o):o,rest:t.slice(a.length)}}}function ag(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.match(e.matchPattern);if(!r)return null;var i=r[0],s=t.match(e.parsePattern);if(!s)return null;var o=e.valueCallback?e.valueCallback(s[0]):s[0];return{value:o=n.valueCallback?n.valueCallback(o):o,rest:t.slice(i.length)}}}const cg={code:"en-US",formatDistance:function(e,t,n){var r,i=tg[e];return r="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",t.toString()),null!=n&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},formatLong:rg,formatRelative:function(e,t,n,r){return ig[e]},localize:{ordinalNumber:function(e,t){var n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:sg({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:sg({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:sg({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:sg({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:sg({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:ag({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:og({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:og({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:og({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:og({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:og({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function lg(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function ug(e,t){for(var n=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return n+r}const hg=function(e,t){var n=e.getUTCFullYear(),r=n>0?n:1-n;return ug("yy"===t?r%100:r,t.length)},dg=function(e,t){var n=e.getUTCMonth();return"M"===t?String(n+1):ug(n+1,2)},pg=function(e,t){return ug(e.getUTCDate(),t.length)},fg=function(e,t){return ug(e.getUTCHours()%12||12,t.length)},gg=function(e,t){return ug(e.getUTCHours(),t.length)},mg=function(e,t){return ug(e.getUTCMinutes(),t.length)},vg=function(e,t){return ug(e.getUTCSeconds(),t.length)},_g=function(e,t){var n=t.length,r=e.getUTCMilliseconds();return ug(Math.floor(r*Math.pow(10,n-3)),t.length)};function yg(e){p(1,arguments);var t=f(e),n=t.getUTCDay(),r=(n<1?7:0)+n-1;return t.setUTCDate(t.getUTCDate()-r),t.setUTCHours(0,0,0,0),t}function wg(e){p(1,arguments);var t=f(e),n=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(n+1,0,4),r.setUTCHours(0,0,0,0);var i=yg(r),s=new Date(0);s.setUTCFullYear(n,0,4),s.setUTCHours(0,0,0,0);var o=yg(s);return t.getTime()>=i.getTime()?n+1:t.getTime()>=o.getTime()?n:n-1}function bg(e,t){p(1,arguments);var n=t||{},r=n.locale,i=r&&r.options&&r.options.weekStartsOn,s=null==i?0:lg(i),o=null==n.weekStartsOn?s:lg(n.weekStartsOn);if(!(o>=0&&o<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var a=f(e),c=a.getUTCDay(),l=(c<o?7:0)+c-o;return a.setUTCDate(a.getUTCDate()-l),a.setUTCHours(0,0,0,0),a}function Ig(e,t){p(1,arguments);var n=f(e),r=n.getUTCFullYear(),i=t||{},s=i.locale,o=s&&s.options&&s.options.firstWeekContainsDate,a=null==o?1:lg(o),c=null==i.firstWeekContainsDate?a:lg(i.firstWeekContainsDate);if(!(c>=1&&c<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var l=new Date(0);l.setUTCFullYear(r+1,0,c),l.setUTCHours(0,0,0,0);var u=bg(l,t),h=new Date(0);h.setUTCFullYear(r,0,c),h.setUTCHours(0,0,0,0);var d=bg(h,t);return n.getTime()>=u.getTime()?r+1:n.getTime()>=d.getTime()?r:r-1}function kg(e,t){var n=e>0?"-":"+",r=Math.abs(e),i=Math.floor(r/60),s=r%60;return 0===s?n+String(i):n+String(i)+t+ug(s,2)}function Cg(e,t){return e%60==0?(e>0?"-":"+")+ug(Math.abs(e)/60,2):Sg(e,t)}function Sg(e,t){var n=t||"",r=e>0?"-":"+",i=Math.abs(e);return r+ug(Math.floor(i/60),2)+n+ug(i%60,2)}const Tg={G:function(e,t,n){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){var r=e.getUTCFullYear(),i=r>0?r:1-r;return n.ordinalNumber(i,{unit:"year"})}return hg(e,t)},Y:function(e,t,n,r){var i=Ig(e,r),s=i>0?i:1-i;return"YY"===t?ug(s%100,2):"Yo"===t?n.ordinalNumber(s,{unit:"year"}):ug(s,t.length)},R:function(e,t){return ug(wg(e),t.length)},u:function(e,t){return ug(e.getUTCFullYear(),t.length)},Q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return ug(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return ug(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){var r=e.getUTCMonth();switch(t){case"M":case"MM":return dg(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return ug(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){var i=function(e,t){p(1,arguments);var n=f(e),r=bg(n,t).getTime()-function(e,t){p(1,arguments);var n=t||{},r=n.locale,i=r&&r.options&&r.options.firstWeekContainsDate,s=null==i?1:lg(i),o=null==n.firstWeekContainsDate?s:lg(n.firstWeekContainsDate),a=Ig(e,t),c=new Date(0);return c.setUTCFullYear(a,0,o),c.setUTCHours(0,0,0,0),bg(c,t)}(n,t).getTime();return Math.round(r/6048e5)+1}(e,r);return"wo"===t?n.ordinalNumber(i,{unit:"week"}):ug(i,t.length)},I:function(e,t,n){var r=function(e){p(1,arguments);var t=f(e),n=yg(t).getTime()-function(e){p(1,arguments);var t=wg(e),n=new Date(0);return n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0),yg(n)}(t).getTime();return Math.round(n/6048e5)+1}(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):ug(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):pg(e,t)},D:function(e,t,n){var r=function(e){p(1,arguments);var t=f(e),n=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=n-t.getTime();return Math.floor(r/864e5)+1}(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):ug(r,t.length)},E:function(e,t,n){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){var i=e.getUTCDay(),s=(i-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return ug(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){var i=e.getUTCDay(),s=(i-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return ug(s,t.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,n){var r=e.getUTCDay(),i=0===r?7:r;switch(t){case"i":return String(i);case"ii":return ug(i,t.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){var r,i=e.getUTCHours();switch(r=12===i?"noon":0===i?"midnight":i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){var r,i=e.getUTCHours();switch(r=i>=17?"evening":i>=12?"afternoon":i>=4?"morning":"night",t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){var r=e.getUTCHours()%12;return 0===r&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return fg(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):gg(e,t)},K:function(e,t,n){var r=e.getUTCHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):ug(r,t.length)},k:function(e,t,n){var r=e.getUTCHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):ug(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):mg(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):vg(e,t)},S:function(e,t){return _g(e,t)},X:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();if(0===i)return"Z";switch(t){case"X":return Cg(i);case"XXXX":case"XX":return Sg(i);default:return Sg(i,":")}},x:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"x":return Cg(i);case"xxxx":case"xx":return Sg(i);default:return Sg(i,":")}},O:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+kg(i,":");default:return"GMT"+Sg(i,":")}},z:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+kg(i,":");default:return"GMT"+Sg(i,":")}},t:function(e,t,n,r){var i=r._originalDate||e;return ug(Math.floor(i.getTime()/1e3),t.length)},T:function(e,t,n,r){return ug((r._originalDate||e).getTime(),t.length)}};function Eg(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}}function xg(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}}var Pg={p:xg,P:function(e,t){var n,r=e.match(/(P+)(p+)?/)||[],i=r[1],s=r[2];if(!s)return Eg(e,t);switch(i){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",Eg(i,t)).replace("{{time}}",xg(s,t))}};const Og=Pg;var Rg=["D","DD"],Ng=["YY","YYYY"];function Ag(e,t,n){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://git.io/fxCyr"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://git.io/fxCyr"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://git.io/fxCyr"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://git.io/fxCyr"))}var Dg=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Lg=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Mg=/^'([^]*?)'?$/,jg=/''/g,Fg=/[a-zA-Z]/;function Ug(e,t,n){p(2,arguments);var r=String(t),i=n||{},s=i.locale||cg,o=s.options&&s.options.firstWeekContainsDate,a=null==o?1:lg(o),c=null==i.firstWeekContainsDate?a:lg(i.firstWeekContainsDate);if(!(c>=1&&c<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var l=s.options&&s.options.weekStartsOn,u=null==l?0:lg(l),h=null==i.weekStartsOn?u:lg(i.weekStartsOn);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!s.localize)throw new RangeError("locale must contain localize property");if(!s.formatLong)throw new RangeError("locale must contain formatLong property");var d=f(e);if(!function(e){if(p(1,arguments),!function(e){return p(1,arguments),e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)}(e)&&"number"!=typeof e)return!1;var t=f(e);return!isNaN(Number(t))}(d))throw new RangeError("Invalid time value");var g=function(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}(d),m=function(e,t){return p(2,arguments),function(e,t){p(2,arguments);var n=f(e).getTime(),r=lg(t);return new Date(n+r)}(e,-lg(t))}(d,g),v={firstWeekContainsDate:c,weekStartsOn:h,locale:s,_originalDate:d};return r.match(Lg).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,Og[t])(e,s.formatLong,v):e})).join("").match(Dg).map((function(n){if("''"===n)return"'";var r=n[0];if("'"===r)return n.match(Mg)[1].replace(jg,"'");var o,a=Tg[r];if(a)return i.useAdditionalWeekYearTokens||(o=n,-1===Ng.indexOf(o))||Ag(n,t,e),!i.useAdditionalDayOfYearTokens&&function(e){return-1!==Rg.indexOf(e)}(n)&&Ag(n,t,e),a(m,n,s.localize,v);if(r.match(Fg))throw new RangeError("Format string contains an unescaped latin alphabet character `"+r+"`");return n})).join("")}var qg={lessThanXSeconds:{one:"1秒未満",other:"{{count}}秒未満",oneWithSuffix:"約1秒",otherWithSuffix:"約{{count}}秒"},xSeconds:{one:"1秒",other:"{{count}}秒"},halfAMinute:"30秒",lessThanXMinutes:{one:"1分未満",other:"{{count}}分未満",oneWithSuffix:"約1分",otherWithSuffix:"約{{count}}分"},xMinutes:{one:"1分",other:"{{count}}分"},aboutXHours:{one:"約1時間",other:"約{{count}}時間"},xHours:{one:"1時間",other:"{{count}}時間"},xDays:{one:"1日",other:"{{count}}日"},aboutXWeeks:{one:"約1週間",other:"約{{count}}週間"},xWeeks:{one:"1週間",other:"{{count}}週間"},aboutXMonths:{one:"約1か月",other:"約{{count}}か月"},xMonths:{one:"1か月",other:"{{count}}か月"},aboutXYears:{one:"約1年",other:"約{{count}}年"},xYears:{one:"1年",other:"{{count}}年"},overXYears:{one:"1年以上",other:"{{count}}年以上"},almostXYears:{one:"1年近く",other:"{{count}}年近く"}};var Wg={date:ng({formats:{full:"y年M月d日EEEE",long:"y年M月d日",medium:"y/MM/dd",short:"y/MM/dd"},defaultWidth:"full"}),time:ng({formats:{full:"H時mm分ss秒 zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},defaultWidth:"full"}),dateTime:ng({formats:{full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},defaultWidth:"full"})},Bg={lastWeek:"先週のeeeeのp",yesterday:"昨日のp",today:"今日のp",tomorrow:"明日のp",nextWeek:"翌週のeeeeのp",other:"P"};const $g={code:"ja",formatDistance:function(e,t,n){var r;n=n||{};var i=qg[e];return r="string"==typeof i?i:1===t?n.addSuffix&&i.oneWithSuffix?i.oneWithSuffix:i.one:n.addSuffix&&i.otherWithSuffix?i.otherWithSuffix.replace("{{count}}",String(t)):i.other.replace("{{count}}",String(t)),n.addSuffix?n.comparison&&n.comparison>0?r+"後":r+"前":r},formatLong:Wg,formatRelative:function(e,t,n,r){return Bg[e]},localize:{ordinalNumber:function(e,t){var n=Number(e);switch(String((t||{}).unit)){case"year":return"".concat(n,"年");case"quarter":return"第".concat(n,"四半期");case"month":return"".concat(n,"月");case"week":return"第".concat(n,"週");case"date":return"".concat(n,"日");case"hour":return"".concat(n,"時");case"minute":return"".concat(n,"分");case"second":return"".concat(n,"秒");default:return"".concat(n)}},era:sg({values:{narrow:["BC","AC"],abbreviated:["紀元前","西暦"],wide:["紀元前","西暦"]},defaultWidth:"wide"}),quarter:sg({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["第1四半期","第2四半期","第3四半期","第4四半期"]},defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:sg({values:{narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wide:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},defaultWidth:"wide"}),day:sg({values:{narrow:["日","月","火","水","木","金","土"],short:["日","月","火","水","木","金","土"],abbreviated:["日","月","火","水","木","金","土"],wide:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"]},defaultWidth:"wide"}),dayPeriod:sg({values:{narrow:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},abbreviated:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},wide:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"}},defaultWidth:"wide",formattingValues:{narrow:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},abbreviated:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},wide:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:ag({matchPattern:/^第?\d+(年|四半期|月|週|日|時|分|秒)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:og({matchPatterns:{narrow:/^(B\.?C\.?|A\.?D\.?)/i,abbreviated:/^(紀元[前後]|西暦)/i,wide:/^(紀元[前後]|西暦)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^B/i,/^A/i],any:[/^(紀元前)/i,/^(西暦|紀元後)/i]},defaultParseWidth:"any"}),quarter:og({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^Q[1234]/i,wide:/^第[1234一二三四１２３４]四半期/i},defaultMatchWidth:"wide",parsePatterns:{any:[/(1|一|１)/i,/(2|二|２)/i,/(3|三|３)/i,/(4|四|４)/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:og({matchPatterns:{narrow:/^([123456789]|1[012])/,abbreviated:/^([123456789]|1[012])月/i,wide:/^([123456789]|1[012])月/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^1\D/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},defaultParseWidth:"any"}),day:og({matchPatterns:{narrow:/^[日月火水木金土]/,short:/^[日月火水木金土]/,abbreviated:/^[日月火水木金土]/,wide:/^[日月火水木金土]曜日/},defaultMatchWidth:"wide",parsePatterns:{any:[/^日/,/^月/,/^火/,/^水/,/^木/,/^金/,/^土/]},defaultParseWidth:"any"}),dayPeriod:og({matchPatterns:{any:/^(AM|PM|午前|午後|正午|深夜|真夜中|夜|朝)/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^(A|午前)/i,pm:/^(P|午後)/i,midnight:/^深夜|真夜中/i,noon:/^正午/i,morning:/^朝/i,afternoon:/^午後/i,evening:/^夜/i,night:/^深夜/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};class Vg extends i{constructor(){super(...arguments),this.rendered=!1,this.lastPostedDate=new Date(0),this.dateViews=[]}get store(){return Gf.instance}render(){return this.$el=r()('<ul class="msg_messageList"><li class="x_welcomeText msg_messageList__welcomeMsg"></li></ul>'),this.store.state.shop.text&&this.$el.find(".x_welcomeText").text(this.store.state.shop.text),this.updateView(),this.store.on("update",(()=>{this.updateView()})),this}updateView(){const e=this.store.state.messages;this.updateDates(),e.forEach((e=>{this.updateMessage(e)||(eg(e.posted)>eg(this.lastPostedDate)&&(this.lastPostedDate=e.posted,this.appendDate(this.lastPostedDate)),this.appendMessage(e,this.rendered))})),e.length>0&&!this.rendered&&(this.showUpdateNotif(),this.scrollToBottom(!1),this.rendered=!0)}updateMessage(e){let t=this.children.filter((t=>!!t.equal&&t.equal(e)));return t.length>0&&(t[0].update(e),!0)}appendMessage(e,t){let n=!1;this.$el&&t&&(n=this.$el.scrollTop()+this.$el.prop("clientHeight")+30>this.$el.prop("scrollHeight"));let r=new Hg(e);this.append(r),n&&this.scrollToBottom(!0)}updateDates(){this.dateViews.forEach((e=>e.update()))}appendDate(e){let t=new Kg(e);this.dateViews.push(t),this.append(t)}scrollToBottom(e){this.$el&&(e?this.$el.animate({scrollTop:this.$el.prop("scrollHeight")},"fast"):setTimeout((()=>{this.$el.scrollTop(this.$el.prop("scrollHeight"))}),0))}showUpdateNotif(){if(Jf.needsUpdateNotif()){let e=new Jf;this.append(e)}}}const zg={customer:'\n<li class="msg_messageList__unit msg_messageList__unit--own">\n    <div class="x_text msg_messageList__post" style="white-space: pre-wrap"></div>\n    <div class="x_image msg_messageList__image"></div>\n    <div class="x_status"></div>\n</li>',customerItem:'\n    <div class="msg_messageList__post c-messageItemBox">\n        <a class="x_link c-messageItemBox__link">\n            <div class="c-messageItemBox__link__itemBoxImg">\n                <img class="x_image"/>\n            </div>\n            <div class="c-messageItemBox__link__itemBoxInfo">\n                <div class="title x_title c-messageItemBox__link__itemBoxInfo__title"></div>\n                <div class="price x_price c-messageItemBox__link__itemBoxInfo__price"></div>\n            </div>\n        </a>\n    </div>',owner:'\n<li class="msg_messageList__unit msg_messageList__unit--owner">\n    <div class="x_icon msg_messageList__icon"></div>\n    <div class="msg_messageList__balloon">\n        <div class="x_text msg_messageList__post" style="white-space: pre-wrap"></div>\n        <div class="x_image msg_messageList__image"></div>\n        <div class="x_status"></div>\n    </div>\n</li>',indicator:`\n<div class="msg_messageList__sending">\n    <p class="msg_messageList__sendingText">${qf("apps.message.sending")}</p>\n    <div class="msg_messageList__loader">\n        <svg class="circular-loader" viewBox="25 25 50 50" >\n            <circle class="loader-path" cx="50" cy="50" r="20" fill="none" stroke="#97a1b0" stroke-width="4" />\n        </svg>\n    </div>\n</div>`,image:'\n<div class="msg_messageList__imageContainer">\n    <img class="msg_messageList__postImage" style="display: none" />\n    <div class="msg_messageList__postImage msg_messageList__imagePlaceholder">\n        <span class="appsicon-image"></span>\n    </div>\n    <span class="appsicon-crossCircle msg_messageList__deleteIcon"></span>\n</div>',error:'<div class="msg_messageList__caution"><span class="appsicon-information"></span>\n    <span class="msg_failed"></span><p class="msg_resend"><span class="msg_resend__link"></span><span class="msg_resend__period"></span></p>\n</div>',time:'<p class="x_time msg_messageList__time"></p>',date:'<li class="msg_messageList__date"></li>'};class Hg extends i{constructor(e){super(),this.message=e,this.isResending=!1}get shop(){return Gf.instance.state.shop}get theme(){return Gf.instance.state.theme}get hasImages(){return!!this.message.images&&this.message.images.length>0}get image(){return this.message.images[0]}equal(e){return P(this.message,e)}render(){if(this.message.own){if(this.$el=r()(zg.customer),this.message.type==S.Item){const e=this.message.payload;e&&(r()(zg.customerItem).insertBefore(this.$el.find(".msg_messageList__post")),this.$el.find(".x_link").attr("href",e.url||null),this.$el.find(".x_image").attr("src",e.imageUrl||null),this.$el.find(".x_title").text(e.title||""),this.$el.find(".x_price").text(Wf((e.price||0).toString())))}}else this.$el=r()(zg.owner);if(!this.$el)return this;if(this.message.own)this.$el.find(".msg_messageList__post").css({cssText:`background-color: ${this.theme.mainColor} !important; color: ${this.theme.textColor} !important`}),this.$el.find(".msg_messageList__post a").css({cssText:`color: ${this.theme.textColor} !important`});else{let e=this.shop.logo;e&&e.length>0&&this.$el.find(".x_icon").append(r()(`<img src="${e}" class="msg_messageList__iconImg" />`))}let e=this.$el.find(".x_text");return e.length>0&&this.message.text&&this.message.text.length>0?(e.text(this.message.text),e.html(e.html().replace(/(https?:\/\/[a-zA-Z0-9\-_.:@!~*'(¥);/?&=+$,%#]+)/g,'<a href=$1 target="_blank">$1</a>'))):e.remove(),this.renderImage(),this.$status=this.$el.find(".x_status"),this.renderStatus(),this}update(e){this.message=e,this.updateImage(),this.renderStatus()}buildImage(){const e=r()(zg.image),t=e.find("img.msg_messageList__postImage"),n=e.find(".msg_messageList__imagePlaceholder");e.data("image-id",this.image.id||""),e.data("image-deleted",this.image.isDeleted||!1),this.image.isDeleted?(t.remove(),n.remove(),e.html(`<p class="msg_messageList__systemMessage">${qf("apps.message.img_deleted_text")}</p>`)):(t.attr("src",this.image.url),t.on("click",(()=>{Xf.show(this.image.url)})),t.on("load",(()=>{t.show(),n.remove()})));const i=e.find(".msg_messageList__deleteIcon");return i.on("click",(()=>{Zf.show(this.message,Number(this.image.id))})),this.message.own&&this.image.id&&!this.image.isDeleted||i.hide(),e}renderImage(){if(!this.$el)return;let e=this.$el.find(".x_image");if(e.length>0&&this.hasImages){const t=this.buildImage();e.empty().append(t)}}updateImage(){if(!this.$el)return;let e=this.$el.find(".x_image");if(e.length>0&&this.hasImages){const t=e.find(".msg_messageList__imageContainer"),n=t.find(".msg_messageList__deleteIcon"),r=t.data("image-id"),i=t.data("image-deleted");this.image.id&&this.image.id!==r?(t.data("image-id",this.image.id),n.show()):this.image.isDeleted&&this.image.isDeleted!==i&&(n.show(),t.data("image-deleted",this.image.isDeleted),t.html(`<p class="msg_messageList__systemMessage">${qf("apps.message.img_deleted_text")}</p>`))}}renderStatus(){if(this.$status)if(this.$status.children().remove(),"failed"==this.message.sync){let e=r()(zg.error),t="";t=this.hasImages?this.message.text&&this.message.text.length>0?qf("apps.message.failed.text_and_image"):qf("apps.message.failed.image"):qf("apps.message.failed.text"),e.find(".msg_failed").text(t),e.find(".msg_resend__period").text(qf("apps.message.period"));const n=e.find(".msg_resend__link");n.text(qf("apps.message.resend")),n.on("click",(()=>{const e=Gf.instance;e&&!this.isResending&&(this.isResending=!0,e.postMessage(this.message).finally((()=>{this.isResending=!1})))})),this.$status.append(e)}else if("syncing"==this.message.sync){let e=r()(zg.indicator);this.$status.append(e)}else{let e=r()(zg.time).append(Ug(this.message.posted,"HH:mm"));this.$status.append(e)}}}class Kg extends i{constructor(e){super(),this.date=e}get formattedDate(){if(function(e){return p(1,arguments),function(e,t){p(2,arguments);var n=eg(e),r=eg(t);return n.getTime()===r.getTime()}(e,Date.now())}(this.date))return qf("apps.message.today");if(function(e){return p(1,arguments),function(e,t){p(2,arguments);var n=f(e),r=f(t);return n.getFullYear()===r.getFullYear()}(e,Date.now())}(this.date)){const e="en"===Rf.language?{}:{locale:$g};return Ug(this.date,"MM/dd eeee",e)}return Ug(this.date,"yyyy/MM/dd")}render(){return this.$el=r()(zg.date).append(this.formattedDate),this}update(){var e;null==(e=this.$el)||e.text(this.formattedDate)}}let Yg=`\n<div class="msg_messenger__header">\n    <h1 class="x_shopName msg_messenger__shopName">{{ shopName }}</h1>\n    <div id="x_startClose" class="msg_messenger__closeBtn">\n      <div>\n          <span class="appsicon-cross"></span>\n      </div>\n    </div>\n</div>\n<div class="x_error msg_messenger__disconnect" hidden>\n  ${qf("apps.message.fatal_error")}\n</div>\n`;class Gg extends i{constructor(e){super(),this.delegate=e}get shop(){return Gf.instance.state.shop}get theme(){return Gf.instance.state.theme}render(){return this.$el=r()(Yg),this.$el.find(".x_shopName").text(this.shop.name),this.$el.css("background-color",this.theme.mainColor),this.$el.find(".x_shopName").css("color",this.theme.textColor),this.$el.find(".appsicon-cross").css("color",this.theme.textColor),this.$el.find("#x_startClose").on("click",(()=>{this.delegate.hide()})),A.default.on((()=>{this.$el&&this.$el.removeAttr("hidden")})),this}}class Jg extends i{constructor(){super(),this.isUploadingImage=!1}get shop(){return Gf.instance.state.shop}get theme(){return Gf.instance.state.theme}get status(){return Gf.instance.state.status}get payload(){return Gf.instance.state.payload}get images(){return Gf.instance.state.imageUrls}onUploadImages(e){let t=Array.from(e);if(t){if(t.length>1){const e=[qf("apps.message.img_upload.failed")];return e.push(qf("apps.message.img_upload.num_limit")),void window.alert(e.join("\n"))}this.uploadImages(t)}}validateImage(e){const t=[];return e.size>1024e4&&t.push(qf("apps.message.img_upload.size_limit")),e.type.match(/image\/(png|jpeg|jpg|gif)/)||t.push(qf("apps.message.img_upload.type_limit")),!(t.length>0&&(t.unshift(qf("apps.message.img_upload.failed")),window.alert(t.join("\n")),1))}updateFileView(){const e=this.$el.find("#msg_postBox__control__imgContainer");if(this.payload||"readonly"===this.status)return void e.empty();let t;if(this.images.length>0){const e=r()('<div class="msg_postBox__control__clearIconWrapper"><span class="appsicon-crossCircle msg_postBox__control__clearIcon"></span></div>');e.on("click",(e=>{e.preventDefault(),this.onImageClear()}));const n=r()(`<img src="${this.images[0]}" class="msg_postBox__control__img" />`);n.on("click",(()=>{Xf.show(this.images[0])})),t=[n,e]}else if(this.isUploadingImage)t=[r()('<img src="https://static.thebase.in/shop/loading-circle.svg" />')];else{const e=r()('<span class="appsicon-image msg_postBox__control__imgIcon"></span>\n                <span class="msg_postBox__control__imgInputFile">\n                    <input type="file" id="x_messageInputFile" accept="image/jpeg,image/png,image/gif" />\n                </span>'),n=e.find("#x_messageInputFile");let i=!1;n.on("click",(e=>{i||(e.preventDefault(),setTimeout((()=>{i=!0,n.trigger("click")}),50)),i=!1})),n.on("change",(({target:e})=>{const t=e.files;this.onUploadImages(t)})),t=[e]}e.empty().append(t)}onImageClear(){this.images.splice(0,1),this.updateFileView(),this.updateSendButton()}async uploadImages(e){let t=Gf.instance;if(t){this.isUploadingImage=!0,this.updateFileView(),this.updateSendButton();for(const n of e)if(this.validateImage(n))try{await t.uploadImage(n)}catch(e){window.alert(qf("apps.message.img_upload.system_error"))}this.isUploadingImage=!1,this.updateFileView(),this.updateSendButton()}}canSend(){return!(!this.$send||!this.$input||this.isSubmitDisable({alert:!0}))&&(this.trimmedInput().length>0||this.images.length>0)}isSubmitDisable({alert:e}={alert:!1}){return this.trimmedInput().length>500?(e&&window.alert(qf("apps.message.maximum_length")),!0):this.isUploadingImage||!!this.payload&&0===this.trimmedInput().length}updateSendButton(){this.isSubmitDisable()?this.$send.attr("disabled","disabled"):this.$send.removeAttr("disabled")}trimmedInput(){return`${this.$input.val()}`.trim()}adjustInputHeight(){const e=`${this.$input.val()}`.split("\n").length;e<6&&this.$input.css({height:24*e+"px"})}render(){return this.$el=r()(`\n          <div class="msg_postBox">\n            <div\n                class="msg_postBox__itemBox"\n                id="x_messageSendItem"\n                style="display:none;"\n            >\n                <div class="c-messageItemBox msg_postBox__itemBox__body">\n                    <a\n                        class="x_link msg_postBox__itemBox__body__link c-messageItemBox__link"\n                        style="color: ${this.theme.textColor} !important; background-color: ${this.theme.mainColor} !important">\n                        <div class="c-messageItemBox__link__itemBoxImg">\n                            <img class="x_image"/>\n                        </div>\n                        <div class="c-messageItemBox__link__itemBoxInfo">\n                            <div class="title x_title c-messageItemBox__link__itemBoxInfo__title"></div>\n                            <div class="price x_price c-messageItemBox__link__itemBoxInfo__price"></div>\n                        </div>\n                    </a>\n                </div>\n                <div class="msg_postBox__itemBox__closeBtn" id="x_messageSendItemClose">\n                    <div>\n                        <i class="appsicon-crossCircle" title="商品情報を削除"></i>\n                    </div>\n                </div>\n            </div>\n            <div class="msg_postBox__control">\n                <div class="msg_postBox__control__textArea">\n                <textarea class="msg_postBox__control__input" id="x_messageTextInput"></textarea>\n                <div class="msg_postBox__control__bottom">\n                    <label id="msg_postBox__control__imgContainer" class="msg_postBox__control__imgContainer"></label>\n                    <p class="msg_postBox__control__textCount"><span id="x_textCount">0</span> / 500</p>\n                </div>\n                </div>\n                <button\n                    class="msg_postBox__control__submit"\n                    id="x_messageSend"\n                    type="button"\n                    style="color: ${this.theme.textColor}; background-color: ${this.theme.mainColor}"\n                >${qf("apps.message.send")}</button>\n            </div>\n        </div>\n        `),this.$el.find("#x_messageSend").on("click",(e=>{e.preventDefault(),this.append()})),this.$el.find("#x_messageSend").on("touchstart",(e=>{this.$input.attr("active")&&this.append()})),this.updateFileView(),this.$input=this.$el.find("#x_messageTextInput"),this.$counter=this.$el.find("#x_textCount"),this.$send=this.$el.find("#x_messageSend"),this.$itemBox=this.$el.find("#x_messageSendItem"),this.updateSendButton(),this.payload&&(this.$itemBox.find("#x_messageSendItemClose").on("click",(e=>{Gf.instance.removePayload(),this.$itemBox.remove(),this.updateFileView(),this.updateSendButton()})),this.$itemBox.find(".x_link").attr("href",this.payload.url||null),this.$itemBox.find(".x_image").attr("src",this.payload.imageUrl||null),this.$itemBox.find(".x_title").text(this.payload.title||""),this.$itemBox.find(".x_price").text(Wf((this.payload.price||0).toString())),this.$itemBox.show()),this.$input.on("focus",(()=>{this.$input.attr("active","active")})),this.$input.on("blur",(()=>{this.$input.removeAttr("active")})),this.$input.on("keyup",(e=>{let t=this.trimmedInput().length;this.$counter.text(t),this.updateSendButton(),this.adjustInputHeight()})),r()(document.body).hasClass("is_ios")&&(this.$input.on("click focus",(e=>{e.preventDefault(),this.$keyboardMargin||(this.$keyboardMargin=r()("<div></div>"),this.$keyboardMargin.css({display:"block",height:"24px",width:"100%",background:"#fff"}),this.$el.after(this.$keyboardMargin))})),this.$input.on("blur",(e=>{e.preventDefault(),this.$keyboardMargin&&(this.$keyboardMargin.remove(),this.$keyboardMargin=void 0)}))),this.$el.find(".msg_postBox__control__input").attr("placeholder",qf("apps.message.placeholder")),"readonly"==this.status&&this.$el.find("#x_messageTextInput").addClass("disabled").attr("disabled","disabled").attr("placeholder",qf("apps.message.disabled")),this}append(){if(!this.canSend())return;const e=this.trimmedInput();this.$input.val(""),this.$counter.text("0");const t=Gf.instance;t&&(t.post(e,t.state.imageUrls,t.state.payload||void 0).then((()=>{this.updateFileView(),this.updateSendButton(),this.adjustInputHeight()})),this.payload&&(Gf.instance.removePayload(),this.$itemBox.remove()))}}class Qg extends i{constructor(e){super(),this.$el=r()(e)}render(){return this.append(new Gg(this)),this.append(new Vg),this.append(new Jg),this.append(Qf.instance()),this}hide(){this.$el&&(this.$el.css("display","none"),r()("#x_startMessenger").css("display","block")),r()(document.body).removeClass("msg_fixed_body"),this.scrollTop&&r()(document.body).scrollTop(this.scrollTop)}show(){this.$el&&this.$el.css("display","flex"),this.scrollTop=r()(document.body).scrollTop(),r()(document.body).addClass("msg_fixed_body")}}var Xg=n(840);n(1784),n(2720),n(8928),n(80),n(5816),n(204),window.BASEMessenger={$init:function(e,t){let n=r()(e);Gf.set(n.attr("data-shop-id"),n.attr("data-boot-status"),n.attr("data-shop-name"),n.attr("data-shop-logo"),n.attr("data-welcome-text"),t,(0,Xg.K)(t),n.data("itemPayload"));let i=()=>{r()("#x_message").removeAttr("hidden")},s=Gf.instance;s&&(s.ping().then((t=>{null!=t&&s&&"normal"!=s.state.status&&(i(),this.$mount(e))})),"normal"==s.state.status&&i())},$view:null,$mount:function(e){this.$view||(this.$view=new Qg(e),this.$view.render()),this.$view.show()}},(()=>{const e=r()("#x_baseMessage"),t=r()('meta[name="cot:complementaryColor"]').attr("content"),n=null!=t?t:e.attr("data-theme-color");r()(".msg_startButton").css("background-color",n),r()(".msg_startButton__icon, .msg_startButton__text").css("color",(0,Xg.K)(n)),"edit-design"!=e.attr("data-boot-status")&&(window.BASEMessenger.$init("#x_baseMessage",n),r()("#x_startMessenger").on("click",(function(){r()(this).css("display","none"),window.BASEMessenger.$mount("#x_baseMessage"),r()("#x_baseMessage").css("display","flex")})),window.launchBASEMessage=()=>{window.BASEMessenger.$mount("#x_baseMessage"),r()("#x_baseMessage").css("display","flex")})})()})()})();